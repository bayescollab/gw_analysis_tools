import numpy as np
import matplotlib.pyplot as plt
#import gwatpy.gwatpy_plot as gp ; gp.set()
#gp.show_minor_grid()


#ELIGO = np.loadtxt("noisecurves/AdLIGO_allnoises.dat",unpack=True)
ELIGO = np.loadtxt("noisecurves/AdLIGODesign.dat",unpack=True)
ELIGOAplus = np.loadtxt("noisecurves/Aplus.dat",unpack=True)
ECE1 = np.loadtxt("noisecurves/CE1.dat",unpack=True)
ECE2N = np.loadtxt("noisecurves/CE2narrow.dat",unpack=True)
ECE2W = np.loadtxt("noisecurves/CE2wide.dat",unpack=True)
EAdV = np.loadtxt("noisecurves/AdV_baseline_sensitivity_12May09.csv",delimiter=',',unpack=True)
EAdV2 = np.loadtxt("noisecurves/AdV_refsens_090427.csv",delimiter=',',unpack=True)
AdLIGO_design = np.loadtxt("local_noise_curves/aLIGODesign.csv",delimiter=',',unpack=True)
AdLIGO_Aplus = np.loadtxt("local_noise_curves/AplusDesign.csv",delimiter=',',unpack=True)
CE1 = np.loadtxt("local_noise_curves/CE1_strain.csv",delimiter=',',unpack=True)
CE2 = np.loadtxt("local_noise_curves/CE2_strain.csv",delimiter=',',unpack=True)
bK = np.loadtxt("local_noise_curves/kagra_DRSE.csv",delimiter=',',unpack=True)


#official noise curves
AdLIGO_design_official = np.loadtxt("official_noise_curves/aligo_O4high.txt",unpack=True)
AdLIGO_AP_official = np.loadtxt("official_noise_curves/AplusDesign.txt",unpack=True)
avirgo_O4 = np.loadtxt("official_noise_curves/avirgo_O4high_NEW.txt",unpack=True)
avirgo_O5high = np.loadtxt("official_noise_curves/avirgo_O5high_NEW.txt",unpack=True)
avirgo_O5low = np.loadtxt("official_noise_curves/avirgo_O5low_NEW.txt",unpack=True)
kagra_128 = np.loadtxt("official_noise_curves/kagra_128Mpc.txt",unpack=True)
kagra_25 = np.loadtxt("official_noise_curves/kagra_25Mpc.txt",unpack=True)
kagra_80 = np.loadtxt("official_noise_curves/kagra_80Mpc.txt",unpack=True)



fig, ax = plt.subplots(nrows=2,ncols=2,sharex=True,figsize=(15,15))
#ax[0,0].loglog(AdLIGO_design[0],AdLIGO_design[1],label="T1800044-v5")
#ax[0,0].loglog(AdLIGO_design[0],AdLIGO_design[1],label="First Run")
#ax[0,0].loglog(ELIGO[0],ELIGO[4],label="First Run")
ax[0,0].loglog(ELIGO[0],ELIGO[1],label="First Run")
ax[0,0].loglog(AdLIGO_design_official[0],AdLIGO_design_official[1],label="Official design")
#ax[0,0].set_xscale("log")
#ax[0,0].set_yscale("log")
#ax[0,0].set_ylim([1e-25,1e-20])
#ax[0,0].set_xlim([1e0,1e4])

#ax[0,1].loglog(AdLIGO_Aplus[0],AdLIGO_Aplus[1],label="T1800042-v4")
ax[0,1].loglog(AdLIGO_Aplus[0],AdLIGO_Aplus[1],label="First Run")
#ax[0,1].loglog(ELIGOAplus[0],ELIGOAplus[1],label="Emanuele AdLIGOAplus")
ax[0,1].loglog(AdLIGO_AP_official[0],AdLIGO_AP_official[1],label="Official Aplus")

#ax[2,0].loglog(EAdV[0],EAdV[1],label="Emanuele AdV O5")
ax[1,0].loglog(EAdV[0],EAdV[1],label="First Run O5")
ax[1,0].loglog(EAdV[0],EAdV[1]*1.71034,label="First Run O4")
ax[1,0].loglog(avirgo_O4[0],avirgo_O4[1],label="Official design O4")
ax[1,0].loglog(avirgo_O5high[0],avirgo_O5high[1],label="Official design O5 opt")
ax[1,0].loglog(avirgo_O5low[0],avirgo_O5low[1],label="Official design O5 pess")
#ax[2,0].loglog(EAdV2[0],EAdV2[1],label="Emanuele AdV Refnes")

#ax[1,0].loglog(CE1[0],CE1[1],label="CE1 cosmicexplorer.org")
#ax[1,0].loglog(ECE1[0],ECE1[1],label="Emanuele CE1")

#ax[1,1].loglog(CE2[0],CE2[1],label="CE2 cosmicexplorer.org")
#ax[1,1].loglog(ECE2N[0],ECE2N[1],label="Emanuele CE2N")
#ax[1,1].loglog(ECE2W[0],ECE2W[1],label="Emanuele CE2W")

#ax[2,1].loglog(bK[0],bK[1],label="bKAGRA https://gwcenter.icrr.u-tokyo.ac.jp/ O4")
#ax[2,1].loglog(bK[0],bK[1],label="bKAGRA website O4")
ax[1,1].loglog(bK[0],bK[1],label="First Run")
#ax[2,1].loglog(bK[0],bK[1]*3.9326,label="bKAGRA O3 analog")
ax[1,1].loglog(kagra_128[0],kagra_128[1],label="128MPC kagra official (O5 optimistic)")
#ax[1,1].loglog(kagra_25[0],kagra_25[1],label="25MPC kagra official")
ax[1,1].loglog(kagra_80[0],kagra_80[1],label="80MPC kagra official (O5 pessimistic)")

ax[0,0].legend()
ax[1,0].legend()
ax[0,1].legend()
ax[1,1].legend()
#ax[2,1].legend()
#ax[2,0].legend()
ax[1,0].set_xlim([10,5000])
ax[1,1].set_xlim([10,5000])
#ax[2,1].set_ylim([10**-24,10**-20])
ax[0,1].set_ylim([10**-24,10**-20])
ax[1,0].set_ylim([10**-24,10**-21])
ax[1,1].set_ylim([10**-24,10**-21])
ax[0,0].set_title("AdLIGO Design")
ax[0,1].set_title("AdLIGO A+")
#ax[1,0].set_title("CE1")
#ax[1,1].set_title("CE2")
ax[1,0].set_title("AdVIRGO")
ax[1,1].set_title("KAGRA")
plt.savefig("Noise_curves.pdf")
#plt.show()
plt.close()
