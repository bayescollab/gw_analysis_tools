\hypertarget{mcmc__sampler_8cpp}{}\doxysection{src/mcmc\+\_\+sampler.cpp File Reference}
\label{mcmc__sampler_8cpp}\index{src/mcmc\_sampler.cpp@{src/mcmc\_sampler.cpp}}
{\ttfamily \#include \char`\"{}mcmc\+\_\+sampler.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}autocorrelation.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}util.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mcmc\+\_\+sampler\+\_\+internals.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}thread\+Pool.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}io\+\_\+util.\+h\char`\"{}}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+rng.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+randist.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include $<$condition\+\_\+variable$>$}\newline
{\ttfamily \#include $<$mutex$>$}\newline
{\ttfamily \#include $<$thread$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$queue$>$}\newline
{\ttfamily \#include $<$functional$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$fstream$>$}\newline
{\ttfamily \#include \char`\"{}adolc/adolc.\+h\char`\"{}}\newline
Include dependency graph for mcmc\+\_\+sampler.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mcmc__sampler_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classComparator}{Comparator}}
\begin{DoxyCompactList}\small\item\em Class to facilitate the comparing of chains for priority. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classComparatorswap}{Comparatorswap}}
\item 
class \mbox{\hyperlink{classThreadPool}{Thread\+Pool}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_a71a771d0580911cb2c5fe43e369c744a}\label{mcmc__sampler_8cpp_a71a771d0580911cb2c5fe43e369c744a}} 
\#define {\bfseries omp}~ignore
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a5d33cf90836be53bbedcc7d09f62911b}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated\+\_\+internal}} (std\+::string checkpoint\+\_\+file\+\_\+start, double $\ast$$\ast$output, int N\+\_\+steps, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Parallel tempered, dynamic chain allocation M\+C\+MC with output samples with specified maximum autocorrelation. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a084c31ec2e87873946a4866b104fd733}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated\+\_\+internal}} (double $\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Parallel tempered, dynamic chain allocation M\+C\+MC with output samples with specified maximum autocorrelation. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_afa5117c4dfe1ac8bd457fb7bee622c6f}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated\+\_\+internal\+\_\+driver}} (double $\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Driver routine for the uncorrelated sampler -- trying not to repeat code. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a54bc1026eeef7c887e42d892af5acb1b}{continue\+\_\+\+R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal}} (std\+::string start\+\_\+checkpoint\+\_\+file, double $\ast$$\ast$$\ast$output, int $\ast$$\ast$$\ast$status, int N\+\_\+steps, int swp\+\_\+freq, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, std\+::function$<$ void(double $\ast$, double $\ast$, int $\ast$, int $\ast$, int, int, int, void $\ast$)$>$ R\+J\+\_\+proposal, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, bool update\+\_\+\+R\+J\+\_\+width, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string end\+\_\+checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Routine to take a checkpoint file and begin a new chain at said checkpoint. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a40dcca4742325ca439a175415cf87750}{R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal}} (double $\ast$$\ast$$\ast$output, int $\ast$$\ast$$\ast$parameter\+\_\+status, int max\+\_\+dimension, int min\+\_\+dimension, int N\+\_\+steps, int chain\+\_\+N, double $\ast$initial\+\_\+pos, int $\ast$initial\+\_\+status, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, std\+::function$<$ void(double $\ast$, double $\ast$, int $\ast$, int $\ast$, int, int, int, void $\ast$)$>$ R\+J\+\_\+proposal, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, bool update\+\_\+\+R\+J\+\_\+width, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Generic reversable jump sampler, where the likelihood, prior, and reversable jump proposal are parameters supplied by the user. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a199737224362b3c9359a74e0663c1561}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+internal}} (std\+::string checkpoint\+\_\+file\+\_\+start, double $\ast$$\ast$$\ast$output, int N\+\_\+steps, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, std\+::string chain\+\_\+distribution\+\_\+scheme, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Continue dyanmically tunes an M\+C\+MC for optimal spacing. step width, and chain number. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a8839fc4572cf8e0d17ebceec408e782a}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+internal}} (double $\ast$$\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, std\+::string chain\+\_\+distribution\+\_\+scheme, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Dyanmically tunes an M\+C\+MC for optimal spacing. step width, and chain number. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_a86cd71b2998bae1bec6d5ced831a1446}\label{mcmc__sampler_8cpp_a86cd71b2998bae1bec6d5ced831a1446}} 
void {\bfseries dynamic\+\_\+temperature\+\_\+internal} (\mbox{\hyperlink{classsampler}{sampler}} $\ast$samplerptr, int N\+\_\+steps, double nu, int t0, int swp\+\_\+freq, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, bool show\+\_\+prog)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a5c94625e7e33e0d077ebb9ea7501fbe6}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal}} (double $\ast$$\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Generic sampler, where the likelihood, prior are parameters supplied by the user. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_ad476eae645c920872fdd77100dfd0121}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal}} (std\+::string start\+\_\+checkpoint\+\_\+file, double $\ast$$\ast$$\ast$output, int N\+\_\+steps, int swp\+\_\+freq, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+prior, std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$ log\+\_\+likelihood, std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$fisher, void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string end\+\_\+checkpoint\+\_\+file)
\begin{DoxyCompactList}\small\item\em Routine to take a checkpoint file and begin a new chain at said checkpoint. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a772e17f2034573d79c02bfa0ecd8c990}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+step\+\_\+incremental}} (\mbox{\hyperlink{classsampler}{sampler}} $\ast$\mbox{\hyperlink{classsampler}{sampler}}, int increment)
\begin{DoxyCompactList}\small\item\em Internal function that runs the actual loop for the sampler -- increment version. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_aaa8ccb67ad90a3d27d713fcd652adfd2}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+loop}} (\mbox{\hyperlink{classsampler}{sampler}} $\ast$\mbox{\hyperlink{classsampler}{sampler}})
\begin{DoxyCompactList}\small\item\em Internal function that runs the actual loop for the sampler. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_af250c20cee4a5547525688bde512f466}\label{mcmc__sampler_8cpp_af250c20cee4a5547525688bde512f466}} 
void {\bfseries mcmc\+\_\+step\+\_\+threaded} (int j)
\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_a5aa82fcdd0ec289905b9aa4ef7db6276}\label{mcmc__sampler_8cpp_a5aa82fcdd0ec289905b9aa4ef7db6276}} 
void {\bfseries mcmc\+\_\+swap\+\_\+threaded} (int i, int j)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_af796088bcd5cd8e794d02d1b82610d5e}{P\+T\+M\+C\+M\+C\+\_\+\+MH}} (double $\ast$$\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a0c07c5f7d1d6a5391f0ee25cdafb42ac}{P\+T\+M\+C\+M\+C\+\_\+\+MH}} (double $\ast$$\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_acdf5252a577ccae2d4e7c90d8f054612}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+MH}} (std\+::string start\+\_\+checkpoint\+\_\+file, double $\ast$$\ast$$\ast$output, int N\+\_\+steps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string end\+\_\+checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a89d287443349069d59b0a8ea2698a4c0}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+MH}} (std\+::string start\+\_\+checkpoint\+\_\+file, double $\ast$$\ast$$\ast$output, int N\+\_\+steps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string end\+\_\+checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a9e62c6b1a844fa628615a70cfd01b416}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc}} (std\+::string checkpoint\+\_\+file\+\_\+start, double $\ast$$\ast$$\ast$output, int N\+\_\+steps, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a2624b845ec2f8a11949347fd3c52b435}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc}} (std\+::string checkpoint\+\_\+file\+\_\+start, double $\ast$$\ast$$\ast$output, int N\+\_\+steps, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a6c63ce25491ebdf9b2aa6dd4651c0790}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc}} (double $\ast$$\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a7fd6c85a11abf530541c10cbaf99f30f}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc}} (double $\ast$$\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_aca0ec45aeec4fbd2af0a0b222eefe53a}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated}} (std\+::string checkpoint\+\_\+file\+\_\+start, double $\ast$$\ast$output, int N\+\_\+steps, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a74c970893516b24e60511fc41ad93708}{continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated}} (std\+::string checkpoint\+\_\+file\+\_\+start, double $\ast$$\ast$output, int N\+\_\+steps, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a33783ee80c1f93b43d1e9bca0dc55907}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated}} (double $\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a94f07c794491ccf76b31a57f4805e928}{P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated}} (double $\ast$$\ast$output, int dimension, int N\+\_\+steps, int chain\+\_\+N, int max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble, double $\ast$initial\+\_\+pos, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, int t0, int nu, int corr\+\_\+threshold, int corr\+\_\+segments, double corr\+\_\+converge\+\_\+thresh, double corr\+\_\+target\+\_\+ac, std\+::string chain\+\_\+distribution\+\_\+scheme, double($\ast$log\+\_\+prior)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a3899aea46258af11e00fc114bb648525}{R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH}} (double $\ast$$\ast$$\ast$output, int $\ast$$\ast$$\ast$parameter\+\_\+status, int max\+\_\+dimension, int min\+\_\+dimension, int N\+\_\+steps, int chain\+\_\+N, double $\ast$initial\+\_\+pos, int $\ast$initial\+\_\+status, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void($\ast$R\+J\+\_\+proposal)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_aa5e2015504c9cc1adc3b3ad30e8b143b}{R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH}} (double $\ast$$\ast$$\ast$output, int $\ast$$\ast$$\ast$parameter\+\_\+status, int max\+\_\+dimension, int min\+\_\+dimension, int N\+\_\+steps, int chain\+\_\+N, double $\ast$initial\+\_\+pos, int $\ast$initial\+\_\+status, double $\ast$seeding\+\_\+var, double $\ast$chain\+\_\+temps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void($\ast$R\+J\+\_\+proposal)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, double gaussian\+\_\+width, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_afe6b144b31fb6363ad1a9e31bfa8d72e}{continue\+\_\+\+R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH}} (std\+::string start\+\_\+checkpoint\+\_\+file, double $\ast$$\ast$$\ast$output, int $\ast$$\ast$$\ast$status, int N\+\_\+steps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void($\ast$R\+J\+\_\+proposal)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, double gaussian\+\_\+width, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string end\+\_\+checkpoint\+\_\+file)
\item 
void \mbox{\hyperlink{mcmc__sampler_8cpp_a10588e41b80a7dd3aad0e933030add38}{continue\+\_\+\+R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH}} (std\+::string start\+\_\+checkpoint\+\_\+file, double $\ast$$\ast$$\ast$output, int $\ast$$\ast$$\ast$status, int N\+\_\+steps, int swp\+\_\+freq, double($\ast$log\+\_\+prior)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), double($\ast$log\+\_\+likelihood)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), void($\ast$fisher)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters), void($\ast$R\+J\+\_\+proposal)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters), void $\ast$$\ast$user\+\_\+parameters, int num\+Threads, bool pool, bool show\+\_\+prog, std\+::string statistics\+\_\+filename, std\+::string chain\+\_\+filename, std\+::string auto\+\_\+corr\+\_\+filename, std\+::string likelihood\+\_\+log\+\_\+filename, std\+::string end\+\_\+checkpoint\+\_\+file)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_aef1cd57f3e1037b1fb2d9cfcb3dbec2a}\label{mcmc__sampler_8cpp_aef1cd57f3e1037b1fb2d9cfcb3dbec2a}} 
const gsl\+\_\+rng\+\_\+type $\ast$ {\bfseries T}
\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_a53b3e4bb1bd287d2150b9c128e15a316}\label{mcmc__sampler_8cpp_a53b3e4bb1bd287d2150b9c128e15a316}} 
gsl\+\_\+rng $\ast$ {\bfseries r}
\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_a9444c4d7be8892563729b205b7f0a4ba}\label{mcmc__sampler_8cpp_a9444c4d7be8892563729b205b7f0a4ba}} 
\mbox{\hyperlink{classsampler}{sampler}} $\ast$ {\bfseries samplerptr}
\item 
\mbox{\Hypertarget{mcmc__sampler_8cpp_abdef295640937ef20f6a403db46c3946}\label{mcmc__sampler_8cpp_abdef295640937ef20f6a403db46c3946}} 
\mbox{\hyperlink{classThreadPool}{Thread\+Pool}} $\ast$ {\bfseries poolptr}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Source file for the sampler foundation

Source file for generic M\+C\+MC sampler. Sub routines that are application agnostic are housed in mcmc\+\_\+sampler\+\_\+internals 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mcmc__sampler_8cpp_acdf5252a577ccae2d4e7c90d8f054612}\label{mcmc__sampler_8cpp_acdf5252a577ccae2d4e7c90d8f054612}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH@{continue\_PTMCMC\_MH}}
\index{continue\_PTMCMC\_MH@{continue\_PTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH()}{continue\_PTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{std\+::string}]{start\+\_\+checkpoint\+\_\+file,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{end\+\_\+checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
 & {\em start\+\_\+checkpoint\+\_\+file} & File for starting checkpoint \\
\hline
\mbox{\texttt{ out}}  & {\em output} & output array, dimensions\+: output\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of new steps to take \\
\hline
 & {\em swp\+\_\+freq} & frequency of swap attempts between temperatures \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use \\
\hline
 & {\em pool} & Boolean for whether to use \`{}\`{}deterministic\textquotesingle{}\textquotesingle{} vs \`{}\`{}stochastic\textquotesingle{}\textquotesingle{} sampling \\
\hline
 & {\em show\+\_\+prog} & Boolean for whether to show progress or not (turn off for cluster runs \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em end\+\_\+checkpoint\+\_\+file} & Filename to output data for checkpoint at the end of the continued run, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a89d287443349069d59b0a8ea2698a4c0}\label{mcmc__sampler_8cpp_a89d287443349069d59b0a8ea2698a4c0}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH@{continue\_PTMCMC\_MH}}
\index{continue\_PTMCMC\_MH@{continue\_PTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH()}{continue\_PTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{std\+::string}]{start\+\_\+checkpoint\+\_\+file,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{end\+\_\+checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
 & {\em start\+\_\+checkpoint\+\_\+file} & File for starting checkpoint \\
\hline
\mbox{\texttt{ out}}  & {\em output} & output array, dimensions\+: output\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of new steps to take \\
\hline
 & {\em swp\+\_\+freq} & frequency of swap attempts between temperatures \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use \\
\hline
 & {\em pool} & Boolean for whether to use \`{}\`{}deterministic\textquotesingle{}\textquotesingle{} vs \`{}\`{}stochastic\textquotesingle{}\textquotesingle{} sampling \\
\hline
 & {\em show\+\_\+prog} & Boolean for whether to show progress or not (turn off for cluster runs \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em end\+\_\+checkpoint\+\_\+file} & Filename to output data for checkpoint at the end of the continued run, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a2624b845ec2f8a11949347fd3c52b435}\label{mcmc__sampler_8cpp_a2624b845ec2f8a11949347fd3c52b435}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_dynamic\_PT\_alloc@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc}}
\index{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc()}{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc (\begin{DoxyParamCaption}\item[{std\+::string}]{checkpoint\+\_\+file\+\_\+start,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}max\+\_\+chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a9e62c6b1a844fa628615a70cfd01b416}\label{mcmc__sampler_8cpp_a9e62c6b1a844fa628615a70cfd01b416}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_dynamic\_PT\_alloc@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc}}
\index{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc()}{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc (\begin{DoxyParamCaption}\item[{std\+::string}]{checkpoint\+\_\+file\+\_\+start,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}max\+\_\+chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a199737224362b3c9359a74e0663c1561}\label{mcmc__sampler_8cpp_a199737224362b3c9359a74e0663c1561}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_internal@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_internal}}
\index{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_internal@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_internal()}{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_internal()}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+internal (\begin{DoxyParamCaption}\item[{std\+::string}]{checkpoint\+\_\+file\+\_\+start,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Continue dyanmically tunes an M\+C\+MC for optimal spacing. step width, and chain number. 

N\+O\+TE\+: nu, and t0 parameters determine the dynamics, so these are important quantities. nu is related to how many swap attempts it takes to substantially change the temperature ladder, why t0 determines the length of the total dyanimcally period. Moderate initial choices would be 10 and 1000, respectively.

Based on ar\+Xiv\+:1501.\+05823v3

Currently, Chain number is fixed

max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble sets the maximium number of chains to use to in successively hotter chains to cover the likelihood surface while targeting an optimal swap acceptance target\+\_\+swp\+\_\+acc.

max\+\_\+chain\+\_\+N determines the total number of chains to run once thermodynamic equilibrium has been reached. This results in chains being added after the initial PT dynamics have finished according to chain\+\_\+distribution\+\_\+scheme.

If no preference, set max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble = max\+\_\+chain\+\_\+N = num\+Threads = (number of cores (number of threads if hyperthreaded))-- this will most likely be the most optimal configuration. If the number of cores on the system is low, you may want to use n$\ast$num\+Threads for some integer n instead, depending on the system.

chain\+\_\+distribution\+\_\+scheme\+:

\char`\"{}cold\char`\"{}\+: All chains are added at T=1 (untempered)

\char`\"{}refine\char`\"{}\+: Chains are added between the optimal temps geometrically -- this may be a good option as it will be a good approximation of the ideal distribution of chains, while keeping the initial dynamical time low

\char`\"{}double\char`\"{}\+: Chains are added in order of rising temperature that mimic the distribution achieved by the earier PT dynamics

\char`\"{}half\+\_\+ensemble\char`\"{}\+: For every cold chain added, half of the ensemble is added again. Effectively, two cold chains for every ensemble 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}max\+\_\+chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
\mbox{\texttt{ out}}  & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a74c970893516b24e60511fc41ad93708}\label{mcmc__sampler_8cpp_a74c970893516b24e60511fc41ad93708}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}}
\index{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated (\begin{DoxyParamCaption}\item[{std\+::string}]{checkpoint\+\_\+file\+\_\+start,  }\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output, shape is double\mbox{[}N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_aca0ec45aeec4fbd2af0a0b222eefe53a}\label{mcmc__sampler_8cpp_aca0ec45aeec4fbd2af0a0b222eefe53a}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}}
\index{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated (\begin{DoxyParamCaption}\item[{std\+::string}]{checkpoint\+\_\+file\+\_\+start,  }\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output , shape is double\mbox{[}N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a5d33cf90836be53bbedcc7d09f62911b}\label{mcmc__sampler_8cpp_a5d33cf90836be53bbedcc7d09f62911b}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal}}
\index{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal@{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal()}{continue\_PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal()}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated\+\_\+internal (\begin{DoxyParamCaption}\item[{std\+::string}]{checkpoint\+\_\+file\+\_\+start,  }\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Parallel tempered, dynamic chain allocation M\+C\+MC with output samples with specified maximum autocorrelation. 

Runs dynamic chain allocation until the autocorrelation lengths stabilize, then it will run the P\+T\+M\+C\+MC routine repeatedly, periodically thinning the chain to ensure the auto-\/correlation length is below the threshold

Note\+: smallest batch size is .5$\ast$\+N\+\_\+steps, so the target correlation length should be $<$$<$ less than this number

Note\+: This routine only works if the requested number of samples is larger than the typical correlation length of the unthinned chains. This is because the chains are run and tested in batches the size of the requested sample number.

Note\+: This method does N\+OT guarantee the final autocorrelation length of the chains will the be the target. It merely uses the requested autocorrelation length as a guide to thin the chains as samples are accrued and to estimate the total number of effective samples. Its best to request extra samples and thin the chains out at the end one final time, or to run multiple runs and combine the results at the end. $<$ dimension of the parameter space being explored

$<$ Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation

$<$ Maximum number of chains to use

$<$ Maximum number of chains to use in the thermodynamic ensemble (may use less)

$<$ the frequency with which chains are swapped

$<$ Time constant of the decay of the chain dynamics ($\sim$1000)

$<$ Initial amplitude of the dynamics ($\sim$100)

$<$ Maxmimum allowed autocorrelation of the samples -- suggested is 50

$<$Number of segments to calculate autocorrelation on for diagnostics

$<$ Fractional threshold for convergence of autocorrelation

$<$Target correlation for calculating autocorrelation length

$<$ std\+::function for the log\+\_\+prior function -- takes double $\ast$position, int dimension, int chain\+\_\+id

$<$ std\+::function for the log\+\_\+likelihood function -- takes double $\ast$position, int dimension, int chain\+\_\+id

$<$ std\+::function for the fisher function -- takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id

$<$ Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+LL

$<$ Number of threads to use (=1 is single threaded)

$<$ boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads)

$<$ boolean whether to print out progress (for example, should be set to \`{}`false'\textquotesingle{} if submitting to a cluster)

$<$ Filename to output sampling statistics, if empty string, not output

$<$ Filename to output data (chain 0 only), if empty string, not output

$<$ Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -- use empty string to skip

$<$ Filename to output data for checkpoint, if empty string, not saved
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output shape is double\mbox{[}N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
\mbox{\texttt{ out}}  & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em corr\+\_\+threshold} & Maxmimum allowed autocorrelation of the samples -\/-\/ suggested is 50 \\
\hline
 & {\em corr\+\_\+segments} & Number of segments to calculate autocorrelation on for diagnostics \\
\hline
 & {\em corr\+\_\+converge\+\_\+thresh} & Fractional threshold for convergence of autocorrelation \\
\hline
 & {\em corr\+\_\+target\+\_\+ac} & Target correlation for calculating autocorrelation length \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_ad476eae645c920872fdd77100dfd0121}\label{mcmc__sampler_8cpp_ad476eae645c920872fdd77100dfd0121}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_PTMCMC\_MH\_internal@{continue\_PTMCMC\_MH\_internal}}
\index{continue\_PTMCMC\_MH\_internal@{continue\_PTMCMC\_MH\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_PTMCMC\_MH\_internal()}{continue\_PTMCMC\_MH\_internal()}}
{\footnotesize\ttfamily void continue\+\_\+\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal (\begin{DoxyParamCaption}\item[{std\+::string}]{start\+\_\+checkpoint\+\_\+file,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{swp\+\_\+freq,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{end\+\_\+checkpoint\+\_\+file }\end{DoxyParamCaption})}



Routine to take a checkpoint file and begin a new chain at said checkpoint. 

See M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal for more details of parameters (pretty much all the same) 
\begin{DoxyParams}[1]{Parameters}
 & {\em start\+\_\+checkpoint\+\_\+file} & File for starting checkpoint \\
\hline
\mbox{\texttt{ out}}  & {\em output} & output array, dimensions\+: output\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of new steps to take \\
\hline
 & {\em swp\+\_\+freq} & frequency of swap attempts between temperatures \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use \\
\hline
 & {\em pool} & Boolean for whether to use \`{}\`{}deterministic\textquotesingle{}\textquotesingle{} vs \`{}\`{}stochastic\textquotesingle{}\textquotesingle{} sampling \\
\hline
 & {\em show\+\_\+prog} & Boolean for whether to show progress or not (turn off for cluster runs \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em end\+\_\+checkpoint\+\_\+file} & Filename to output data for checkpoint at the end of the continued run, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_afe6b144b31fb6363ad1a9e31bfa8d72e}\label{mcmc__sampler_8cpp_afe6b144b31fb6363ad1a9e31bfa8d72e}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_RJPTMCMC\_MH@{continue\_RJPTMCMC\_MH}}
\index{continue\_RJPTMCMC\_MH@{continue\_RJPTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_RJPTMCMC\_MH()}{continue\_RJPTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{std\+::string}]{start\+\_\+checkpoint\+\_\+file,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int $\ast$$\ast$$\ast$}]{status,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void($\ast$)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, double gaussian\+\_\+width, void $\ast$parameters)}]{R\+J\+\_\+proposal,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{end\+\_\+checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
 & {\em start\+\_\+checkpoint\+\_\+file} & File for starting checkpoint \\
\hline
\mbox{\texttt{ out}}  & {\em output} & output array, dimensions\+: output\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em status} & output parameter status array, dimensions\+: status\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of new steps to take \\
\hline
 & {\em swp\+\_\+freq} & frequency of swap attempts between temperatures \\
\hline
 & {\em R\+J\+\_\+proposal} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use \\
\hline
 & {\em pool} & Boolean for whether to use \`{}\`{}deterministic\textquotesingle{}\textquotesingle{} vs \`{}\`{}stochastic\textquotesingle{}\textquotesingle{} sampling \\
\hline
 & {\em show\+\_\+prog} & Boolean for whether to show progress or not (turn off for cluster runs \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em end\+\_\+checkpoint\+\_\+file} & Filename to output data for checkpoint at the end of the continued run, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a10588e41b80a7dd3aad0e933030add38}\label{mcmc__sampler_8cpp_a10588e41b80a7dd3aad0e933030add38}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_RJPTMCMC\_MH@{continue\_RJPTMCMC\_MH}}
\index{continue\_RJPTMCMC\_MH@{continue\_RJPTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_RJPTMCMC\_MH()}{continue\_RJPTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void continue\+\_\+\+R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{std\+::string}]{start\+\_\+checkpoint\+\_\+file,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int $\ast$$\ast$$\ast$}]{status,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void($\ast$)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{R\+J\+\_\+proposal,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{end\+\_\+checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
 & {\em start\+\_\+checkpoint\+\_\+file} & File for starting checkpoint \\
\hline
\mbox{\texttt{ out}}  & {\em output} & output array, dimensions\+: output\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em status} & output parameter status array, dimensions\+: status\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of new steps to take \\
\hline
 & {\em swp\+\_\+freq} & frequency of swap attempts between temperatures \\
\hline
 & {\em R\+J\+\_\+proposal} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use \\
\hline
 & {\em pool} & Boolean for whether to use \`{}\`{}deterministic\textquotesingle{}\textquotesingle{} vs \`{}\`{}stochastic\textquotesingle{}\textquotesingle{} sampling \\
\hline
 & {\em show\+\_\+prog} & Boolean for whether to show progress or not (turn off for cluster runs \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em end\+\_\+checkpoint\+\_\+file} & Filename to output data for checkpoint at the end of the continued run, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a54bc1026eeef7c887e42d892af5acb1b}\label{mcmc__sampler_8cpp_a54bc1026eeef7c887e42d892af5acb1b}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!continue\_RJPTMCMC\_MH\_internal@{continue\_RJPTMCMC\_MH\_internal}}
\index{continue\_RJPTMCMC\_MH\_internal@{continue\_RJPTMCMC\_MH\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{continue\_RJPTMCMC\_MH\_internal()}{continue\_RJPTMCMC\_MH\_internal()}}
{\footnotesize\ttfamily void continue\+\_\+\+R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal (\begin{DoxyParamCaption}\item[{std\+::string}]{start\+\_\+checkpoint\+\_\+file,  }\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int $\ast$$\ast$$\ast$}]{status,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{swp\+\_\+freq,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{std\+::function$<$ void(double $\ast$, double $\ast$, int $\ast$, int $\ast$, int, int, int, void $\ast$)$>$}]{R\+J\+\_\+proposal,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{bool}]{update\+\_\+\+R\+J\+\_\+width,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{end\+\_\+checkpoint\+\_\+file }\end{DoxyParamCaption})}



Routine to take a checkpoint file and begin a new chain at said checkpoint. 

See M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal for more details of parameters (pretty much all the same) 
\begin{DoxyParams}[1]{Parameters}
 & {\em start\+\_\+checkpoint\+\_\+file} & File for starting checkpoint \\
\hline
\mbox{\texttt{ out}}  & {\em output} & output array, dimensions\+: output\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em status} & output parameter status array, dimensions\+: status\mbox{[}chain\+\_\+N\mbox{]}\mbox{[}N\+\_\+steps\mbox{]}\mbox{[}dimension\mbox{]} \\
\hline
 & {\em N\+\_\+steps} & Number of new steps to take \\
\hline
 & {\em swp\+\_\+freq} & frequency of swap attempts between temperatures \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em R\+J\+\_\+proposal} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use \\
\hline
 & {\em pool} & Boolean for whether to use \`{}\`{}deterministic\textquotesingle{}\textquotesingle{} vs \`{}\`{}stochastic\textquotesingle{}\textquotesingle{} sampling \\
\hline
 & {\em show\+\_\+prog} & Boolean for whether to show progress or not (turn off for cluster runs \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output -\/-\/ if multiple cold chains, it will append each output to the other, and write out the total \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em end\+\_\+checkpoint\+\_\+file} & Filename to output data for checkpoint at the end of the continued run, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a0c07c5f7d1d6a5391f0ee25cdafb42ac}\label{mcmc__sampler_8cpp_a0c07c5f7d1d6a5391f0ee25cdafb42ac}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH@{PTMCMC\_MH}}
\index{PTMCMC\_MH@{PTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH()}{PTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain \\
\hline
 & {\em chain\+\_\+N} & Number of chains \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Double array of temperatures for the chains \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_af796088bcd5cd8e794d02d1b82610d5e}\label{mcmc__sampler_8cpp_af796088bcd5cd8e794d02d1b82610d5e}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH@{PTMCMC\_MH}}
\index{PTMCMC\_MH@{PTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH()}{PTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain \\
\hline
 & {\em chain\+\_\+N} & Number of chains \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Double array of temperatures for the chains \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a7fd6c85a11abf530541c10cbaf99f30f}\label{mcmc__sampler_8cpp_a7fd6c85a11abf530541c10cbaf99f30f}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc@{PTMCMC\_MH\_dynamic\_PT\_alloc}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc@{PTMCMC\_MH\_dynamic\_PT\_alloc}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc()}{PTMCMC\_MH\_dynamic\_PT\_alloc()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}max\+\_\+chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a6c63ce25491ebdf9b2aa6dd4651c0790}\label{mcmc__sampler_8cpp_a6c63ce25491ebdf9b2aa6dd4651c0790}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc@{PTMCMC\_MH\_dynamic\_PT\_alloc}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc@{PTMCMC\_MH\_dynamic\_PT\_alloc}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc()}{PTMCMC\_MH\_dynamic\_PT\_alloc()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}max\+\_\+chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a8839fc4572cf8e0d17ebceec408e782a}\label{mcmc__sampler_8cpp_a8839fc4572cf8e0d17ebceec408e782a}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc\_internal@{PTMCMC\_MH\_dynamic\_PT\_alloc\_internal}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc\_internal@{PTMCMC\_MH\_dynamic\_PT\_alloc\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc\_internal()}{PTMCMC\_MH\_dynamic\_PT\_alloc\_internal()}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+internal (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Dyanmically tunes an M\+C\+MC for optimal spacing. step width, and chain number. 

N\+O\+TE\+: nu, and t0 parameters determine the dynamics, so these are important quantities. nu is related to how many swap attempts it takes to substantially change the temperature ladder, why t0 determines the length of the total dyanimcally period. Moderate initial choices would be 10 and 1000, respectively.

Based on ar\+Xiv\+:1501.\+05823v3

Currently, Chain number is fixed

max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble sets the maximium number of chains to use to in successively hotter chains to cover the likelihood surface while targeting an optimal swap acceptance target\+\_\+swp\+\_\+acc.

max\+\_\+chain\+\_\+N determines the total number of chains to run once thermodynamic equilibrium has been reached. This results in chains being added after the initial PT dynamics have finished according to chain\+\_\+distribution\+\_\+scheme.

If no preference, set max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble = max\+\_\+chain\+\_\+N = num\+Threads = (number of cores (number of threads if hyperthreaded))-- this will most likely be the most optimal configuration. If the number of cores on the system is low, you may want to use n$\ast$num\+Threads for some integer n instead, depending on the system.

chain\+\_\+distribution\+\_\+scheme\+:

\char`\"{}cold\char`\"{}\+: All chains are added at T=1 (untempered)

\char`\"{}refine\char`\"{}\+: Chains are added between the optimal temps geometrically -- this may be a good option as it will be a good approximation of the ideal distribution of chains, while keeping the initial dynamical time low

\char`\"{}double\char`\"{}\+: Chains are added in order of rising temperature that mimic the distribution achieved by the earier PT dynamics

\char`\"{}half\+\_\+ensemble\char`\"{}\+: For every cold chain added, half of the ensemble is added again. Effectively, two cold chains for every ensemble 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}max\+\_\+chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a94f07c794491ccf76b31a57f4805e928}\label{mcmc__sampler_8cpp_a94f07c794491ccf76b31a57f4805e928}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output, shape is double\mbox{[}N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a33783ee80c1f93b43d1e9bca0dc55907}\label{mcmc__sampler_8cpp_a33783ee80c1f93b43d1e9bca0dc55907}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int dimension, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int dimension, double $\ast$$\ast$fisher, void $\ast$parameters)}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output , shape is double\mbox{[}N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em log\+\_\+prior} & Funcion pointer for the log\+\_\+prior \\
\hline
 & {\em log\+\_\+likelihood} & Function pointer for the log\+\_\+likelihood \\
\hline
 & {\em fisher} & Function pointer for the fisher -\/ if N\+U\+LL, fisher steps are not used \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a084c31ec2e87873946a4866b104fd733}\label{mcmc__sampler_8cpp_a084c31ec2e87873946a4866b104fd733}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal()}{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal()}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated\+\_\+internal (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Parallel tempered, dynamic chain allocation M\+C\+MC with output samples with specified maximum autocorrelation. 

Runs dynamic chain allocation until the autocorrelation lengths stabilize, then it will run the P\+T\+M\+C\+MC routine repeatedly, periodically thinning the chain to ensure the auto-\/correlation length is below the threshold

Note\+: smallest batch size is .5$\ast$\+N\+\_\+steps, so the target correlation length should be $<$$<$ less than this number

Note\+: This routine only works if the requested number of samples is larger than the typical correlation length of the unthinned chains. This is because the chains are run and tested in batches the size of the requested sample number.

Note\+: This method does N\+OT guarantee the final autocorrelation length of the chains will the be the target. It merely uses the requested autocorrelation length as a guide to thin the chains as samples are accrued and to estimate the total number of effective samples. Its best to request extra samples and thin the chains out at the end one final time, or to run multiple runs and combine the results at the end. $<$ dimension of the parameter space being explored

$<$ Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation

$<$ Maximum number of chains to use

$<$ Maximum number of chains to use in the thermodynamic ensemble (may use less)

$<$ the frequency with which chains are swapped

$<$ Time constant of the decay of the chain dynamics ($\sim$1000)

$<$ Initial amplitude of the dynamics ($\sim$100)

$<$ Maxmimum allowed autocorrelation of the samples -- suggested is 50

$<$Number of segments to calculate autocorrelation on for diagnostics

$<$ Fractional threshold for convergence of autocorrelation

$<$Target correlation for calculating autocorrelation length

$<$ std\+::function for the log\+\_\+prior function -- takes double $\ast$position, int dimension, int chain\+\_\+id

$<$ std\+::function for the log\+\_\+likelihood function -- takes double $\ast$position, int dimension, int chain\+\_\+id

$<$ std\+::function for the fisher function -- takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id

$<$ Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+LL

$<$ Number of threads to use (=1 is single threaded)

$<$ boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads)

$<$ boolean whether to print out progress (for example, should be set to \`{}`false'\textquotesingle{} if submitting to a cluster)

$<$ Filename to output sampling statistics, if empty string, not output

$<$ Filename to output data (chain 0 only), if empty string, not output

$<$ Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -- use empty string to skip

$<$ Filename to output data for checkpoint, if empty string, not saved
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output shape is double\mbox{[}N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
 & {\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
 & {\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em chain\+\_\+temps} & Final chain temperatures used -\/-\/ should be shape double\mbox{[}chain\+\_\+N\mbox{]} \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
 & {\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
 & {\em corr\+\_\+threshold} & Maxmimum allowed autocorrelation of the samples -\/-\/ suggested is 50 \\
\hline
 & {\em corr\+\_\+segments} & Number of segments to calculate autocorrelation on for diagnostics \\
\hline
 & {\em corr\+\_\+converge\+\_\+thresh} & Fractional threshold for convergence of autocorrelation \\
\hline
 & {\em corr\+\_\+target\+\_\+ac} & Target correlation for calculating autocorrelation length \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_afa5117c4dfe1ac8bd457fb7bee622c6f}\label{mcmc__sampler_8cpp_afa5117c4dfe1ac8bd457fb7bee622c6f}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal\_driver@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal\_driver}}
\index{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal\_driver@{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal\_driver}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal\_driver()}{PTMCMC\_MH\_dynamic\_PT\_alloc\_uncorrelated\_internal\_driver()}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic\+\_\+\+P\+T\+\_\+alloc\+\_\+uncorrelated\+\_\+internal\+\_\+driver (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{int}]{max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble,  }\item[{int}]{swp\+\_\+freq,  }\item[{int}]{t0,  }\item[{int}]{nu,  }\item[{int}]{corr\+\_\+threshold,  }\item[{int}]{corr\+\_\+segments,  }\item[{double}]{corr\+\_\+converge\+\_\+thresh,  }\item[{double}]{corr\+\_\+target\+\_\+ac,  }\item[{std\+::string}]{chain\+\_\+distribution\+\_\+scheme,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Driver routine for the uncorrelated sampler -- trying not to repeat code. 

Assumed that the checkpoint\+\_\+file has already been populated --

It will overwrite all the file paths 
\begin{DoxyParams}{Parameters}
{\em dimension} & dimension of the parameter space being explored \\
\hline
{\em N\+\_\+steps} & Number of total steps to be taken, per chain A\+F\+T\+ER chain allocation \\
\hline
{\em chain\+\_\+N} & Maximum number of chains to use \\
\hline
{\em max\+\_\+chain\+\_\+\+N\+\_\+thermo\+\_\+ensemble} & Maximum number of chains to use in the thermodynamic ensemble (may use less) \\
\hline
{\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
{\em t0} & Time constant of the decay of the chain dynamics ($\sim$1000) \\
\hline
{\em nu} & Initial amplitude of the dynamics ($\sim$100) \\
\hline
{\em corr\+\_\+threshold} & Maxmimum allowed autocorrelation of the samples -\/-\/ suggested is 50 \\
\hline
{\em corr\+\_\+segments} & Number of segments to calculate autocorrelation on for diagnostics \\
\hline
{\em corr\+\_\+converge\+\_\+thresh} & Fractional threshold for convergence of autocorrelation \\
\hline
{\em corr\+\_\+target\+\_\+ac} & Target correlation for calculating autocorrelation length \\
\hline
{\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
{\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
{\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
{\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
{\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
{\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
{\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
{\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
{\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
{\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
{\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a5c94625e7e33e0d077ebb9ea7501fbe6}\label{mcmc__sampler_8cpp_a5c94625e7e33e0d077ebb9ea7501fbe6}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_internal@{PTMCMC\_MH\_internal}}
\index{PTMCMC\_MH\_internal@{PTMCMC\_MH\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_internal()}{PTMCMC\_MH\_internal()}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int}]{dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Generic sampler, where the likelihood, prior are parameters supplied by the user. 

Base of the sampler, generic, with user supplied quantities for most of the samplers properties

Uses the Metropolis-\/\+Hastings method, with the option for Fisher/\+M\+A\+LA steps if the Fisher routine is supplied.

3 modes to use -\/

single threaded (num\+Threads = 1) runs single threaded

multi-\/threaded \`{}`deterministic'\textquotesingle{} (num\+Threads$>$1 ; pool = false) progresses each chain in parallel for swp\+\_\+freq steps, then waits for all threads to complete before swapping temperatures in sequenctial order (j, j+1) then (j+1, j+2) etc (sequenctially)

multi-\/threaded \`{}`stochastic'\textquotesingle{} (num\+Threads$>$2 ; pool = true) progresses each chain in parallel by queueing each temperature and evaluating them in the order they were submitted. Once finished, the threads are queued to swap, where they swapped in the order they are submitted. This means the chains are swapped randomly, and the chains do N\+OT finish at the same time. The sampler runs until the the 0th chain reaches the step number

Note on limits\+: In the prior function, if a set of parameters should be disallowed, return -\/std\+::numeric\+\_\+limits$<$double$>$\+::infinity() -- (this is in the $<$limits$>$ file in std)

Format for the auto\+\_\+corr file (compatable with csv, dat, txt extensions)\+: each row is a dimension of the cold chain, with the first row being the lengths used for the auto-\/corr calculation\+:

lengths\+: length1 , length2 ...

dim1\+: length1 , length2 ...

Format for the chain file (compatable with csv, dat, txt extensions)\+: each row is a step, each column a dimension\+:

Step1\+: dim1 , dim2 , ...

Step2\+: dim1 , dim2 , ...

Statistics\+\_\+filename \+: should be txt extension

checkpoint\+\_\+file \+: This file saves the final position of all the chains, as well as other metadata, and can be loaded by the function $<$\+F\+U\+N\+C\+T\+I\+O\+N$>$ to continue the chain from the point it left off. Not meant to be read by humans, the data order is custom to this software library. An empty string (\char`\"{}\char`\"{}) means no checkpoint will be saved. For developers, the contents are\+:

dimension, \# of chains

temps of chains

Stepping widths of all chains

Final position of all chains 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em dimension} & dimension of the parameter space being explored \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain \\
\hline
 & {\em chain\+\_\+N} & Number of chains \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em chain\+\_\+temps} & Double array of temperatures for the chains \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_aaa8ccb67ad90a3d27d713fcd652adfd2}\label{mcmc__sampler_8cpp_aaa8ccb67ad90a3d27d713fcd652adfd2}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_loop@{PTMCMC\_MH\_loop}}
\index{PTMCMC\_MH\_loop@{PTMCMC\_MH\_loop}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_loop()}{PTMCMC\_MH\_loop()}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+loop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsampler}{sampler}} $\ast$}]{sampler }\end{DoxyParamCaption})}



Internal function that runs the actual loop for the sampler. 

\mbox{\Hypertarget{mcmc__sampler_8cpp_a772e17f2034573d79c02bfa0ecd8c990}\label{mcmc__sampler_8cpp_a772e17f2034573d79c02bfa0ecd8c990}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!PTMCMC\_MH\_step\_incremental@{PTMCMC\_MH\_step\_incremental}}
\index{PTMCMC\_MH\_step\_incremental@{PTMCMC\_MH\_step\_incremental}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{PTMCMC\_MH\_step\_incremental()}{PTMCMC\_MH\_step\_incremental()}}
{\footnotesize\ttfamily void P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+step\+\_\+incremental (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsampler}{sampler}} $\ast$}]{sampler,  }\item[{int}]{increment }\end{DoxyParamCaption})}



Internal function that runs the actual loop for the sampler -- increment version. 

The regular loop function runs for the entire range, this increment version will only step \`{}`increment'\textquotesingle{} steps -- asynchronous\+: steps are measured by the cold chains N\+E\+E\+DS TO C\+H\+A\+N\+GE\mbox{\Hypertarget{mcmc__sampler_8cpp_aa5e2015504c9cc1adc3b3ad30e8b143b}\label{mcmc__sampler_8cpp_aa5e2015504c9cc1adc3b3ad30e8b143b}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!RJPTMCMC\_MH@{RJPTMCMC\_MH}}
\index{RJPTMCMC\_MH@{RJPTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{RJPTMCMC\_MH()}{RJPTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int $\ast$$\ast$$\ast$}]{parameter\+\_\+status,  }\item[{int}]{max\+\_\+dimension,  }\item[{int}]{min\+\_\+dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{int $\ast$}]{initial\+\_\+status,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void($\ast$)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, double gaussian\+\_\+width, void $\ast$parameters)}]{R\+J\+\_\+proposal,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em parameter\+\_\+status} & Parameter status for each step corresponding to the output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em max\+\_\+dimension} & maximum dimension of the parameter space being explored -\/-\/ only consideration is memory, as memory scales with dimension. Keep this reasonable, unless memory is R\+E\+A\+L\+LY not an issue \\
\hline
 & {\em min\+\_\+dimension} & minimum dimension of the parameter space being explored $>$=1 \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain \\
\hline
 & {\em chain\+\_\+N} & Number of chains \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em initial\+\_\+status} & Initial status of the parameters in the initial position in parameter space -\/ shape int\mbox{[}max\+\_\+dim\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}max\+\_\+dimension\mbox{]} -\/-\/ initial seeding of zero corresponds to the dimension turned off initially \\
\hline
 & {\em chain\+\_\+temps} & Double array of temperatures for the chains \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em R\+J\+\_\+proposal} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a3899aea46258af11e00fc114bb648525}\label{mcmc__sampler_8cpp_a3899aea46258af11e00fc114bb648525}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!RJPTMCMC\_MH@{RJPTMCMC\_MH}}
\index{RJPTMCMC\_MH@{RJPTMCMC\_MH}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{RJPTMCMC\_MH()}{RJPTMCMC\_MH()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+MH (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int $\ast$$\ast$$\ast$}]{parameter\+\_\+status,  }\item[{int}]{max\+\_\+dimension,  }\item[{int}]{min\+\_\+dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{int $\ast$}]{initial\+\_\+status,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+prior,  }\item[{double($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{log\+\_\+likelihood,  }\item[{void($\ast$)(double $\ast$param, int $\ast$status, int max\+\_\+dimension, double $\ast$$\ast$fisher, int chain\+\_\+id, void $\ast$parameters)}]{fisher,  }\item[{void($\ast$)(double $\ast$current\+\_\+param, double $\ast$proposed\+\_\+param, int $\ast$current\+\_\+status, int $\ast$proposed\+\_\+status, int max\+\_\+dimension, int chain\+\_\+id, void $\ast$parameters)}]{R\+J\+\_\+proposal,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em parameter\+\_\+status} & Parameter status for each step corresponding to the output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em max\+\_\+dimension} & maximum dimension of the parameter space being explored -\/-\/ only consideration is memory, as memory scales with dimension. Keep this reasonable, unless memory is R\+E\+A\+L\+LY not an issue \\
\hline
 & {\em min\+\_\+dimension} & minimum dimension of the parameter space being explored $>$=1 \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain \\
\hline
 & {\em chain\+\_\+N} & Number of chains \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em initial\+\_\+status} & Initial status of the parameters in the initial position in parameter space -\/ shape int\mbox{[}max\+\_\+dim\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}max\+\_\+dimension\mbox{]} -\/-\/ initial seeding of zero corresponds to the dimension turned off initially \\
\hline
 & {\em chain\+\_\+temps} & Double array of temperatures for the chains \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em R\+J\+\_\+proposal} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mcmc__sampler_8cpp_a40dcca4742325ca439a175415cf87750}\label{mcmc__sampler_8cpp_a40dcca4742325ca439a175415cf87750}} 
\index{mcmc\_sampler.cpp@{mcmc\_sampler.cpp}!RJPTMCMC\_MH\_internal@{RJPTMCMC\_MH\_internal}}
\index{RJPTMCMC\_MH\_internal@{RJPTMCMC\_MH\_internal}!mcmc\_sampler.cpp@{mcmc\_sampler.cpp}}
\doxysubsubsection{\texorpdfstring{RJPTMCMC\_MH\_internal()}{RJPTMCMC\_MH\_internal()}}
{\footnotesize\ttfamily void R\+J\+P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+internal (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{output,  }\item[{int $\ast$$\ast$$\ast$}]{parameter\+\_\+status,  }\item[{int}]{max\+\_\+dimension,  }\item[{int}]{min\+\_\+dimension,  }\item[{int}]{N\+\_\+steps,  }\item[{int}]{chain\+\_\+N,  }\item[{double $\ast$}]{initial\+\_\+pos,  }\item[{int $\ast$}]{initial\+\_\+status,  }\item[{double $\ast$}]{seeding\+\_\+var,  }\item[{double $\ast$}]{chain\+\_\+temps,  }\item[{int}]{swp\+\_\+freq,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+prior,  }\item[{std\+::function$<$ double(double $\ast$, int $\ast$, int, int, void $\ast$)$>$}]{log\+\_\+likelihood,  }\item[{std\+::function$<$ void(double $\ast$, int $\ast$, int, double $\ast$$\ast$, int, void $\ast$)$>$}]{fisher,  }\item[{std\+::function$<$ void(double $\ast$, double $\ast$, int $\ast$, int $\ast$, int, int, int, void $\ast$)$>$}]{R\+J\+\_\+proposal,  }\item[{void $\ast$$\ast$}]{user\+\_\+parameters,  }\item[{int}]{num\+Threads,  }\item[{bool}]{pool,  }\item[{bool}]{show\+\_\+prog,  }\item[{bool}]{update\+\_\+\+R\+J\+\_\+width,  }\item[{std\+::string}]{statistics\+\_\+filename,  }\item[{std\+::string}]{chain\+\_\+filename,  }\item[{std\+::string}]{auto\+\_\+corr\+\_\+filename,  }\item[{std\+::string}]{likelihood\+\_\+log\+\_\+filename,  }\item[{std\+::string}]{checkpoint\+\_\+file }\end{DoxyParamCaption})}



Generic reversable jump sampler, where the likelihood, prior, and reversable jump proposal are parameters supplied by the user. 

Note\+: Using a min\+\_\+dimension tells the sampler that there is a {\ttfamily base model\textquotesingle{}\textquotesingle{}, and that the dimensions from min\+\_\+dim to max\+\_\+dim are}small\textquotesingle{}\textquotesingle{} corrections to that model. This helps inform some of the proposal algorithms and speeds up computation. If using discrete models with no overlap of variables (ie model A or model B), set min\+\_\+dim to 0. Even if reusing certain parameters, if the extra dimensions don\textquotesingle{}t describe {\ttfamily small\textquotesingle{}\textquotesingle{} deviations, it\textquotesingle{}s probably best to set min\+\_\+dim to 0.\+Since the RJ proposal is user specified, even if there are parameters that should never be removed, it\textquotesingle{}s up to the user to dictate that. Using min\+\_\+dim will not affect that aspect of the sampler. If there\textquotesingle{}s a}base-\/model\textquotesingle{}\textquotesingle{}, the fisher function should produce a fisher matrix for the base model only. The modifications are then normally distributed around the last parameter value. Then the fisher function should take the minimum dimension instead of the maximum, like the other functions.

Currently, no dynamic PT option, as it would be too many free parameters for the sampler to converge to a reasonable temperature distribution in a reasonable amount of time. Best use case, use the P\+T\+M\+C\+M\+C\+\_\+\+M\+H\+\_\+dynamic for the \`{}`base'\textquotesingle{} dimension space, and use that temperature ladder.

Base of the sampler, generic, with user supplied quantities for most of the samplers properties

Uses the Metropolis-\/\+Hastings method, with the option for Fisher/\+M\+A\+LA steps if the Fisher routine is supplied.

3 modes to use -\/

single threaded (num\+Threads = 1) runs single threaded

multi-\/threaded \`{}`deterministic'\textquotesingle{} (num\+Threads$>$1 ; pool = false) progresses each chain in parallel for swp\+\_\+freq steps, then waits for all threads to complete before swapping temperatures in sequenctial order (j, j+1) then (j+1, j+2) etc (sequenctially)

multi-\/threaded \`{}`stochastic'\textquotesingle{} (num\+Threads$>$2 ; pool = true) progresses each chain in parallel by queueing each temperature and evaluating them in the order they were submitted. Once finished, the threads are queued to swap, where they swapped in the order they are submitted. This means the chains are swapped randomly, and the chains do N\+OT finish at the same time. The sampler runs until the the 0th chain reaches the step number

Note on limits\+: In the prior function, if a set of parameters should be disallowed, return -\/std\+::numeric\+\_\+limits$<$double$>$\+::infinity() -- (this is in the $<$limits$>$ file in std)

The parameter array uses the dimensions \mbox{[}0,min\+\_\+dim\mbox{]} always, and \mbox{[}min\+\_\+dim, max\+\_\+dim\mbox{]} in R\+J\+P\+T\+M\+C\+MC fashion

Format for the auto\+\_\+corr file (compatable with csv, dat, txt extensions)\+: each row is a dimension of the cold chain, with the first row being the lengths used for the auto-\/corr calculation\+:

lengths\+: length1 , length2 ...

dim1\+: length1 , length2 ...

Format for the chain file (compatable with csv, dat, txt extensions)\+: each row is a step, each column a dimension\+:

Step1\+: dim1 , dim2 , ..., max\+\_\+dim, param\+\_\+status1, param\+\_\+status2, ...

Step2\+: dim1 , dim2 , ..., max\+\_\+dim, param\+\_\+status1, param\+\_\+status2, ...

Statistics\+\_\+filename \+: should be txt extension

checkpoint\+\_\+file \+: This file saves the final position of all the chains, as well as other metadata, and can be loaded by the function $<$\+F\+U\+N\+C\+T\+I\+O\+N$>$ to continue the chain from the point it left off. Not meant to be read by humans, the data order is custom to this software library. An empty string (\char`\"{}\char`\"{}) means no checkpoint will be saved. For developers, the contents are\+:

dimension, \# of chains

temps of chains

Stepping widths of all chains

Final position of all chains 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
\mbox{\texttt{ out}}  & {\em parameter\+\_\+status} & Parameter status for each step corresponding to the output chains, shape is double\mbox{[}chain\+\_\+N, N\+\_\+steps,dimension\mbox{]} \\
\hline
 & {\em max\+\_\+dimension} & maximum dimension of the parameter space being explored -\/-\/ only consideration is memory, as memory scales with dimension. Keep this reasonable, unless memory is R\+E\+A\+L\+LY not an issue \\
\hline
 & {\em min\+\_\+dimension} & minimum dimension of the parameter space being explored $>$=1 \\
\hline
 & {\em N\+\_\+steps} & Number of total steps to be taken, per chain \\
\hline
 & {\em chain\+\_\+N} & Number of chains \\
\hline
 & {\em initial\+\_\+pos} & Initial position in parameter space -\/ shape double\mbox{[}dimension\mbox{]} \\
\hline
 & {\em initial\+\_\+status} & Initial status of the parameters in the initial position in parameter space -\/ shape int\mbox{[}max\+\_\+dim\mbox{]} \\
\hline
 & {\em seeding\+\_\+var} & Variance of the normal distribution used to seed each chain higher than 0 -\/ shape double\mbox{[}max\+\_\+dimension\mbox{]} -\/-\/ initial seeding of zero corresponds to the dimension turned off initially \\
\hline
 & {\em chain\+\_\+temps} & Double array of temperatures for the chains \\
\hline
 & {\em swp\+\_\+freq} & the frequency with which chains are swapped \\
\hline
 & {\em log\+\_\+prior} & std\+::function for the log\+\_\+prior function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status, int dimension, int chain\+\_\+id \\
\hline
 & {\em log\+\_\+likelihood} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em fisher} & std\+::function for the fisher function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, double $\ast$$\ast$output\+\_\+fisher, int chain\+\_\+id \\
\hline
 & {\em R\+J\+\_\+proposal} & std\+::function for the log\+\_\+likelihood function -\/-\/ takes double $\ast$position, int $\ast$param\+\_\+status,int dimension, int chain\+\_\+id \\
\hline
 & {\em user\+\_\+parameters} & Void pointer to any parameters the user may need inside log\+\_\+prior, log\+\_\+likelihood, or fisher. Should have one pointer for each chain. If this isn\textquotesingle{}t needed, use (void$\ast$$\ast$) N\+U\+L\+L$\ast$ \\
\hline
 & {\em num\+Threads} & Number of threads to use (=1 is single threaded) \\
\hline
 & {\em pool} & boolean to use stochastic chain swapping (M\+U\+ST have $>$2 threads) \\
\hline
 & {\em show\+\_\+prog} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em update\+\_\+\+R\+J\+\_\+width} & boolean whether to print out progress (for example, should be set to \`{}\`{}false\textquotesingle{}\textquotesingle{} if submitting to a cluster) \\
\hline
 & {\em statistics\+\_\+filename} & Filename to output sampling statistics, if empty string, not output \\
\hline
 & {\em chain\+\_\+filename} & Filename to output data (chain 0 only), if empty string, not output -\/-\/ if multiple cold chains, it will append each output to the other, and write out the total \\
\hline
 & {\em auto\+\_\+corr\+\_\+filename} & Filename to output auto correlation in some interval, if empty string, not output \\
\hline
 & {\em likelihood\+\_\+log\+\_\+filename} & Filename to write the log\+\_\+likelihood and log\+\_\+prior at each step -\/-\/ use empty string to skip \\
\hline
 & {\em checkpoint\+\_\+file} & Filename to output data for checkpoint, if empty string, not saved \\
\hline
\end{DoxyParams}
