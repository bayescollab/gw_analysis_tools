\hypertarget{util_8h}{}\doxysection{include/gwat/util.h File Reference}
\label{util_8h}\index{include/gwat/util.h@{include/gwat/util.h}}
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$complex$>$}\newline
{\ttfamily \#include \char`\"{}adolc/adouble.\+h\char`\"{}}\newline
{\ttfamily \#include $<$fftw3.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+interp.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+spline.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+errno.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+rng.\+h$>$}\newline
Include dependency graph for util.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structfftw__outline}{fftw\+\_\+outline}}
\item 
struct \mbox{\hyperlink{structsph__harm}{sph\+\_\+harm$<$ T $>$}}
\item 
class \mbox{\hyperlink{classgen__params__base}{gen\+\_\+params\+\_\+base$<$ T $>$}}
\item 
class \mbox{\hyperlink{classgen__params}{gen\+\_\+params}}
\begin{DoxyCompactList}\small\item\em convience wrapper for the \mbox{\hyperlink{classgen__params__base}{gen\+\_\+params\+\_\+base}} class \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structuseful__powers}{useful\+\_\+powers$<$ T $>$}}
\begin{DoxyCompactList}\small\item\em To speed up calculations within the for loops, we pre-\/calculate reoccuring powers of M$\ast$F and Pi, since the pow() function is prohibatively slow. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsource__parameters}{source\+\_\+parameters$<$ T $>$}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{util_8h_a93f03159397f25c687840129b18c972d}\label{util_8h_a93f03159397f25c687840129b18c972d}} 
\#define {\bfseries P\+B\+S\+TR}~\char`\"{}$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$$\vert$\char`\"{}
\item 
\mbox{\Hypertarget{util_8h_a69793e71975c25754a8236df29896e15}\label{util_8h_a69793e71975c25754a8236df29896e15}} 
\#define {\bfseries P\+B\+W\+I\+D\+TH}~60
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class T , class U $>$ }\\void \mbox{\hyperlink{util_8h_a168fd7e5d1d20a344c7bc5e6ced76763}{transform\+\_\+parameters}} (\mbox{\hyperlink{classgen__params__base}{gen\+\_\+params\+\_\+base}}$<$ T $>$ $\ast$param\+\_\+in, \mbox{\hyperlink{classgen__params__base}{gen\+\_\+params\+\_\+base}}$<$ U $>$ $\ast$param\+\_\+out)
\begin{DoxyCompactList}\small\item\em Simple utility to copy the members of param\+\_\+in to param\+\_\+out, for whatever types those are. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_a178bf529eadac2d4e27e6919f322734a}{A0\+\_\+from\+\_\+\+DL}} (T chirpmass, T DL, bool sky\+\_\+average)
\begin{DoxyCompactList}\small\item\em Transforms between chirpmass and DL to overall amplitude factor A0. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_aa66116cc2ddd8ba609a68a4c0cdca635}{D\+L\+\_\+from\+\_\+\+A0}} (T chirpmass, T A0, bool sky\+\_\+average)
\begin{DoxyCompactList}\small\item\em Transforms between amplitude factor A0 and chirpmass to DL. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{util_8h_abd99f3492eda3805283a6a6c1161f61f}{initiate\+\_\+\+Lum\+D\+\_\+\+Z\+\_\+interp}} (gsl\+\_\+interp\+\_\+accel $\ast$$\ast$Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr, gsl\+\_\+spline $\ast$$\ast$Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr)
\begin{DoxyCompactList}\small\item\em Function that uses the G\+SL libraries to interpolate pre-\/calculated Z-\/\+D\+\_\+L data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a9ec71fbb0a133a3099b570e6cfe4c116}\label{util_8h_a9ec71fbb0a133a3099b570e6cfe4c116}} 
void \mbox{\hyperlink{util_8h_a9ec71fbb0a133a3099b570e6cfe4c116}{free\+\_\+\+Lum\+D\+\_\+\+Z\+\_\+interp}} (gsl\+\_\+interp\+\_\+accel $\ast$$\ast$Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr, gsl\+\_\+spline $\ast$$\ast$Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr)
\begin{DoxyCompactList}\small\item\em Frees the allocated interpolation function. \end{DoxyCompactList}\item 
adouble \mbox{\hyperlink{util_8h_aec48ba6d02ebe433a684e09884e6a31b}{Z\+\_\+from\+\_\+\+D\+L\+\_\+interp}} (adouble DL, gsl\+\_\+interp\+\_\+accel $\ast$Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr, gsl\+\_\+spline $\ast$Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr)
\item 
double \mbox{\hyperlink{util_8h_a8d080a588955cc9cb0a4efc831187936}{Z\+\_\+from\+\_\+\+D\+L\+\_\+interp}} (double DL, gsl\+\_\+interp\+\_\+accel $\ast$Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr, gsl\+\_\+spline $\ast$Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr)
\item 
double \mbox{\hyperlink{util_8h_a415ef00e103efe73c8eabc235b202b12}{Z\+\_\+from\+\_\+\+DL}} (double DL, std\+::string cosmology)
\begin{DoxyCompactList}\small\item\em Calculates the redshift given the luminosity distance. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{util_8h_a88960e6947432b203d2c7ebb436e1984}{D\+L\+\_\+from\+\_\+Z}} (double Z, std\+::string cosmology)
\begin{DoxyCompactList}\small\item\em Calculates the luminosity distance given the redshift. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{util_8h_afc70040a4b2855ffc42c1f8b91e87fc2}{cosmology\+\_\+interpolation\+\_\+function}} (double x, double $\ast$coeffs, int interp\+\_\+degree)
\begin{DoxyCompactList}\small\item\em Custom interpolation function used in the cosmology calculations. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_afda1342d7215e52bcbb8f483ca576524}\label{util_8h_afda1342d7215e52bcbb8f483ca576524}} 
double \mbox{\hyperlink{util_8h_afda1342d7215e52bcbb8f483ca576524}{cosmology\+\_\+lookup}} (std\+::string cosmology)
\begin{DoxyCompactList}\small\item\em Helper function for mapping cosmology name to an internal index. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{util_8h_aa82ab145d4f623214c1492589e4327bf}{gsl\+\_\+maxwell\+\_\+boltzmann\+\_\+distribution}} (double sigma, gsl\+\_\+rng $\ast$r)
\begin{DoxyCompactList}\small\item\em Calculates a random number from the Maxwell-\/\+Boltzmann distribution using 3 gaussian random numbers. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a9d0768e0355feef9d4d9681e6eed27b4}{list\+\_\+intersect\+\_\+ptrs}} (T $\ast$$\ast$A, int lenA, T $\ast$$\ast$B, int lenB, T $\ast$$\ast$C, int $\ast$lenC)
\begin{DoxyCompactList}\small\item\em Custom list-\/interesction implementation for sorted lists. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a6a20a9cb79b3c847fc75f3e3eb45f933}{list\+\_\+intersect}} (T $\ast$A, int lenA, T $\ast$B, int lenB, T $\ast$$\ast$C, int $\ast$lenC)
\begin{DoxyCompactList}\small\item\em Custom list-\/interesction implementation for sorted lists. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\bool \mbox{\hyperlink{util_8h_a9631c2bd8b5493af4df2528a44886fc6}{check\+\_\+list}} (T j, T $\ast$list, int length)
\begin{DoxyCompactList}\small\item\em Just a quick utility to see if an item is in a list. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\int \mbox{\hyperlink{util_8h_af81850392cb5ff136ea8d334952844e0}{check\+\_\+list\+\_\+id}} (T j, T $\ast$list, int length)
\begin{DoxyCompactList}\small\item\em Just a quick utility to see if an item is in a list. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a588d05c5e239cff9b87a31d20bb6aa78}\label{util_8h_a588d05c5e239cff9b87a31d20bb6aa78}} 
{\footnotesize template$<$class T $>$ }\\T {\bfseries copysign\+\_\+internal} (T val, T sign)
\item 
void \mbox{\hyperlink{util_8h_aa3b3e1ddc0801e2dcfa09d5683936817}{rm\+\_\+fisher\+\_\+dim}} (double $\ast$$\ast$input, int full\+\_\+dim, double $\ast$$\ast$output, int reduced\+\_\+dim, int $\ast$removed\+\_\+dims)
\begin{DoxyCompactList}\small\item\em Removes a dimension from a matrix (made with fishers in mind, but this is general) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a11145d2a037fa94ed58393c6f9b7eb6d}\label{util_8h_a11145d2a037fa94ed58393c6f9b7eb6d}} 
{\footnotesize template$<$class T $>$ }\\void {\bfseries gsl\+\_\+\+L\+U\+\_\+matrix\+\_\+invert} (T $\ast$$\ast$input, T $\ast$$\ast$inverse, int dim)
\item 
\mbox{\Hypertarget{util_8h_aba892910f0cef251be3ba7c561290761}\label{util_8h_aba892910f0cef251be3ba7c561290761}} 
int {\bfseries gsl\+\_\+cholesky\+\_\+matrix\+\_\+invert} (double $\ast$$\ast$input, double $\ast$$\ast$inverse, int dim)
\item 
int \mbox{\hyperlink{util_8h_a8289e1ab34de59220846f1114dd9f667}{normalized\+\_\+gsl\+\_\+cholesky\+\_\+matrix\+\_\+invert}} (double $\ast$$\ast$input, double $\ast$$\ast$inverse, int dim)
\begin{DoxyCompactList}\small\item\em Normalize the Fisher matrix before inversion to try and tame singularity issues\+: \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a15f9dbddbe35da0c1b39ea0f7ce6870e}\label{util_8h_a15f9dbddbe35da0c1b39ea0f7ce6870e}} 
adouble \mbox{\hyperlink{util_8h_a15f9dbddbe35da0c1b39ea0f7ce6870e}{Z\+\_\+from\+\_\+\+DL}} (adouble DL, std\+::string cosmology)
\begin{DoxyCompactList}\small\item\em Calculates the redshift given the luminosity distance adouble version for A\+D\+O\+L-\/C implementation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_ac5495a177f2316ca6dc0904f3643b7f1}\label{util_8h_ac5495a177f2316ca6dc0904f3643b7f1}} 
adouble \mbox{\hyperlink{util_8h_ac5495a177f2316ca6dc0904f3643b7f1}{D\+L\+\_\+from\+\_\+Z}} (adouble Z, std\+::string cosmology)
\begin{DoxyCompactList}\small\item\em Calculates the luminosity distance given the redshift adouble version for A\+D\+O\+L-\/C implementation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a89c3042d0c813fd58dcb6a433d26eaa4}\label{util_8h_a89c3042d0c813fd58dcb6a433d26eaa4}} 
adouble \mbox{\hyperlink{util_8h_a89c3042d0c813fd58dcb6a433d26eaa4}{cosmology\+\_\+interpolation\+\_\+function}} (adouble x, double $\ast$coeffs, int interp\+\_\+degree)
\begin{DoxyCompactList}\small\item\em Custom interpolation function used in the cosmology calculations adouble version for A\+D\+O\+L-\/C. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{util_8h_a132fb8304c25ab9a2e18327cfc65b013}{std\+\_\+omega}} (double RA, double std\+\_\+\+RA, double std\+\_\+\+D\+EC, double cov\+\_\+\+R\+A\+\_\+\+D\+EC)
\begin{DoxyCompactList}\small\item\em map the error on RA and D\+EC to error on solid angle \textbackslash{}\+Omega \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a44e97e344b2c1bce3ec660f34eef801d}\label{util_8h_a44e97e344b2c1bce3ec660f34eef801d}} 
bool {\bfseries check\+\_\+mod} (std\+::string generation\+\_\+method)
\item 
void \mbox{\hyperlink{util_8h_a9d3b483a858efb84ce776bed255b6dd6}{print\+Progress}} (double percentage)
\begin{DoxyCompactList}\small\item\em routine to print the progress of a process to the terminal as a progress bar \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a9d87eefd2881f9d512458bdcb05c9480}\label{util_8h_a9d87eefd2881f9d512458bdcb05c9480}} 
void \mbox{\hyperlink{util_8h_a9d87eefd2881f9d512458bdcb05c9480}{allocate\+\_\+\+F\+F\+T\+W\+\_\+mem\+\_\+forward}} (\mbox{\hyperlink{structfftw__outline}{fftw\+\_\+outline}} $\ast$plan, int length)
\begin{DoxyCompactList}\small\item\em Allocate memory for F\+F\+T\+W3 methods used in a lot of inner products input is a locally defined structure that houses all the pertinent data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_abfb132a88c05af083194d8ee163c6dcd}\label{util_8h_abfb132a88c05af083194d8ee163c6dcd}} 
void \mbox{\hyperlink{util_8h_abfb132a88c05af083194d8ee163c6dcd}{allocate\+\_\+\+F\+F\+T\+W\+\_\+mem\+\_\+reverse}} (\mbox{\hyperlink{structfftw__outline}{fftw\+\_\+outline}} $\ast$plan, int length)
\begin{DoxyCompactList}\small\item\em Allocate memory for F\+F\+T\+W3 methods used in a lot of inner products --I\+N\+V\+E\+R\+SE input is a locally defined structure that houses all the pertinent data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a564ceafac6d45bfc46b9960ff363be94}\label{util_8h_a564ceafac6d45bfc46b9960ff363be94}} 
void \mbox{\hyperlink{util_8h_a564ceafac6d45bfc46b9960ff363be94}{deallocate\+\_\+\+F\+F\+T\+W\+\_\+mem}} (\mbox{\hyperlink{structfftw__outline}{fftw\+\_\+outline}} $\ast$plan)
\begin{DoxyCompactList}\small\item\em deallocates the memory used for F\+F\+TW routines \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{util_8h_a8a13434c3294f699e10cefca9c9c1844}{allocate\+\_\+2\+D\+\_\+array}} (int dim1, int dim2)
\begin{DoxyCompactList}\small\item\em Utility to malloc 2D array. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_afdec1403ea2ff9eef323cdc5387d16d2}\label{util_8h_afdec1403ea2ff9eef323cdc5387d16d2}} 
int $\ast$$\ast$ {\bfseries allocate\+\_\+2\+D\+\_\+array\+\_\+int} (int dim1, int dim2)
\item 
void \mbox{\hyperlink{util_8h_aea1f110a690843c990c37728a928c61e}{deallocate\+\_\+2\+D\+\_\+array}} (double $\ast$$\ast$array, int dim1, int dim2)
\begin{DoxyCompactList}\small\item\em Utility to free malloc\textquotesingle{}d 2D array. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a6782402902d03d306b27b5ed748ff81d}\label{util_8h_a6782402902d03d306b27b5ed748ff81d}} 
void {\bfseries deallocate\+\_\+2\+D\+\_\+array} (int $\ast$$\ast$array, int dim1, int dim2)
\item 
double $\ast$$\ast$$\ast$ \mbox{\hyperlink{util_8h_ae68c88f497a666122282b9b0f960936a}{allocate\+\_\+3\+D\+\_\+array}} (int dim1, int dim2, int dim3)
\begin{DoxyCompactList}\small\item\em Utility to malloc 3D array. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a2735c4767bb31ba9dc947c2efedf29a4}\label{util_8h_a2735c4767bb31ba9dc947c2efedf29a4}} 
int $\ast$$\ast$$\ast$ {\bfseries allocate\+\_\+3\+D\+\_\+array\+\_\+int} (int dim1, int dim2, int dim3)
\item 
void \mbox{\hyperlink{util_8h_ad8ff675e46f7acf42d7763cc6a10d665}{deallocate\+\_\+3\+D\+\_\+array}} (double $\ast$$\ast$$\ast$array, int dim1, int dim2, int dim3)
\begin{DoxyCompactList}\small\item\em Utility to free malloc\textquotesingle{}d 2D array. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{util_8h_a002ad8ebbc188a3131bdc4ae82ac99ca}{deallocate\+\_\+3\+D\+\_\+array}} (int $\ast$$\ast$$\ast$array, int dim1, int dim2, int dim3)
\begin{DoxyCompactList}\small\item\em Utility to free malloc\textquotesingle{}d 2D array. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{util_8h_adcfd6e3f070e3c9bdae4a7cd03570f67}{tukey\+\_\+window}} (double $\ast$window, int length, double alpha)
\begin{DoxyCompactList}\small\item\em Tukey window function for F\+F\+Ts. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a969645fb30ec69bccd7848afe7ecef1f}{terr\+\_\+pol\+\_\+iota\+\_\+from\+\_\+equat\+\_\+sph}} (T RA, T D\+EC, T thetaj, T phij, T $\ast$pol, T $\ast$iota)
\begin{DoxyCompactList}\small\item\em Routine to transform from the equatorial coordinate system spherical polar description of the total angular momentum to the detector specific polarization angle and inclination angle (of the total angular momentum) \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_afdfcd17d8243226898e2fbaa72f8112c}{ecl\+\_\+from\+\_\+eq}} (T theta\+\_\+eq, T phi\+\_\+eq, T $\ast$theta\+\_\+ecl, T $\ast$phi\+\_\+ecl)
\begin{DoxyCompactList}\small\item\em transform spherical angles from equatorial to ecliptic \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a63dca51c4dc6a81a582bb5ae69cb325d}{equatorial\+\_\+from\+\_\+\+SF}} (T $\ast$S\+Fvec, T thetal, T phil, T thetas, T phis, T iota, T phi\+\_\+ref, T $\ast$E\+Qvec)
\begin{DoxyCompactList}\small\item\em Utility to map source frame vectors to equatorial frame vectors. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a06ffbad5fe4daa3872db626f90556202}\label{util_8h_a06ffbad5fe4daa3872db626f90556202}} 
double \mbox{\hyperlink{util_8h_a06ffbad5fe4daa3872db626f90556202}{calculate\+\_\+eta}} (double mass1, double mass2)
\begin{DoxyCompactList}\small\item\em Calculates the symmetric mass ration from the two component masses. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_adc4391c722f94cb17f0e0275a0930fa9}\label{util_8h_adc4391c722f94cb17f0e0275a0930fa9}} 
adouble {\bfseries calculate\+\_\+eta} (adouble mass1, adouble mass2)
\item 
double \mbox{\hyperlink{util_8h_af7aeeebcf190ab70c667a478a51ce435}{calculate\+\_\+chirpmass}} (double mass1, double mass2)
\begin{DoxyCompactList}\small\item\em Calculates the chirp mass from the two component masses. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a0a7a0da86013d639bf8689c9a01d8583}\label{util_8h_a0a7a0da86013d639bf8689c9a01d8583}} 
adouble {\bfseries calculate\+\_\+chirpmass} (adouble mass1, adouble mass2)
\item 
double \mbox{\hyperlink{util_8h_a85a0fc50a6f06dd519a18a6d273a0b4a}{calculate\+\_\+mass1}} (double chirpmass, double eta)
\begin{DoxyCompactList}\small\item\em Calculates the larger mass given a chirp mass and symmetric mass ratio. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a663f11702648d9a84c9b573e9ab76f09}\label{util_8h_a663f11702648d9a84c9b573e9ab76f09}} 
adouble {\bfseries calculate\+\_\+mass1} (adouble chirpmass, adouble eta)
\item 
double \mbox{\hyperlink{util_8h_a5f62f4a7c1011180080d72e0032cef1b}{calculate\+\_\+mass2}} (double chirpmass, double eta)
\begin{DoxyCompactList}\small\item\em Calculates the smaller mass given a chirp mass and symmetric mass ratio. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_adb85ce9fbb2e3a438dd41a35c38a3237}\label{util_8h_adb85ce9fbb2e3a438dd41a35c38a3237}} 
adouble {\bfseries calculate\+\_\+mass2} (adouble chirpmass, adouble eta)
\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a55f693ec3edcca174373eb928d513dbc}{celestial\+\_\+horizon\+\_\+transform}} (T RA, T D\+EC, double gps\+\_\+time, T L\+O\+NG, T L\+AT, T $\ast$phi, T $\ast$theta)
\begin{DoxyCompactList}\small\item\em Utility to transform from celestial coord RA and D\+EC to local horizon coord for detector response functions. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_afd6029a6f28651af9d71382a4b4e0efb}\label{util_8h_afd6029a6f28651af9d71382a4b4e0efb}} 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_afd6029a6f28651af9d71382a4b4e0efb}{gps\+\_\+to\+\_\+\+G\+M\+ST}} (T gps\+\_\+time)
\begin{DoxyCompactList}\small\item\em Utility to transform from gps time to G\+M\+ST \href{https://aa.usno.navy.mil/faq/docs/GAST.php}{\texttt{ https\+://aa.\+usno.\+navy.\+mil/faq/docs/\+G\+A\+S\+T.\+php}}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_ab2a5f9f42b470f4d11945aad2835f99f}\label{util_8h_ab2a5f9f42b470f4d11945aad2835f99f}} 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_ab2a5f9f42b470f4d11945aad2835f99f}{gps\+\_\+to\+\_\+\+JD}} (T gps\+\_\+time)
\begin{DoxyCompactList}\small\item\em Utility to transform from gps to JD. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a817fd4d7413b4a2bfe05bfbc454766b2}{transform\+\_\+cart\+\_\+sph}} (T $\ast$cartvec, T $\ast$sphvec)
\begin{DoxyCompactList}\small\item\em utility to transform a vector from cartesian to spherical (radian) \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a3c767ffbc1073a544ae1630ffdea917e}{transform\+\_\+sph\+\_\+cart}} (T $\ast$sphvec, T $\ast$cartvec)
\begin{DoxyCompactList}\small\item\em utility to transform a vector from spherical (radian) to cartesian \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \mbox{\hyperlink{util_8h_a036fae37c6732da48e01ccc1331542d4}{unwrap\+\_\+array}} (T $\ast$in, T $\ast$out, int len)
\begin{DoxyCompactList}\small\item\em Unwrap angles from arctan. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_a185f5ce6420f94f03d77915d94b06f4f}{trapezoidal\+\_\+sum\+\_\+uniform}} (double delta\+\_\+x, int length, T $\ast$integrand)
\begin{DoxyCompactList}\small\item\em Trapezoidal sum rule to approximate discrete integral -\/ Uniform spacing. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_ab7d3ff0c020ec0ffbe56f4271f425d68}{trapezoidal\+\_\+sum}} (double $\ast$delta\+\_\+x, int length, T $\ast$integrand)
\begin{DoxyCompactList}\small\item\em Trapezoidal sum rule to approximate discrete integral -\/ Non-\/\+Uniform spacing. \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\T \mbox{\hyperlink{util_8h_ad77170ec9220ef33a32f2540e9184e31}{simpsons\+\_\+sum}} (double delta\+\_\+x, int length, T $\ast$integrand)
\begin{DoxyCompactList}\small\item\em Simpsons sum rule to approximate discrete integral -\/ Uniform spacing. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_ae40cc3f267c33745a8a2485638d5db55}\label{util_8h_ae40cc3f267c33745a8a2485638d5db55}} 
long \mbox{\hyperlink{util_8h_ae40cc3f267c33745a8a2485638d5db55}{factorial}} (long num)
\begin{DoxyCompactList}\small\item\em Local function to calculate a factorial. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{util_8h_a362581f25c83753aefac698e977cb73e}{pow\+\_\+int}} (double base, int power)
\begin{DoxyCompactList}\small\item\em Local power function, specifically for integer powers. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a2777502ea85828774e2a331576db996d}\label{util_8h_a2777502ea85828774e2a331576db996d}} 
adouble {\bfseries pow\+\_\+int} (adouble base, int power)
\item 
\mbox{\Hypertarget{util_8h_aa08b09388ea27effbf92d3cc4f15fb47}\label{util_8h_aa08b09388ea27effbf92d3cc4f15fb47}} 
{\footnotesize template$<$class T $>$ }\\std\+::complex$<$ T $>$ {\bfseries cpolar} (T mag, T phase)
\item 
{\footnotesize template$<$class T $>$ }\\std\+::complex$<$ T $>$ \mbox{\hyperlink{util_8h_af9aa77c0f12435f4c7e9f13dba8ca1f8}{X\+L\+A\+L\+Spin\+Weighted\+Spherical\+Harmonic}} (T theta, T phi, int s, int l, int m)
\item 
\mbox{\Hypertarget{util_8h_a9e568dd0950bb2aa1ae125c8153b8f4e}\label{util_8h_a9e568dd0950bb2aa1ae125c8153b8f4e}} 
double \mbox{\hyperlink{util_8h_a9e568dd0950bb2aa1ae125c8153b8f4e}{cbrt\+\_\+internal}} (double base)
\begin{DoxyCompactList}\small\item\em Fucntion that just returns the cuberoot. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{util_8h_a8dfef0b07ebb62c8d9f1f70624fa3e00}\label{util_8h_a8dfef0b07ebb62c8d9f1f70624fa3e00}} 
adouble \mbox{\hyperlink{util_8h_a8dfef0b07ebb62c8d9f1f70624fa3e00}{cbrt\+\_\+internal}} (adouble base)
\begin{DoxyCompactList}\small\item\em Fucntion that just returns the cuberoot A\+D\+O\+L-\/C doesn\textquotesingle{}t have the cbrt function (which is faster), so have to use the power function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const double \mbox{\hyperlink{util_8h_ae35ccfea47f0da0a31cf1d13c80f3c58}{gamma\+\_\+E}} = 0.\+5772156649015328606065120900824024310421
\item 
const double \mbox{\hyperlink{util_8h_a8fc6defe4e499b1b9b9c275689e44352}{c}} = 299792458.
\item 
const double \mbox{\hyperlink{util_8h_ab97e4616d23ed4c2961295010c1afc3c}{G}} =6.\+674e-\/11$\ast$(1.\+98855e30)
\item 
const double \mbox{\hyperlink{util_8h_a498f9210d23417e309c01ad5cb9a635b}{M\+S\+O\+L\+\_\+\+S\+EC}} =4.\+925491025543575903411922162094833998e-\/6
\item 
const double \mbox{\hyperlink{util_8h_a47be806b6c8a58bd030f167ca91ed201}{M\+P\+C\+\_\+\+S\+EC}} = 3.\+085677581491367278913937957796471611e22/\mbox{\hyperlink{util_8h_a8fc6defe4e499b1b9b9c275689e44352}{c}}
\item 
const double \mbox{\hyperlink{util_8h_a65f61647bc34ceeb4dc626f8f0625ec5}{T\+\_\+year}} = 31557600.
\item 
const double \mbox{\hyperlink{util_8h_ad996f6cd74a1b9c9c1c63c59db32e190}{T\+\_\+day}} = 24$\ast$3600.
\item 
const double \mbox{\hyperlink{util_8h_a19ace59856e55cca68458867a62d0bc4}{A\+X\+I\+A\+L\+\_\+\+T\+I\+LT}} =0.\+409092627749
\item 
const double \mbox{\hyperlink{util_8h_abcfdf85edc41c59ae55c3c45dc9c506a}{A\+U\+\_\+\+S\+EC}} = 499.\+005
\item 
const double \mbox{\hyperlink{util_8h_aeef10f63f0d33b2b400ac1948439ccfc}{R\+O\+O\+T\+\_\+\+T\+H\+R\+EE}} = std\+::sqrt(3.)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
General utilities (functions and structures) independent of modelling method 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{util_8h_a178bf529eadac2d4e27e6919f322734a}\label{util_8h_a178bf529eadac2d4e27e6919f322734a}} 
\index{util.h@{util.h}!A0\_from\_DL@{A0\_from\_DL}}
\index{A0\_from\_DL@{A0\_from\_DL}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{A0\_from\_DL()}{A0\_from\_DL()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
T A0\+\_\+from\+\_\+\+DL (\begin{DoxyParamCaption}\item[{T}]{chirpmass,  }\item[{T}]{DL,  }\item[{bool}]{sky\+\_\+average }\end{DoxyParamCaption})}



Transforms between chirpmass and DL to overall amplitude factor A0. 

All quantities in seconds \mbox{\Hypertarget{util_8h_a8a13434c3294f699e10cefca9c9c1844}\label{util_8h_a8a13434c3294f699e10cefca9c9c1844}} 
\index{util.h@{util.h}!allocate\_2D\_array@{allocate\_2D\_array}}
\index{allocate\_2D\_array@{allocate\_2D\_array}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{allocate\_2D\_array()}{allocate\_2D\_array()}}
{\footnotesize\ttfamily double$\ast$$\ast$ allocate\+\_\+2\+D\+\_\+array (\begin{DoxyParamCaption}\item[{int}]{dim1,  }\item[{int}]{dim2 }\end{DoxyParamCaption})}



Utility to malloc 2D array. 

\mbox{\Hypertarget{util_8h_ae68c88f497a666122282b9b0f960936a}\label{util_8h_ae68c88f497a666122282b9b0f960936a}} 
\index{util.h@{util.h}!allocate\_3D\_array@{allocate\_3D\_array}}
\index{allocate\_3D\_array@{allocate\_3D\_array}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{allocate\_3D\_array()}{allocate\_3D\_array()}}
{\footnotesize\ttfamily double$\ast$$\ast$$\ast$ allocate\+\_\+3\+D\+\_\+array (\begin{DoxyParamCaption}\item[{int}]{dim1,  }\item[{int}]{dim2,  }\item[{int}]{dim3 }\end{DoxyParamCaption})}



Utility to malloc 3D array. 

\mbox{\Hypertarget{util_8h_af7aeeebcf190ab70c667a478a51ce435}\label{util_8h_af7aeeebcf190ab70c667a478a51ce435}} 
\index{util.h@{util.h}!calculate\_chirpmass@{calculate\_chirpmass}}
\index{calculate\_chirpmass@{calculate\_chirpmass}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{calculate\_chirpmass()}{calculate\_chirpmass()}}
{\footnotesize\ttfamily double calculate\+\_\+chirpmass (\begin{DoxyParamCaption}\item[{double}]{mass1,  }\item[{double}]{mass2 }\end{DoxyParamCaption})}



Calculates the chirp mass from the two component masses. 

The output units are whatever units the input masses are \mbox{\Hypertarget{util_8h_a85a0fc50a6f06dd519a18a6d273a0b4a}\label{util_8h_a85a0fc50a6f06dd519a18a6d273a0b4a}} 
\index{util.h@{util.h}!calculate\_mass1@{calculate\_mass1}}
\index{calculate\_mass1@{calculate\_mass1}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{calculate\_mass1()}{calculate\_mass1()}}
{\footnotesize\ttfamily double calculate\+\_\+mass1 (\begin{DoxyParamCaption}\item[{double}]{chirpmass,  }\item[{double}]{eta }\end{DoxyParamCaption})}



Calculates the larger mass given a chirp mass and symmetric mass ratio. 

Units of the output match the units of the input chirp mass \mbox{\Hypertarget{util_8h_a5f62f4a7c1011180080d72e0032cef1b}\label{util_8h_a5f62f4a7c1011180080d72e0032cef1b}} 
\index{util.h@{util.h}!calculate\_mass2@{calculate\_mass2}}
\index{calculate\_mass2@{calculate\_mass2}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{calculate\_mass2()}{calculate\_mass2()}}
{\footnotesize\ttfamily double calculate\+\_\+mass2 (\begin{DoxyParamCaption}\item[{double}]{chirpmass,  }\item[{double}]{eta }\end{DoxyParamCaption})}



Calculates the smaller mass given a chirp mass and symmetric mass ratio. 

Units of the output match the units of the input chirp mass \mbox{\Hypertarget{util_8h_a55f693ec3edcca174373eb928d513dbc}\label{util_8h_a55f693ec3edcca174373eb928d513dbc}} 
\index{util.h@{util.h}!celestial\_horizon\_transform@{celestial\_horizon\_transform}}
\index{celestial\_horizon\_transform@{celestial\_horizon\_transform}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{celestial\_horizon\_transform()}{celestial\_horizon\_transform()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void celestial\+\_\+horizon\+\_\+transform (\begin{DoxyParamCaption}\item[{T}]{RA,  }\item[{T}]{D\+EC,  }\item[{double}]{gps\+\_\+time,  }\item[{T}]{L\+O\+NG,  }\item[{T}]{L\+AT,  }\item[{T $\ast$}]{phi,  }\item[{T $\ast$}]{theta }\end{DoxyParamCaption})}



Utility to transform from celestial coord RA and D\+EC to local horizon coord for detector response functions. 

Outputs are the spherical polar angles defined by North as 0 degrees azimuth and the normal to the earth as 0 degree polar 
\begin{DoxyParams}[1]{Parameters}
 & {\em RA} & Right acsension (rad) \\
\hline
 & {\em D\+EC} & Declination (rad) \\
\hline
 & {\em gps\+\_\+time} & G\+PS time \\
\hline
 & {\em L\+O\+NG} & Longitude (rad) \\
\hline
 & {\em L\+AT} & Latitude (rad) \\
\hline
\mbox{\texttt{ out}}  & {\em phi} & horizon azimuthal angle (rad) \\
\hline
\mbox{\texttt{ out}}  & {\em theta} & horizon polar angle (rad) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{util_8h_a9631c2bd8b5493af4df2528a44886fc6}\label{util_8h_a9631c2bd8b5493af4df2528a44886fc6}} 
\index{util.h@{util.h}!check\_list@{check\_list}}
\index{check\_list@{check\_list}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{check\_list()}{check\_list()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
bool check\+\_\+list (\begin{DoxyParamCaption}\item[{T}]{j,  }\item[{T $\ast$}]{list,  }\item[{int}]{length }\end{DoxyParamCaption})}



Just a quick utility to see if an item is in a list. 

Didn\textquotesingle{}t want to keep rewriting this loop \mbox{\Hypertarget{util_8h_af81850392cb5ff136ea8d334952844e0}\label{util_8h_af81850392cb5ff136ea8d334952844e0}} 
\index{util.h@{util.h}!check\_list\_id@{check\_list\_id}}
\index{check\_list\_id@{check\_list\_id}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{check\_list\_id()}{check\_list\_id()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
int check\+\_\+list\+\_\+id (\begin{DoxyParamCaption}\item[{T}]{j,  }\item[{T $\ast$}]{list,  }\item[{int}]{length }\end{DoxyParamCaption})}



Just a quick utility to see if an item is in a list. 

Didn\textquotesingle{}t want to keep rewriting this loop

Now returns the id of the element

Returns -\/1 if not found \mbox{\Hypertarget{util_8h_afc70040a4b2855ffc42c1f8b91e87fc2}\label{util_8h_afc70040a4b2855ffc42c1f8b91e87fc2}} 
\index{util.h@{util.h}!cosmology\_interpolation\_function@{cosmology\_interpolation\_function}}
\index{cosmology\_interpolation\_function@{cosmology\_interpolation\_function}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{cosmology\_interpolation\_function()}{cosmology\_interpolation\_function()}}
{\footnotesize\ttfamily double cosmology\+\_\+interpolation\+\_\+function (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double $\ast$}]{coeffs,  }\item[{int}]{interp\+\_\+degree }\end{DoxyParamCaption})}



Custom interpolation function used in the cosmology calculations. 

Power series in half power increments of x, up to 11/2. powers of x \mbox{\Hypertarget{util_8h_aea1f110a690843c990c37728a928c61e}\label{util_8h_aea1f110a690843c990c37728a928c61e}} 
\index{util.h@{util.h}!deallocate\_2D\_array@{deallocate\_2D\_array}}
\index{deallocate\_2D\_array@{deallocate\_2D\_array}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{deallocate\_2D\_array()}{deallocate\_2D\_array()}}
{\footnotesize\ttfamily void deallocate\+\_\+2\+D\+\_\+array (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{array,  }\item[{int}]{dim1,  }\item[{int}]{dim2 }\end{DoxyParamCaption})}



Utility to free malloc\textquotesingle{}d 2D array. 

\mbox{\Hypertarget{util_8h_ad8ff675e46f7acf42d7763cc6a10d665}\label{util_8h_ad8ff675e46f7acf42d7763cc6a10d665}} 
\index{util.h@{util.h}!deallocate\_3D\_array@{deallocate\_3D\_array}}
\index{deallocate\_3D\_array@{deallocate\_3D\_array}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{deallocate\_3D\_array()}{deallocate\_3D\_array()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void deallocate\+\_\+3\+D\+\_\+array (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$$\ast$}]{array,  }\item[{int}]{dim1,  }\item[{int}]{dim2,  }\item[{int}]{dim3 }\end{DoxyParamCaption})}



Utility to free malloc\textquotesingle{}d 2D array. 

\mbox{\Hypertarget{util_8h_a002ad8ebbc188a3131bdc4ae82ac99ca}\label{util_8h_a002ad8ebbc188a3131bdc4ae82ac99ca}} 
\index{util.h@{util.h}!deallocate\_3D\_array@{deallocate\_3D\_array}}
\index{deallocate\_3D\_array@{deallocate\_3D\_array}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{deallocate\_3D\_array()}{deallocate\_3D\_array()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void deallocate\+\_\+3\+D\+\_\+array (\begin{DoxyParamCaption}\item[{int $\ast$$\ast$$\ast$}]{array,  }\item[{int}]{dim1,  }\item[{int}]{dim2,  }\item[{int}]{dim3 }\end{DoxyParamCaption})}



Utility to free malloc\textquotesingle{}d 2D array. 

\mbox{\Hypertarget{util_8h_aa66116cc2ddd8ba609a68a4c0cdca635}\label{util_8h_aa66116cc2ddd8ba609a68a4c0cdca635}} 
\index{util.h@{util.h}!DL\_from\_A0@{DL\_from\_A0}}
\index{DL\_from\_A0@{DL\_from\_A0}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{DL\_from\_A0()}{DL\_from\_A0()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
T D\+L\+\_\+from\+\_\+\+A0 (\begin{DoxyParamCaption}\item[{T}]{chirpmass,  }\item[{T}]{A0,  }\item[{bool}]{sky\+\_\+average }\end{DoxyParamCaption})}



Transforms between amplitude factor A0 and chirpmass to DL. 

All quantities in seconds \mbox{\Hypertarget{util_8h_a88960e6947432b203d2c7ebb436e1984}\label{util_8h_a88960e6947432b203d2c7ebb436e1984}} 
\index{util.h@{util.h}!DL\_from\_Z@{DL\_from\_Z}}
\index{DL\_from\_Z@{DL\_from\_Z}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{DL\_from\_Z()}{DL\_from\_Z()}}
{\footnotesize\ttfamily double D\+L\+\_\+from\+\_\+Z (\begin{DoxyParamCaption}\item[{double}]{Z,  }\item[{std\+::string}]{cosmology }\end{DoxyParamCaption})}



Calculates the luminosity distance given the redshift. 

Based on Astropy.\+cosmology calculations -- see python script in the ./data folder of the project -- numerically calculated given astropy.\+cosmology\textquotesingle{}s definitions (\href{http://docs.astropy.org/en/stable/cosmology/}{\texttt{ http\+://docs.\+astropy.\+org/en/stable/cosmology/}}) and used scipy.\+optimize to fit to a power series, stepping in half powers of Z. These coefficients are then output to a header file (D\+\_\+\+Z\+\_\+config.\+h) which are used here to calculate distance. Custom cosmologies etc can easily be acheived by editing the python script D\+\_\+\+Z\+\_\+config.\+py, the c++ functions do not need modification. They use whatever data is available in the header file. If the functional form of the fitting function changes, these functions DO need to change.

5 cosmological models are available (this argument must be spelled exactly)\+:

P\+L\+A\+N\+C\+K15, P\+L\+A\+N\+C\+K13, W\+M\+A\+P9, W\+M\+A\+P7, W\+M\+A\+P5 \mbox{\Hypertarget{util_8h_afdfcd17d8243226898e2fbaa72f8112c}\label{util_8h_afdfcd17d8243226898e2fbaa72f8112c}} 
\index{util.h@{util.h}!ecl\_from\_eq@{ecl\_from\_eq}}
\index{ecl\_from\_eq@{ecl\_from\_eq}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{ecl\_from\_eq()}{ecl\_from\_eq()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void ecl\+\_\+from\+\_\+eq (\begin{DoxyParamCaption}\item[{T}]{theta\+\_\+eq,  }\item[{T}]{phi\+\_\+eq,  }\item[{T $\ast$}]{theta\+\_\+ecl,  }\item[{T $\ast$}]{phi\+\_\+ecl }\end{DoxyParamCaption})}



transform spherical angles from equatorial to ecliptic 

Rotation about the vernal equinox (x-\/hat in both coordinate systems) by the axial tilt or obliquity

From wikipedia

Compared against astropy and agrees 
\begin{DoxyParams}{Parameters}
{\em theta\+\_\+eq} & Equatorial spherical polar angle \\
\hline
{\em phi\+\_\+eq} & Equatorial spherical azimuthal angle \\
\hline
{\em theta\+\_\+ecl} & Ecliptic spherical polar angle \\
\hline
{\em phi\+\_\+ecl} & Ecliptic spherical Azimuthal angle \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{util_8h_a63dca51c4dc6a81a582bb5ae69cb325d}\label{util_8h_a63dca51c4dc6a81a582bb5ae69cb325d}} 
\index{util.h@{util.h}!equatorial\_from\_SF@{equatorial\_from\_SF}}
\index{equatorial\_from\_SF@{equatorial\_from\_SF}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{equatorial\_from\_SF()}{equatorial\_from\_SF()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void equatorial\+\_\+from\+\_\+\+SF (\begin{DoxyParamCaption}\item[{T $\ast$}]{S\+Fvec,  }\item[{T}]{thetal,  }\item[{T}]{phil,  }\item[{T}]{thetas,  }\item[{T}]{phis,  }\item[{T}]{iota,  }\item[{T}]{phi\+\_\+ref,  }\item[{T $\ast$}]{E\+Qvec }\end{DoxyParamCaption})}



Utility to map source frame vectors to equatorial frame vectors. 

Needs the equatorial vectors for the line of sight and the orbital angular momentum

Needs the inclination angle and the reference phase

Works by constructing a third vector from the cross product of the two others, in both frames. This defines a family of 3 vectors that can uniquely determine a rotation matrix from source frame to equatorial, which was done analytically in mathematica ( see the nb)

K = LxN

A = \{L\+SF,N\+SF, K\+SF\}

B=\{L\+EQ,N\+EQ,K\+EQ\}

B = R.\+A

R = B.\+A$^\wedge$-\/1

Verified with specific cases and with dot products with vectors before and after rotation 
\begin{DoxyParams}[1]{Parameters}
 & {\em S\+Fvec} & Input, source frame vector, as defined by L\+AL (L = z\+\_\+hat) in cartesian \\
\hline
 & {\em thetal} & Polar angle in equatorial coordinates of the orbital angular momentum at the reference frequency \\
\hline
 & {\em phil} & Azimuthal angle in equatorial coordinates of the orbital angular momentum at the reference frequency \\
\hline
 & {\em thetas} & Polar angle in equatorial coordinates of the source (not direction of propagation) \\
\hline
 & {\em phis} & Azimuthal angle in equatorial coordinates of the source (not direction of propagation) \\
\hline
 & {\em iota} & Inclination angle between the orbiatl angular momentum and the direction of propagation at the reference frequency \\
\hline
 & {\em phi\+\_\+ref} & Reference frequency for the waveform (defines the L\+AL frame ) ( orbital phase) at the reference frequency \\
\hline
\mbox{\texttt{ out}}  & {\em E\+Qvec} & Out vector in equatorial coordinates in cartesian \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{util_8h_aa82ab145d4f623214c1492589e4327bf}\label{util_8h_aa82ab145d4f623214c1492589e4327bf}} 
\index{util.h@{util.h}!gsl\_maxwell\_boltzmann\_distribution@{gsl\_maxwell\_boltzmann\_distribution}}
\index{gsl\_maxwell\_boltzmann\_distribution@{gsl\_maxwell\_boltzmann\_distribution}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{gsl\_maxwell\_boltzmann\_distribution()}{gsl\_maxwell\_boltzmann\_distribution()}}
{\footnotesize\ttfamily double gsl\+\_\+maxwell\+\_\+boltzmann\+\_\+distribution (\begin{DoxyParamCaption}\item[{double}]{sigma,  }\item[{gsl\+\_\+rng $\ast$}]{r }\end{DoxyParamCaption})}



Calculates a random number from the Maxwell-\/\+Boltzmann distribution using 3 gaussian random numbers. 

Maxwell-\/\+Boltzmann describes a gaussian distributed vector in 3 space, so the magnitude is the R\+MS of the components of that vector

Assumed mean is at 0

Sigma would be equivalent to sqrt(k\+T/m) in the real maxwell boltzmann distribution \mbox{\Hypertarget{util_8h_abd99f3492eda3805283a6a6c1161f61f}\label{util_8h_abd99f3492eda3805283a6a6c1161f61f}} 
\index{util.h@{util.h}!initiate\_LumD\_Z\_interp@{initiate\_LumD\_Z\_interp}}
\index{initiate\_LumD\_Z\_interp@{initiate\_LumD\_Z\_interp}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{initiate\_LumD\_Z\_interp()}{initiate\_LumD\_Z\_interp()}}
{\footnotesize\ttfamily void initiate\+\_\+\+Lum\+D\+\_\+\+Z\+\_\+interp (\begin{DoxyParamCaption}\item[{gsl\+\_\+interp\+\_\+accel $\ast$$\ast$}]{Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr,  }\item[{gsl\+\_\+spline $\ast$$\ast$}]{Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr }\end{DoxyParamCaption})}



Function that uses the G\+SL libraries to interpolate pre-\/calculated Z-\/\+D\+\_\+L data. 

Initiates the requried functions -- G\+SL interpolation requires allocating memory before hand \mbox{\Hypertarget{util_8h_a6a20a9cb79b3c847fc75f3e3eb45f933}\label{util_8h_a6a20a9cb79b3c847fc75f3e3eb45f933}} 
\index{util.h@{util.h}!list\_intersect@{list\_intersect}}
\index{list\_intersect@{list\_intersect}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{list\_intersect()}{list\_intersect()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void list\+\_\+intersect (\begin{DoxyParamCaption}\item[{T $\ast$}]{A,  }\item[{int}]{lenA,  }\item[{T $\ast$}]{B,  }\item[{int}]{lenB,  }\item[{T $\ast$$\ast$}]{C,  }\item[{int $\ast$}]{lenC }\end{DoxyParamCaption})}



Custom list-\/interesction implementation for sorted lists. 

Uses pointers for efficiency -- N\+OT C\+O\+P\+I\+ED -- used std library for that

Takes A and B and puts the intersection in C -- C = A /\textbackslash{} B

Takes the length of C and puts it in lenC

C should have allocated memory for at least as large as the smallest list

W\+I\+LL N\+OT work in-\/place, A, B, and C must be separate \mbox{\Hypertarget{util_8h_a9d0768e0355feef9d4d9681e6eed27b4}\label{util_8h_a9d0768e0355feef9d4d9681e6eed27b4}} 
\index{util.h@{util.h}!list\_intersect\_ptrs@{list\_intersect\_ptrs}}
\index{list\_intersect\_ptrs@{list\_intersect\_ptrs}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{list\_intersect\_ptrs()}{list\_intersect\_ptrs()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void list\+\_\+intersect\+\_\+ptrs (\begin{DoxyParamCaption}\item[{T $\ast$$\ast$}]{A,  }\item[{int}]{lenA,  }\item[{T $\ast$$\ast$}]{B,  }\item[{int}]{lenB,  }\item[{T $\ast$$\ast$}]{C,  }\item[{int $\ast$}]{lenC }\end{DoxyParamCaption})}



Custom list-\/interesction implementation for sorted lists. 

Uses pointers for efficiency -- N\+OT C\+O\+P\+I\+ED -- used std library for that

Takes A and B and puts the intersection in C -- C = A /\textbackslash{} B

Takes the length of C and puts it in lenC

C should have allocated memory for at least as large as the smallest list

W\+I\+LL N\+OT work in-\/place, A, B, and C must be separate \mbox{\Hypertarget{util_8h_a8289e1ab34de59220846f1114dd9f667}\label{util_8h_a8289e1ab34de59220846f1114dd9f667}} 
\index{util.h@{util.h}!normalized\_gsl\_cholesky\_matrix\_invert@{normalized\_gsl\_cholesky\_matrix\_invert}}
\index{normalized\_gsl\_cholesky\_matrix\_invert@{normalized\_gsl\_cholesky\_matrix\_invert}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{normalized\_gsl\_cholesky\_matrix\_invert()}{normalized\_gsl\_cholesky\_matrix\_invert()}}
{\footnotesize\ttfamily int normalized\+\_\+gsl\+\_\+cholesky\+\_\+matrix\+\_\+invert (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{input,  }\item[{double $\ast$$\ast$}]{inverse,  }\item[{int}]{dim }\end{DoxyParamCaption})}



Normalize the Fisher matrix before inversion to try and tame singularity issues\+: 

ar\+Xiv\+:1108.\+1826v2 Equation 60-\/61 \mbox{\Hypertarget{util_8h_a362581f25c83753aefac698e977cb73e}\label{util_8h_a362581f25c83753aefac698e977cb73e}} 
\index{util.h@{util.h}!pow\_int@{pow\_int}}
\index{pow\_int@{pow\_int}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{pow\_int()}{pow\_int()}}
{\footnotesize\ttfamily double pow\+\_\+int (\begin{DoxyParamCaption}\item[{double}]{base,  }\item[{int}]{power }\end{DoxyParamCaption})}



Local power function, specifically for integer powers. 

Much faster than the std version, because this is only for integer powers \mbox{\Hypertarget{util_8h_a9d3b483a858efb84ce776bed255b6dd6}\label{util_8h_a9d3b483a858efb84ce776bed255b6dd6}} 
\index{util.h@{util.h}!printProgress@{printProgress}}
\index{printProgress@{printProgress}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{printProgress()}{printProgress()}}
{\footnotesize\ttfamily void print\+Progress (\begin{DoxyParamCaption}\item[{double}]{percentage }\end{DoxyParamCaption})}



routine to print the progress of a process to the terminal as a progress bar 

Call everytime you want the progress printed \mbox{\Hypertarget{util_8h_aa3b3e1ddc0801e2dcfa09d5683936817}\label{util_8h_aa3b3e1ddc0801e2dcfa09d5683936817}} 
\index{util.h@{util.h}!rm\_fisher\_dim@{rm\_fisher\_dim}}
\index{rm\_fisher\_dim@{rm\_fisher\_dim}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{rm\_fisher\_dim()}{rm\_fisher\_dim()}}
{\footnotesize\ttfamily void rm\+\_\+fisher\+\_\+dim (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{input,  }\item[{int}]{full\+\_\+dim,  }\item[{double $\ast$$\ast$}]{output,  }\item[{int}]{reduced\+\_\+dim,  }\item[{int $\ast$}]{removed\+\_\+dims }\end{DoxyParamCaption})}



Removes a dimension from a matrix (made with fishers in mind, but this is general) 

Note\+: the removed\+\_\+dims list is indexed from 0 \mbox{\Hypertarget{util_8h_ad77170ec9220ef33a32f2540e9184e31}\label{util_8h_ad77170ec9220ef33a32f2540e9184e31}} 
\index{util.h@{util.h}!simpsons\_sum@{simpsons\_sum}}
\index{simpsons\_sum@{simpsons\_sum}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{simpsons\_sum()}{simpsons\_sum()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
T simpsons\+\_\+sum (\begin{DoxyParamCaption}\item[{double}]{delta\+\_\+x,  }\item[{int}]{length,  }\item[{T $\ast$}]{integrand }\end{DoxyParamCaption})}



Simpsons sum rule to approximate discrete integral -\/ Uniform spacing. 

More accurate than the trapezoidal rule, but must be uniform \mbox{\Hypertarget{util_8h_a132fb8304c25ab9a2e18327cfc65b013}\label{util_8h_a132fb8304c25ab9a2e18327cfc65b013}} 
\index{util.h@{util.h}!std\_omega@{std\_omega}}
\index{std\_omega@{std\_omega}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{std\_omega()}{std\_omega()}}
{\footnotesize\ttfamily double std\+\_\+omega (\begin{DoxyParamCaption}\item[{double}]{RA,  }\item[{double}]{std\+\_\+\+RA,  }\item[{double}]{std\+\_\+\+D\+EC,  }\item[{double}]{cov\+\_\+\+R\+A\+\_\+\+D\+EC }\end{DoxyParamCaption})}



map the error on RA and D\+EC to error on solid angle \textbackslash{}\+Omega 

All quantities in rad

From ar\+Xiv\+:0906.\+4269 \mbox{\Hypertarget{util_8h_a969645fb30ec69bccd7848afe7ecef1f}\label{util_8h_a969645fb30ec69bccd7848afe7ecef1f}} 
\index{util.h@{util.h}!terr\_pol\_iota\_from\_equat\_sph@{terr\_pol\_iota\_from\_equat\_sph}}
\index{terr\_pol\_iota\_from\_equat\_sph@{terr\_pol\_iota\_from\_equat\_sph}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{terr\_pol\_iota\_from\_equat\_sph()}{terr\_pol\_iota\_from\_equat\_sph()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void terr\+\_\+pol\+\_\+iota\+\_\+from\+\_\+equat\+\_\+sph (\begin{DoxyParamCaption}\item[{T}]{RA,  }\item[{T}]{D\+EC,  }\item[{T}]{thetaj,  }\item[{T}]{phij,  }\item[{T $\ast$}]{pol,  }\item[{T $\ast$}]{iota }\end{DoxyParamCaption})}



Routine to transform from the equatorial coordinate system spherical polar description of the total angular momentum to the detector specific polarization angle and inclination angle (of the total angular momentum) 

For the terrestrial network, this calculates the polarization angle for a detector at the center of Earth in equatorial coordinates, which is the polarization angle used in the detector\+\_\+response\+\_\+equatorial functions

Polarization angle is defined as\+:

tan \textbackslash{}psi = ( J.\+z -\/ (J.\+N)(z.\+N) ) / (N.(Jxz))

Where z is the axis of rotation of earth (equatorial z), and N is the line of sight to the source (direction of propagation is -\/N)

The inclination angle is between the direction of propagation and the total angular momentum 
\begin{DoxyParams}{Parameters}
{\em RA} & Right ascension in rad \\
\hline
{\em D\+EC} & Declination in rad \\
\hline
{\em thetaj} & spherical polar angle of the total angular momentum in equatorial coordinates \\
\hline
{\em phij} & spherical azimuthal angle of the total angular momentum in equatorial coordinates \\
\hline
{\em pol} & polarization defined by tan \textbackslash{}psi = ( J.\+z -\/ (J.\+N)(z.\+N) ) / (N.(Jxz)) \\
\hline
{\em iota} & Inclination angle of the T\+O\+T\+AL angular momentum and the direction of propagation -\/N \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{util_8h_a817fd4d7413b4a2bfe05bfbc454766b2}\label{util_8h_a817fd4d7413b4a2bfe05bfbc454766b2}} 
\index{util.h@{util.h}!transform\_cart\_sph@{transform\_cart\_sph}}
\index{transform\_cart\_sph@{transform\_cart\_sph}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{transform\_cart\_sph()}{transform\_cart\_sph()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void transform\+\_\+cart\+\_\+sph (\begin{DoxyParamCaption}\item[{T $\ast$}]{cartvec,  }\item[{T $\ast$}]{sphvec }\end{DoxyParamCaption})}



utility to transform a vector from cartesian to spherical (radian) 

order\+:

cart\+: x, y, z

spherical\+: r, polar, azimuthal

Tested in all octants \mbox{\Hypertarget{util_8h_a168fd7e5d1d20a344c7bc5e6ced76763}\label{util_8h_a168fd7e5d1d20a344c7bc5e6ced76763}} 
\index{util.h@{util.h}!transform\_parameters@{transform\_parameters}}
\index{transform\_parameters@{transform\_parameters}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{transform\_parameters()}{transform\_parameters()}}
{\footnotesize\ttfamily template$<$class T , class U $>$ \\
void transform\+\_\+parameters (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classgen__params__base}{gen\+\_\+params\+\_\+base}}$<$ T $>$ $\ast$}]{param\+\_\+in,  }\item[{\mbox{\hyperlink{classgen__params__base}{gen\+\_\+params\+\_\+base}}$<$ U $>$ $\ast$}]{param\+\_\+out }\end{DoxyParamCaption})}



Simple utility to copy the members of param\+\_\+in to param\+\_\+out, for whatever types those are. 

This is sometimes required to jump from double params to adouble params

Memory M\+U\+ST be allocated for betappe and bppe (if present), and this needs to be deallocated \mbox{\Hypertarget{util_8h_a3c767ffbc1073a544ae1630ffdea917e}\label{util_8h_a3c767ffbc1073a544ae1630ffdea917e}} 
\index{util.h@{util.h}!transform\_sph\_cart@{transform\_sph\_cart}}
\index{transform\_sph\_cart@{transform\_sph\_cart}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{transform\_sph\_cart()}{transform\_sph\_cart()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void transform\+\_\+sph\+\_\+cart (\begin{DoxyParamCaption}\item[{T $\ast$}]{sphvec,  }\item[{T $\ast$}]{cartvec }\end{DoxyParamCaption})}



utility to transform a vector from spherical (radian) to cartesian 

Range\+: \textbackslash{}theta \textbackslash{}el \mbox{[}0,\textbackslash{}pi\mbox{]}

\textbackslash{}phi \textbackslash{}el \mbox{[}0,2 \textbackslash{}pi\mbox{]}

order\+:

cart\+: x, y, z

spherical\+: r, polar, azimuthal

Tested in all octants \mbox{\Hypertarget{util_8h_ab7d3ff0c020ec0ffbe56f4271f425d68}\label{util_8h_ab7d3ff0c020ec0ffbe56f4271f425d68}} 
\index{util.h@{util.h}!trapezoidal\_sum@{trapezoidal\_sum}}
\index{trapezoidal\_sum@{trapezoidal\_sum}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{trapezoidal\_sum()}{trapezoidal\_sum()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
T trapezoidal\+\_\+sum (\begin{DoxyParamCaption}\item[{double $\ast$}]{delta\+\_\+x,  }\item[{int}]{length,  }\item[{T $\ast$}]{integrand }\end{DoxyParamCaption})}



Trapezoidal sum rule to approximate discrete integral -\/ Non-\/\+Uniform spacing. 

This version is slower than the uniform version, but will handle non-\/uniform spacing \mbox{\Hypertarget{util_8h_a185f5ce6420f94f03d77915d94b06f4f}\label{util_8h_a185f5ce6420f94f03d77915d94b06f4f}} 
\index{util.h@{util.h}!trapezoidal\_sum\_uniform@{trapezoidal\_sum\_uniform}}
\index{trapezoidal\_sum\_uniform@{trapezoidal\_sum\_uniform}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{trapezoidal\_sum\_uniform()}{trapezoidal\_sum\_uniform()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
T trapezoidal\+\_\+sum\+\_\+uniform (\begin{DoxyParamCaption}\item[{double}]{delta\+\_\+x,  }\item[{int}]{length,  }\item[{T $\ast$}]{integrand }\end{DoxyParamCaption})}



Trapezoidal sum rule to approximate discrete integral -\/ Uniform spacing. 

This version is faster than the general version, as it has half the function calls

Something may be wrong with this function -\/ had an overall offset for real data that was fixed by using the simpsons rule -\/ not sure if this was because of a boost in accuracy or because something is off with the trapezoidal sum \mbox{\Hypertarget{util_8h_adcfd6e3f070e3c9bdae4a7cd03570f67}\label{util_8h_adcfd6e3f070e3c9bdae4a7cd03570f67}} 
\index{util.h@{util.h}!tukey\_window@{tukey\_window}}
\index{tukey\_window@{tukey\_window}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{tukey\_window()}{tukey\_window()}}
{\footnotesize\ttfamily void tukey\+\_\+window (\begin{DoxyParamCaption}\item[{double $\ast$}]{window,  }\item[{int}]{length,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



Tukey window function for F\+F\+Ts. 

As defined by \href{https://en.wikipedia.org/wiki/Window_function}{\texttt{ https\+://en.\+wikipedia.\+org/wiki/\+Window\+\_\+function}} \mbox{\Hypertarget{util_8h_a036fae37c6732da48e01ccc1331542d4}\label{util_8h_a036fae37c6732da48e01ccc1331542d4}} 
\index{util.h@{util.h}!unwrap\_array@{unwrap\_array}}
\index{unwrap\_array@{unwrap\_array}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{unwrap\_array()}{unwrap\_array()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void unwrap\+\_\+array (\begin{DoxyParamCaption}\item[{T $\ast$}]{in,  }\item[{T $\ast$}]{out,  }\item[{int}]{len }\end{DoxyParamCaption})}



Unwrap angles from arctan. 

Stolen from stack exchange.. \href{https://stackoverflow.com/questions/15634400/continous-angles-in-c-eq-unwrap-function-in-matlab}{\texttt{ https\+://stackoverflow.\+com/questions/15634400/continous-\/angles-\/in-\/c-\/eq-\/unwrap-\/function-\/in-\/matlab}}

Modified \mbox{\Hypertarget{util_8h_af9aa77c0f12435f4c7e9f13dba8ca1f8}\label{util_8h_af9aa77c0f12435f4c7e9f13dba8ca1f8}} 
\index{util.h@{util.h}!XLALSpinWeightedSphericalHarmonic@{XLALSpinWeightedSphericalHarmonic}}
\index{XLALSpinWeightedSphericalHarmonic@{XLALSpinWeightedSphericalHarmonic}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{XLALSpinWeightedSphericalHarmonic()}{XLALSpinWeightedSphericalHarmonic()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
std\+::complex$<$T$>$ X\+L\+A\+L\+Spin\+Weighted\+Spherical\+Harmonic (\begin{DoxyParamCaption}\item[{T}]{theta,  }\item[{T}]{phi,  }\item[{int}]{s,  }\item[{int}]{l,  }\item[{int}]{m }\end{DoxyParamCaption})}

Shamelessly stolen from L\+A\+Lsuite 
\begin{DoxyParams}{Parameters}
{\em theta} & polar angle (rad) \\
\hline
{\em phi} & azimuthal angle (rad) \\
\hline
{\em s} & spin weight \\
\hline
{\em l} & mode number l \\
\hline
{\em m} & mode number m \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{util_8h_a415ef00e103efe73c8eabc235b202b12}\label{util_8h_a415ef00e103efe73c8eabc235b202b12}} 
\index{util.h@{util.h}!Z\_from\_DL@{Z\_from\_DL}}
\index{Z\_from\_DL@{Z\_from\_DL}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{Z\_from\_DL()}{Z\_from\_DL()}}
{\footnotesize\ttfamily double Z\+\_\+from\+\_\+\+DL (\begin{DoxyParamCaption}\item[{double}]{DL,  }\item[{std\+::string}]{cosmology }\end{DoxyParamCaption})}



Calculates the redshift given the luminosity distance. 

Based on Astropy.\+cosmology calculations -- see python script in the ./data folder of the project -- numerically calculated given astropy.\+cosmology\textquotesingle{}s definitions (\href{http://docs.astropy.org/en/stable/cosmology/}{\texttt{ http\+://docs.\+astropy.\+org/en/stable/cosmology/}}) and used scipy.\+optimize to fit to a power series, stepping in half powers of DL. These coefficients are then output to a header file (D\+\_\+\+Z\+\_\+config.\+h) which are used here to calculate redshift. Custom cosmologies etc can easily be acheived by editing the python script D\+\_\+\+Z\+\_\+config.\+py, the c++ functions do not need modification. They use whatever data is available in the header file.

5 cosmological models are available (this argument must be spelled exactly, although case insensitive)\+:

P\+L\+A\+N\+C\+K15, P\+L\+A\+N\+C\+K13, W\+M\+A\+P9, W\+M\+A\+P7, W\+M\+A\+P5 \mbox{\Hypertarget{util_8h_aec48ba6d02ebe433a684e09884e6a31b}\label{util_8h_aec48ba6d02ebe433a684e09884e6a31b}} 
\index{util.h@{util.h}!Z\_from\_DL\_interp@{Z\_from\_DL\_interp}}
\index{Z\_from\_DL\_interp@{Z\_from\_DL\_interp}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{Z\_from\_DL\_interp()}{Z\_from\_DL\_interp()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily adouble Z\+\_\+from\+\_\+\+D\+L\+\_\+interp (\begin{DoxyParamCaption}\item[{adouble}]{DL,  }\item[{gsl\+\_\+interp\+\_\+accel $\ast$}]{Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr,  }\item[{gsl\+\_\+spline $\ast$}]{Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr }\end{DoxyParamCaption})}

Function that returns Z from a given luminosity Distance -- only Planck15

adouble version for A\+D\+O\+L-\/C calculations \mbox{\Hypertarget{util_8h_a8d080a588955cc9cb0a4efc831187936}\label{util_8h_a8d080a588955cc9cb0a4efc831187936}} 
\index{util.h@{util.h}!Z\_from\_DL\_interp@{Z\_from\_DL\_interp}}
\index{Z\_from\_DL\_interp@{Z\_from\_DL\_interp}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{Z\_from\_DL\_interp()}{Z\_from\_DL\_interp()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily double Z\+\_\+from\+\_\+\+D\+L\+\_\+interp (\begin{DoxyParamCaption}\item[{double}]{DL,  }\item[{gsl\+\_\+interp\+\_\+accel $\ast$}]{Z\+\_\+\+D\+L\+\_\+accel\+\_\+ptr,  }\item[{gsl\+\_\+spline $\ast$}]{Z\+\_\+\+D\+L\+\_\+spline\+\_\+ptr }\end{DoxyParamCaption})}

Function that returns Z from a given luminosity Distance -- only Planck15 

\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{util_8h_abcfdf85edc41c59ae55c3c45dc9c506a}\label{util_8h_abcfdf85edc41c59ae55c3c45dc9c506a}} 
\index{util.h@{util.h}!AU\_SEC@{AU\_SEC}}
\index{AU\_SEC@{AU\_SEC}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{AU\_SEC}{AU\_SEC}}
{\footnotesize\ttfamily const double A\+U\+\_\+\+S\+EC = 499.\+005}

1AU in seconds \mbox{\Hypertarget{util_8h_a19ace59856e55cca68458867a62d0bc4}\label{util_8h_a19ace59856e55cca68458867a62d0bc4}} 
\index{util.h@{util.h}!AXIAL\_TILT@{AXIAL\_TILT}}
\index{AXIAL\_TILT@{AXIAL\_TILT}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{AXIAL\_TILT}{AXIAL\_TILT}}
{\footnotesize\ttfamily const double A\+X\+I\+A\+L\+\_\+\+T\+I\+LT =0.\+409092627749}

Earth\textquotesingle{}s Axial tilt in radian \mbox{\Hypertarget{util_8h_a8fc6defe4e499b1b9b9c275689e44352}\label{util_8h_a8fc6defe4e499b1b9b9c275689e44352}} 
\index{util.h@{util.h}!c@{c}}
\index{c@{c}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{c}{c}}
{\footnotesize\ttfamily const double c = 299792458.}

Speed of light m/s \mbox{\Hypertarget{util_8h_ab97e4616d23ed4c2961295010c1afc3c}\label{util_8h_ab97e4616d23ed4c2961295010c1afc3c}} 
\index{util.h@{util.h}!G@{G}}
\index{G@{G}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{G}{G}}
{\footnotesize\ttfamily const double G =6.\+674e-\/11$\ast$(1.\+98855e30)}

Gravitational constant in m$\ast$$\ast$3/(s$\ast$$\ast$2 Sol\+Mass) \mbox{\Hypertarget{util_8h_ae35ccfea47f0da0a31cf1d13c80f3c58}\label{util_8h_ae35ccfea47f0da0a31cf1d13c80f3c58}} 
\index{util.h@{util.h}!gamma\_E@{gamma\_E}}
\index{gamma\_E@{gamma\_E}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{gamma\_E}{gamma\_E}}
{\footnotesize\ttfamily const double gamma\+\_\+E = 0.\+5772156649015328606065120900824024310421}

Euler number \mbox{\Hypertarget{util_8h_a47be806b6c8a58bd030f167ca91ed201}\label{util_8h_a47be806b6c8a58bd030f167ca91ed201}} 
\index{util.h@{util.h}!MPC\_SEC@{MPC\_SEC}}
\index{MPC\_SEC@{MPC\_SEC}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{MPC\_SEC}{MPC\_SEC}}
{\footnotesize\ttfamily const double M\+P\+C\+\_\+\+S\+EC = 3.\+085677581491367278913937957796471611e22/\mbox{\hyperlink{util_8h_a8fc6defe4e499b1b9b9c275689e44352}{c}}}

consts.\+kpc.\+to(\textquotesingle{}m\textquotesingle{})$\ast$1000/c Mpc in sec \mbox{\Hypertarget{util_8h_a498f9210d23417e309c01ad5cb9a635b}\label{util_8h_a498f9210d23417e309c01ad5cb9a635b}} 
\index{util.h@{util.h}!MSOL\_SEC@{MSOL\_SEC}}
\index{MSOL\_SEC@{MSOL\_SEC}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{MSOL\_SEC}{MSOL\_SEC}}
{\footnotesize\ttfamily const double M\+S\+O\+L\+\_\+\+S\+EC =4.\+925491025543575903411922162094833998e-\/6}

G/c$\ast$$\ast$3 seconds per solar mass \mbox{\Hypertarget{util_8h_aeef10f63f0d33b2b400ac1948439ccfc}\label{util_8h_aeef10f63f0d33b2b400ac1948439ccfc}} 
\index{util.h@{util.h}!ROOT\_THREE@{ROOT\_THREE}}
\index{ROOT\_THREE@{ROOT\_THREE}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{ROOT\_THREE}{ROOT\_THREE}}
{\footnotesize\ttfamily const double R\+O\+O\+T\+\_\+\+T\+H\+R\+EE = std\+::sqrt(3.)}

Sqrt(3) comes up often, precompute it \mbox{\Hypertarget{util_8h_ad996f6cd74a1b9c9c1c63c59db32e190}\label{util_8h_ad996f6cd74a1b9c9c1c63c59db32e190}} 
\index{util.h@{util.h}!T\_day@{T\_day}}
\index{T\_day@{T\_day}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{T\_day}{T\_day}}
{\footnotesize\ttfamily const double T\+\_\+day = 24$\ast$3600.}

1 day in seconds \mbox{\Hypertarget{util_8h_a65f61647bc34ceeb4dc626f8f0625ec5}\label{util_8h_a65f61647bc34ceeb4dc626f8f0625ec5}} 
\index{util.h@{util.h}!T\_year@{T\_year}}
\index{T\_year@{T\_year}!util.h@{util.h}}
\doxysubsubsection{\texorpdfstring{T\_year}{T\_year}}
{\footnotesize\ttfamily const double T\+\_\+year = 31557600.}

1 year in seconds 