<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GW Analysis Tools: src/mcmc_sampler_internals.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GW Analysis Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mcmc_sampler_internals.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mcmc__sampler__internals_8h_source.html">mcmc_sampler_internals.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="autocorrelation_8h_source.html">autocorrelation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_randist.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
<code>#include &lt;eigen3/Eigen/Eigen&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;fftw3.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mcmc_sampler_internals.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="mcmc__sampler__internals_8cpp__incl.png" border="0" usemap="#src_2mcmc__sampler__internals_8cpp" alt=""/></div>
<map name="src_2mcmc__sampler__internals_8cpp" id="src_2mcmc__sampler__internals_8cpp">
<area shape="rect" id="node2" href="mcmc__sampler__internals_8h.html" title="mcmc_sampler_internals.h" alt="" coords="224,80,402,107"/>
<area shape="rect" id="node9" href="autocorrelation_8h.html" title="autocorrelation.h" alt="" coords="579,80,698,107"/>
<area shape="rect" id="node10" href="util_8h.html" title="util.h" alt="" coords="642,155,693,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a980887f02fa645f29724117539565a91"><td class="memItemLeft" align="right" valign="top"><a id="a980887f02fa645f29724117539565a91"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a980887f02fa645f29724117539565a91">mcmc_step</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, double *next_param, int *current_status, int *next_status, int chain_number)</td></tr>
<tr class="memdesc:a980887f02fa645f29724117539565a91"><td class="mdescLeft">&#160;</td><td class="mdescRight">interface function between the sampler and the internal step functions <br /></td></tr>
<tr class="separator:a980887f02fa645f29724117539565a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea58d270c94a74ca9c716fae47cbd24d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#aea58d270c94a74ca9c716fae47cbd24d">gaussian_step</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, double *proposed_param, int *current_status, int *proposed_status, int chain_id)</td></tr>
<tr class="memdesc:aea58d270c94a74ca9c716fae47cbd24d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Straight gaussian step.  <a href="#aea58d270c94a74ca9c716fae47cbd24d">More...</a><br /></td></tr>
<tr class="separator:aea58d270c94a74ca9c716fae47cbd24d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2eee3801304ac71a4f4dc03a7783a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a4f2eee3801304ac71a4f4dc03a7783a4">fisher_step</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, double *proposed_param, int *current_status, int *proposed_status, int chain_index)</td></tr>
<tr class="memdesc:a4f2eee3801304ac71a4f4dc03a7783a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fisher informed gaussian step.  <a href="#a4f2eee3801304ac71a4f4dc03a7783a4">More...</a><br /></td></tr>
<tr class="separator:a4f2eee3801304ac71a4f4dc03a7783a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab09bae393b353856815acf208ad3cb04"><td class="memItemLeft" align="right" valign="top"><a id="ab09bae393b353856815acf208ad3cb04"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>update_fisher</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, int *param_status, int chain_index)</td></tr>
<tr class="separator:ab09bae393b353856815acf208ad3cb04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a251e0a0b4059499d25f6d3c9957ceb1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a251e0a0b4059499d25f6d3c9957ceb1d">mmala_step</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, double *proposed_param, int *current_status, int *proposed_status)</td></tr>
<tr class="memdesc:a251e0a0b4059499d25f6d3c9957ceb1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">MMALA informed step &ndash; Currently not supported.  <a href="#a251e0a0b4059499d25f6d3c9957ceb1d">More...</a><br /></td></tr>
<tr class="separator:a251e0a0b4059499d25f6d3c9957ceb1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2a990fd673ce479819a75cf5617c6b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#ab2a990fd673ce479819a75cf5617c6b3">diff_ev_step</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, double *proposed_param, int *current_status, int *proposed_status, int chain_id)</td></tr>
<tr class="memdesc:ab2a990fd673ce479819a75cf5617c6b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">differential evolution informed step  <a href="#ab2a990fd673ce479819a75cf5617c6b3">More...</a><br /></td></tr>
<tr class="separator:ab2a990fd673ce479819a75cf5617c6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5c301686c971e3f9359cdd661529b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a1b5c301686c971e3f9359cdd661529b3">RJ_smooth_history</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, int *current_param_status, int base_history_id, double *eff_history_coord, int *eff_history_status, int chain_id)</td></tr>
<tr class="separator:a1b5c301686c971e3f9359cdd661529b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a048b4bd95b3bac1d355d5c5897c29ece"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a048b4bd95b3bac1d355d5c5897c29ece">RJ_step</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *current_param, double *proposed_param, int *current_status, int *proposed_status, int chain_number)</td></tr>
<tr class="memdesc:a048b4bd95b3bac1d355d5c5897c29ece"><td class="mdescLeft">&#160;</td><td class="mdescRight">RJ-proposal step for trans-dimensional MCMCs.  <a href="#a048b4bd95b3bac1d355d5c5897c29ece">More...</a><br /></td></tr>
<tr class="separator:a048b4bd95b3bac1d355d5c5897c29ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae328d199338081b9affb09d1f8e71351"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#ae328d199338081b9affb09d1f8e71351">chain_swap</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double ***output, int ***param_status, int step_num, int *swp_accepted, int *swp_rejected)</td></tr>
<tr class="memdesc:ae328d199338081b9affb09d1f8e71351"><td class="mdescLeft">&#160;</td><td class="mdescRight">subroutine to perform chain comparison for parallel tempering  <a href="#ae328d199338081b9affb09d1f8e71351">More...</a><br /></td></tr>
<tr class="separator:ae328d199338081b9affb09d1f8e71351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d8297d53aac4b86b446a6bdb3894d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a21d8297d53aac4b86b446a6bdb3894d9">single_chain_swap</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *chain1, double *chain2, int *chain1_status, int *chain2_status, int T1_index, int T2_index)</td></tr>
<tr class="memdesc:a21d8297d53aac4b86b446a6bdb3894d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">subroutine to actually swap two chains  <a href="#a21d8297d53aac4b86b446a6bdb3894d9">More...</a><br /></td></tr>
<tr class="separator:a21d8297d53aac4b86b446a6bdb3894d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01af82303a695ddfd66c3d493b8da408"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a01af82303a695ddfd66c3d493b8da408">assign_probabilities</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, int chain_index)</td></tr>
<tr class="memdesc:a01af82303a695ddfd66c3d493b8da408"><td class="mdescLeft">&#160;</td><td class="mdescRight">update and initiate probabilities for each variety of step  <a href="#a01af82303a695ddfd66c3d493b8da408">More...</a><br /></td></tr>
<tr class="separator:a01af82303a695ddfd66c3d493b8da408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae363e3b27d7254afd01c6285a63af4bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#ae363e3b27d7254afd01c6285a63af4bd">transfer_chain</a> (<a class="el" href="classsampler.html">sampler</a> *samplerptr_dest, <a class="el" href="classsampler.html">sampler</a> *samplerptr_source, int id_dest, int id_source, bool transfer_output)</td></tr>
<tr class="memdesc:ae363e3b27d7254afd01c6285a63af4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies contents of one chain to another.  <a href="#ae363e3b27d7254afd01c6285a63af4bd">More...</a><br /></td></tr>
<tr class="separator:ae363e3b27d7254afd01c6285a63af4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a4c2a3dcd245bd563ec73963553421"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a00a4c2a3dcd245bd563ec73963553421">check_sampler_status</a> (<a class="el" href="classsampler.html">sampler</a> *samplerptr)</td></tr>
<tr class="memdesc:a00a4c2a3dcd245bd563ec73963553421"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the status of a sampler for the stochastic sampling.  <a href="#a00a4c2a3dcd245bd563ec73963553421">More...</a><br /></td></tr>
<tr class="separator:a00a4c2a3dcd245bd563ec73963553421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d87fd050fbed74c4b5deabbc806f9ed"><td class="memItemLeft" align="right" valign="top"><a id="a9d87fd050fbed74c4b5deabbc806f9ed"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a9d87fd050fbed74c4b5deabbc806f9ed">update_step_widths</a> (<a class="el" href="classsampler.html">sampler</a> *samplerptr, int chain_id)</td></tr>
<tr class="memdesc:a9d87fd050fbed74c4b5deabbc806f9ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the step widths, shooting for 20% acceptance ratios for each type of step. <br /></td></tr>
<tr class="separator:a9d87fd050fbed74c4b5deabbc806f9ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac525f259fecd81816775f4c84324d17f"><td class="memItemLeft" align="right" valign="top"><a id="ac525f259fecd81816775f4c84324d17f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>allocate_sampler_mem</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>)</td></tr>
<tr class="separator:ac525f259fecd81816775f4c84324d17f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a0ed700073b1c7b0011627dddbd9d57"><td class="memItemLeft" align="right" valign="top"><a id="a1a0ed700073b1c7b0011627dddbd9d57"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>deallocate_sampler_mem</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>)</td></tr>
<tr class="separator:a1a0ed700073b1c7b0011627dddbd9d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97ce7a1836e918fc9fefcb99b4fba2f8"><td class="memItemLeft" align="right" valign="top"><a id="a97ce7a1836e918fc9fefcb99b4fba2f8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>update_history</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, double *new_params, int *new_param_status, int chain_index)</td></tr>
<tr class="separator:a97ce7a1836e918fc9fefcb99b4fba2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a510b0594a7fe5a05eed0df6100ffd62b"><td class="memItemLeft" align="right" valign="top"><a id="a510b0594a7fe5a05eed0df6100ffd62b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>write_stat_file</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, std::string filename)</td></tr>
<tr class="separator:a510b0594a7fe5a05eed0df6100ffd62b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2207c4aeab89b5b985ac2fb297426ba5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a2207c4aeab89b5b985ac2fb297426ba5">write_checkpoint_file</a> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, std::string filename)</td></tr>
<tr class="memdesc:a2207c4aeab89b5b985ac2fb297426ba5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine that writes metadata and final positions of a sampler to a checkpoint file.  <a href="#a2207c4aeab89b5b985ac2fb297426ba5">More...</a><br /></td></tr>
<tr class="separator:a2207c4aeab89b5b985ac2fb297426ba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df174eb68b851e0ccd3b966e65f3a77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a6df174eb68b851e0ccd3b966e65f3a77">load_temps_checkpoint_file</a> (std::string check_file, double *temps, int chain_N)</td></tr>
<tr class="memdesc:a6df174eb68b851e0ccd3b966e65f3a77"><td class="mdescLeft">&#160;</td><td class="mdescRight">load temperatures from checkpoint file  <a href="#a6df174eb68b851e0ccd3b966e65f3a77">More...</a><br /></td></tr>
<tr class="separator:a6df174eb68b851e0ccd3b966e65f3a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c3718752690cce3b37f41da7b2b938"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#ae9c3718752690cce3b37f41da7b2b938">load_checkpoint_file</a> (std::string check_file, <a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>)</td></tr>
<tr class="memdesc:ae9c3718752690cce3b37f41da7b2b938"><td class="mdescLeft">&#160;</td><td class="mdescRight">load checkpoint file into sampler struct  <a href="#ae9c3718752690cce3b37f41da7b2b938">More...</a><br /></td></tr>
<tr class="separator:ae9c3718752690cce3b37f41da7b2b938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b54bc1d977c55f0c9702246ad8a4092"><td class="memItemLeft" align="right" valign="top"><a id="a0b54bc1d977c55f0c9702246ad8a4092"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>assign_ct_p</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, int step, int chain_index)</td></tr>
<tr class="separator:a0b54bc1d977c55f0c9702246ad8a4092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5da7a24bdc8e600616c2ea21dc44cae"><td class="memItemLeft" align="right" valign="top"><a id="aa5da7a24bdc8e600616c2ea21dc44cae"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>assign_ct_m</b> (<a class="el" href="classsampler.html">sampler</a> *<a class="el" href="classsampler.html">sampler</a>, int step, int chain_index)</td></tr>
<tr class="separator:aa5da7a24bdc8e600616c2ea21dc44cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7425d70b7a09bfaf24371292791115c0"><td class="memItemLeft" align="right" valign="top"><a id="a7425d70b7a09bfaf24371292791115c0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>assign_initial_pos</b> (<a class="el" href="classsampler.html">sampler</a> *samplerptr, double *initial_pos, int *initial_status, double *seeding_var)</td></tr>
<tr class="separator:a7425d70b7a09bfaf24371292791115c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f07e7540a20f438aad42f569c2e22d2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a1f07e7540a20f438aad42f569c2e22d2">PT_dynamical_timescale</a> (int t0, int nu, int t)</td></tr>
<tr class="memdesc:a1f07e7540a20f438aad42f569c2e22d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timescale of the PT dynamics.  <a href="#a1f07e7540a20f438aad42f569c2e22d2">More...</a><br /></td></tr>
<tr class="separator:a1f07e7540a20f438aad42f569c2e22d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ec0745c85caad31c473a608aef5782"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#ae0ec0745c85caad31c473a608aef5782">update_temperatures</a> (<a class="el" href="classsampler.html">sampler</a> *samplerptr, int t0, int nu, int t)</td></tr>
<tr class="memdesc:ae0ec0745c85caad31c473a608aef5782"><td class="mdescLeft">&#160;</td><td class="mdescRight">updates the temperatures for a sampler such that all acceptance rates are equal  <a href="#ae0ec0745c85caad31c473a608aef5782">More...</a><br /></td></tr>
<tr class="separator:ae0ec0745c85caad31c473a608aef5782"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d0fba3cec02c00fb85b04d5e987f01b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a9d0fba3cec02c00fb85b04d5e987f01b">initiate_full_sampler</a> (<a class="el" href="classsampler.html">sampler</a> *sampler_new, <a class="el" href="classsampler.html">sampler</a> *sampler_old, int chain_N_thermo_ensemble, int chain_N, std::string chain_allocation_scheme)</td></tr>
<tr class="memdesc:a9d0fba3cec02c00fb85b04d5e987f01b"><td class="mdescLeft">&#160;</td><td class="mdescRight">For the dynamic PT sampler, this is the function that starts the full sampler with the max number of chains.  <a href="#a9d0fba3cec02c00fb85b04d5e987f01b">More...</a><br /></td></tr>
<tr class="separator:a9d0fba3cec02c00fb85b04d5e987f01b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dbf96828add5b7383e340160a5d006a"><td class="memItemLeft" align="right" valign="top"><a id="a7dbf96828add5b7383e340160a5d006a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a7dbf96828add5b7383e340160a5d006a">write_output_file</a> (std::string file, int step_num, int max_dimension, double ***output, int ***status, int chain_N, double *temps, bool RJ)</td></tr>
<tr class="memdesc:a7dbf96828add5b7383e340160a5d006a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to write out the parameters and status of a sampler to a file. <br /></td></tr>
<tr class="separator:a7dbf96828add5b7383e340160a5d006a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38318ba0da66b6bb3e316b3e541a86aa"><td class="memItemLeft" align="right" valign="top"><a id="a38318ba0da66b6bb3e316b3e541a86aa"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>count_cold_chains</b> (double *temps, int chain_N)</td></tr>
<tr class="separator:a38318ba0da66b6bb3e316b3e541a86aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7915ea20bbd2c5a82548a6bbf490783f"><td class="memItemLeft" align="right" valign="top"><a id="a7915ea20bbd2c5a82548a6bbf490783f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mcmc__sampler__internals_8cpp.html#a7915ea20bbd2c5a82548a6bbf490783f">reduce_output</a> (int step_num, int max_dimension, double ***output_old, int ***status_old, double **output_new, int **status_new, int chain_N, double *temps, bool RJ)</td></tr>
<tr class="memdesc:a7915ea20bbd2c5a82548a6bbf490783f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to write out the parameters and status of a sampler to a file. <br /></td></tr>
<tr class="separator:a7915ea20bbd2c5a82548a6bbf490783f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>File containing definitions for all the internal, generic mcmc subroutines </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a01af82303a695ddfd66c3d493b8da408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01af82303a695ddfd66c3d493b8da408">&#9670;&nbsp;</a></span>assign_probabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void assign_probabilities </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update and initiate probabilities for each variety of step </p>
<p>Type 0: Gaussian step</p>
<p>Type 1: Differential Evolution step</p>
<p>Type 2: MMALA step (currently not supported)</p>
<p>Type 3: Fisher step </p>

</div>
</div>
<a id="ae328d199338081b9affb09d1f8e71351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae328d199338081b9affb09d1f8e71351">&#9670;&nbsp;</a></span>chain_swap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chain_swap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int ***&#160;</td>
          <td class="paramname"><em>param_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>step_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>swp_accepted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>swp_rejected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>subroutine to perform chain comparison for parallel tempering </p>
<p>The total output file is passed, and the chains are swapped sequentially</p>
<p>This is the routine for ``Deterministic'' sampling (parallel or sequential, but not pooled) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sampler</td><td>sampler struct </td></tr>
    <tr><td class="paramname">output</td><td>output vector containing chains </td></tr>
    <tr><td class="paramname">param_status</td><td>Parameter status </td></tr>
    <tr><td class="paramname">step_num</td><td>current step number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a00a4c2a3dcd245bd563ec73963553421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a4c2a3dcd245bd563ec73963553421">&#9670;&nbsp;</a></span>check_sampler_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_sampler_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>samplerptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the status of a sampler for the stochastic sampling. </p>
<p>Just loops through the ref_chain_status variables </p>

</div>
</div>
<a id="ab2a990fd673ce479819a75cf5617c6b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2a990fd673ce479819a75cf5617c6b3">&#9670;&nbsp;</a></span>diff_ev_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diff_ev_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>current_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>proposed_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>current_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>proposed_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>differential evolution informed step </p>
<p>Differential evolution uses the past history of the chain to inform the proposed step:</p>
<p>Take the difference of two random, accepted previous steps and step along that with some step size, determined by a gaussian </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sampler</td><td>Sampler struct </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param</td><td>current position in parameter space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proposed_param</td><td>Proposed position in parameter space </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4f2eee3801304ac71a4f4dc03a7783a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2eee3801304ac71a4f4dc03a7783a4">&#9670;&nbsp;</a></span>fisher_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fisher_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>current_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>proposed_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>current_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>proposed_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fisher informed gaussian step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sampler</td><td>Sampler struct </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param</td><td>current position in parameter space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proposed_param</td><td>Proposed position in parameter space </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aea58d270c94a74ca9c716fae47cbd24d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea58d270c94a74ca9c716fae47cbd24d">&#9670;&nbsp;</a></span>gaussian_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gaussian_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>current_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>proposed_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>current_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>proposed_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Straight gaussian step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sampler</td><td>Sampler struct </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param</td><td>current position in parameter space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proposed_param</td><td>Proposed position in parameter space </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9d0fba3cec02c00fb85b04d5e987f01b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d0fba3cec02c00fb85b04d5e987f01b">&#9670;&nbsp;</a></span>initiate_full_sampler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initiate_full_sampler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_N_thermo_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>chain_allocation_scheme</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For the dynamic PT sampler, this is the function that starts the full sampler with the max number of chains. </p>
<p>The output file will be reused, but the positions are set back to zero (copying the current position to position zero)</p>
<p>Assumes the output, chain_temps have been allocated in memory for the final number of chains chain_N and steps N_steps</p>
<p>Allocates memory for the new sampler sampler_new -&gt; it's the user's responsibility to deallocate with deallocate_sampler_mem </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sampler_old</td><td>Dynamic sampler </td></tr>
    <tr><td class="paramname">chain_N_thermo_ensemble</td><td>Number of chains used in the thermodynamic ensemble </td></tr>
    <tr><td class="paramname">chain_N</td><td>Number of chains to use in the static sampler </td></tr>
    <tr><td class="paramname">chain_allocation_scheme</td><td>Scheme to use to allocate any remaining chains </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae9c3718752690cce3b37f41da7b2b938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9c3718752690cce3b37f41da7b2b938">&#9670;&nbsp;</a></span>load_checkpoint_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_checkpoint_file </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>check_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>load checkpoint file into sampler struct </p>
<p><em>NOTE</em> &ndash; allocate_sampler called in function &ndash; MUST deallocate manually</p>
<p><em>NOTE</em> &ndash; sampler-&gt;chain_temps allocated internally &ndash; MUST free manually </p>

</div>
</div>
<a id="a6df174eb68b851e0ccd3b966e65f3a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df174eb68b851e0ccd3b966e65f3a77">&#9670;&nbsp;</a></span>load_temps_checkpoint_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_temps_checkpoint_file </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>check_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>load temperatures from checkpoint file </p>
<p>Assumed the temps array is already allocated in memory for the correct number of chains</p>
<p>Just a utility routine to read temperatures from checkpoint file</p>
<p>It would be easy to read in the chain number and allocate memory in the function, but I prefer to leave allocation/deallocation up to the client </p>

</div>
</div>
<a id="a251e0a0b4059499d25f6d3c9957ceb1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a251e0a0b4059499d25f6d3c9957ceb1d">&#9670;&nbsp;</a></span>mmala_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mmala_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>current_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>proposed_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>current_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>proposed_status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MMALA informed step &ndash; Currently not supported. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sampler</td><td>Sampler struct </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param</td><td>current position in parameter space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proposed_param</td><td>Proposed position in parameter space </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1f07e7540a20f438aad42f569c2e22d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f07e7540a20f438aad42f569c2e22d2">&#9670;&nbsp;</a></span>PT_dynamical_timescale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PT_dynamical_timescale </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timescale of the PT dynamics. </p>
<p>kappa in the the language of arXiv:1501.05823v3 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>Timescale of the dyanmics </td></tr>
    <tr><td class="paramname">nu</td><td>Initial amplitude (number of steps to base dynamics on) </td></tr>
    <tr><td class="paramname">t</td><td>current time </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1b5c301686c971e3f9359cdd661529b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b5c301686c971e3f9359cdd661529b3">&#9670;&nbsp;</a></span>RJ_smooth_history()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RJ_smooth_history </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>current_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>current_param_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>base_history_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eff_history_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>eff_history_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sampler</td><td>Current sampler </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param</td><td>Current parameters to match </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param_status</td><td>Current parameters to match </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">base_history_id</td><td>Original history element </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">eff_history_coord</td><td>Modified history coord </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">eff_history_status</td><td>Modified History status </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">chain_id</td><td>Chain ID of the current chain </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a048b4bd95b3bac1d355d5c5897c29ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a048b4bd95b3bac1d355d5c5897c29ece">&#9670;&nbsp;</a></span>RJ_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RJ_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>current_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>proposed_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>current_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>proposed_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chain_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RJ-proposal step for trans-dimensional MCMCs. </p>
<p>This extra step may seem unnecessary, I'm just adding it in in case the extra flexibility is useful in the future for preprocessing of the chain before sending it to the user's RJ_proposal </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sampler</td><td>sampler </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_param</td><td>current coordinates in parameter space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proposed_param</td><td>Proposed coordinates in parameter space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_status</td><td>Current status of parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proposed_status</td><td>Proposed status of parameters </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">chain_number</td><td>chain mumber </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a21d8297d53aac4b86b446a6bdb3894d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21d8297d53aac4b86b446a6bdb3894d9">&#9670;&nbsp;</a></span>single_chain_swap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int single_chain_swap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>chain1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>chain2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>chain1_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>chain2_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T1_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T2_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>subroutine to actually swap two chains </p>
<p>This is the more general subroutine, which just swaps the two chains passed to the function </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sampler</td><td>sampler structure </td></tr>
    <tr><td class="paramname">chain1</td><td>parameter position of chain that could be changed </td></tr>
    <tr><td class="paramname">chain2</td><td>chain that is not swapped, but provides parameters to be swapped by the other chain </td></tr>
    <tr><td class="paramname">chain1_status</td><td>Parameter status array for chain1 </td></tr>
    <tr><td class="paramname">chain2_status</td><td>Parameter status array for chain2 </td></tr>
    <tr><td class="paramname">T1_index</td><td>number of chain swappe in chain_temps </td></tr>
    <tr><td class="paramname">T2_index</td><td>number of chain swapper in chain_temps </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae363e3b27d7254afd01c6285a63af4bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae363e3b27d7254afd01c6285a63af4bd">&#9670;&nbsp;</a></span>transfer_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transfer_chain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>samplerptr_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>samplerptr_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>transfer_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies contents of one chain to another. </p>
<p>Transfers id_source in samplerptr_source to id_dest samplerptr_dest</p>
<p>NOTE: This copies the VALUE, not the reference. This could be expensive, so use with caution</p>
<p>id_dest is ERASED</p>
<p>samplerptr_dest and samplerptr_source MUST have the same dimension, the same sampling details (like having or not having a fisher) etc</p>
<p>samplerptr_dest must be previously allocated properly</p>
<p>As output is the largest transfer by far, the transfer_output flag can be used to allow the user to handle that manually. </p>

</div>
</div>
<a id="ae0ec0745c85caad31c473a608aef5782"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ec0745c85caad31c473a608aef5782">&#9670;&nbsp;</a></span>update_temperatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_temperatures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>samplerptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>updates the temperatures for a sampler such that all acceptance rates are equal </p>
<p>Follows the algorithm outlined in arXiv:1501.05823v3</p>
<p>Fixed temperatures for the first and last chain</p>
<p>used in MCMC_MH_dynamic_PT_alloc_internal</p>
<p>For defined results, this should be used while the sampler is using non-pooling methods </p>

</div>
</div>
<a id="a2207c4aeab89b5b985ac2fb297426ba5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2207c4aeab89b5b985ac2fb297426ba5">&#9670;&nbsp;</a></span>write_checkpoint_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_checkpoint_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsampler.html">sampler</a> *&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine that writes metadata and final positions of a sampler to a checkpoint file. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
