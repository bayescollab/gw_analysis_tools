(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    153787,       4019]
NotebookOptionsPosition[    144966,       3868]
NotebookOutlinePosition[    145303,       3883]
CellTagsIndexPosition[    145260,       3880]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"X1", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781049206378378*^9, 3.781049231888358*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"31660c16-dd4f-4ea4-a526-bc4ea355f86c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7810492445356827`*^9, 3.781049250832769*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"860a80c4-9cb0-4920-9eb0-6b74a4ab1462"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RotatedX", " ", "=", " ", 
  RowBox[{
   RowBox[{"EulerMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "]"}], ".",
    "X2"}]}]], "Input",
 CellChangeTimes->{{3.781049345300497*^9, 3.781049356358214*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"1925ba79-01d9-4699-b9d4-e9824ff34d75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"z", " ", 
     RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"z", " ", 
     RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"z", " ", 
     RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "-", 
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"Sin", "[", "\[Beta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.781049357564185*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"d3c7b4c1-6840-4c34-9bac-8e8845cfa23e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"X1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
      RowBox[{"RotatedX", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"X1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
      RowBox[{"RotatedX", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"X1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "==", 
      RowBox[{"RotatedX", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], " ", "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7810492523525667`*^9, 3.7810494012661867`*^9}, {
  3.7810494523726397`*^9, 3.781049454599657*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"e1bc3493-3e6d-400d-8385-04851e5f258f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"X", "+", 
     RowBox[{"y", " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
     RowBox[{"x", " ", 
      RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", " ", 
           RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
          RowBox[{"y", " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{"Y", "\[Equal]", 
    RowBox[{
     RowBox[{"z", " ", 
      RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
        RowBox[{"x", " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
        RowBox[{"y", " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"Z", "+", 
     RowBox[{"x", " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]", "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"z", " ", 
      RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "+", 
     RowBox[{"y", " ", 
      RowBox[{"Sin", "[", "\[Beta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.781049258533053*^9, 3.781049308905455*^9}, {
   3.78104939104289*^9, 3.781049401736244*^9}, 3.781049455134428*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"9a5b2795-7130-45b4-884b-b79b50cfb81e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"eq", "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"eq", "[", 
  RowBox[{"[", "3", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.781049430238721*^9, 3.781049440216531*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"a8b19609-7c7f-466a-a1c4-ad459609824b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "+", 
   RowBox[{"y", " ", 
    RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
   RowBox[{"x", " ", 
    RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"z", " ", 
      RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
        RowBox[{"y", " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.781049432273488*^9, 3.781049457703965*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"613aae73-11bb-4d92-b66b-88003b7b4926"],

Cell[BoxData[
 RowBox[{"Y", "\[Equal]", 
  RowBox[{
   RowBox[{"z", " ", 
    RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"y", " ", 
       RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
      RowBox[{"x", " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
      RowBox[{"y", " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.781049432273488*^9, 3.781049457705489*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"7abdebc9-3fe2-4639-afde-e1b435333654"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "+", 
   RowBox[{"x", " ", 
    RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Beta]", "]"}]}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"z", " ", 
    RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "+", 
   RowBox[{"y", " ", 
    RowBox[{"Sin", "[", "\[Beta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}]}]], "Output",
 CellChangeTimes->{{3.781049432273488*^9, 3.781049457707046*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"1cf139f8-0a68-4569-9555-a291e1b9b7bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"eq", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.78104939419454*^9, 3.7810494221227417`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"b87713bb-4945-432a-8c3a-fd421941372e"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.781049415170066*^9, 3.781049422620399*^9}, {
  3.7810494636513147`*^9, 3.781049465780909*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"30fcba38-fb68-494a-844a-c1e8337dbab6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"EulerMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "]"}], "//",
    "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.7810495666259947`*^9, 3.781049568000085*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"2ce72a15-5721-475c-b325-c1bc93fe9c67"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Beta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Beta]", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.781049562395053*^9, 3.781049568356576*^9}},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"eb1cb781-f700-48ec-8c7f-\
4a5e154d27de"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jeq", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]JN", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]JN", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]JN", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]JN", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JSF", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7810520975001173`*^9, 3.781052196994841*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"16a6fd0d-90a4-4bd6-8bce-23e5e8ebaf85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", " ", "=", " ", 
  RowBox[{
   RowBox[{"Cross", "[", 
    RowBox[{"Jeq", ",", "JSF"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7810522826842413`*^9, 3.781052300531657*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"105226b0-21eb-4ec6-a2b5-d1ab29e089a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], " ", 
     RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], " ", 
    RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.781052297320076*^9, 3.781052300757373*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"a0b6ad2a-23f6-4da0-abda-bae8cd994d54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", " ", "=", " ", 
  RowBox[{
   SqrtBox[
    RowBox[{"v", ".", "v"}]], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.781052305581728*^9, 3.781052331502144*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"139d80a4-0826-4632-8c77-930d4dfb57f9"],

Cell[BoxData[
 RowBox[{"\[Sqrt]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], ")"}]}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{{3.781052321097144*^9, 3.78105233263691*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"3baa6f4e-4252-4270-886c-c8b233639256"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c", " ", "=", " ", 
  RowBox[{
   RowBox[{"Jeq", ".", "JSF"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.781052327282093*^9, 3.781052344958683*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"9e119791-74dd-44e9-9ce5-64cd888a76ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.781052341214508*^9, 3.781052345210868*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"c9b494ab-ac2f-4360-8fb6-5e3218fc4e67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"V", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.781052367940127*^9, 3.7810524164800663`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"020e207f-456c-49d3-82b5-4e00f6890ea1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], " ", 
      RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7810524171166887`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"48d0c837-5fdd-4531-aa3e-537b8d3c16bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", "V", " ", "+", " ", 
    RowBox[{
     RowBox[{"V", ".", "V"}], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "c"}], ")"}], 
      SuperscriptBox["s", "2"]]}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.781052245658346*^9, 3.781052281259577*^9}, 
   3.781052352989839*^9, {3.781052420723318*^9, 3.781052449819332*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"adc7f257-f4ad-43d4-9032-f6f599e5613a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], "2"], 
           "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
          ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Phi]JN", "]"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}], "+", 
              
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}], "2"]}]}], ")"}]}]}], 
          ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JN", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]JNSF", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]JN"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]JN", "]"}], "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]JN", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], "2"]}]}], 
           ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]JNSF", "]"}]}]}], ",", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]JN", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]JNSF", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]JN", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]JNSF", "]"}]}]}], 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"Cot", "[", "\[Theta]JN", "]"}], " ", 
           RowBox[{"Cot", "[", "\[Theta]JNSF", "]"}], " ", 
           RowBox[{"Cot", "[", 
            RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cot", "[", "\[Theta]JN", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"Cot", "[", "\[Theta]JNSF", "]"}], "2"]}], ")"}], " ", 
           RowBox[{"Csc", "[", 
            RowBox[{"\[Phi]JN", "-", "\[Phi]JNSF"}], "]"}]}]}]]}]]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.781052251328947*^9, {3.7810524241847773`*^9, 3.7810524334603*^9}, 
   3.7810530799118156`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"470d857e-a87c-48ec-a97b-b1794bc2d176"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assumptions", "\[Rule]", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Iota]", "\[Element]", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}]}], ",", 
    RowBox[{"A", "\[Element]", " ", "Re"}], ",", " ", 
    RowBox[{"B", "\[Element]", "Re"}], ",", " ", 
    RowBox[{"c", "\[Element]", "Re"}], ",", " ", 
    RowBox[{"d", "\[Element]", "Re"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.781091802290709*^9, 3.781091858911853*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"b4a9aa3a-d2c5-4797-a52c-2ca1e25aa4dc"],

Cell[BoxData[
 RowBox[{"Assumptions", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Iota]", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], ",", 
    RowBox[{"A", "\[Element]", "Re"}], ",", 
    RowBox[{"B", "\[Element]", "Re"}], ",", 
    RowBox[{"c", "\[Element]", "Re"}], ",", 
    RowBox[{"d", "\[Element]", "Re"}]}], "}"}]}]], "Output",
 CellChangeTimes->{
  3.781091822318182*^9, {3.781091854970834*^9, 3.781091859313354*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"feafd0b8-6047-4889-a56a-89ddca5341fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Iota]", "]"}], "A"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Iota]", "]"}], "B"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", "c"}]}], " ", "\[Equal]", 
       " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", "\[Equal]", " ", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"J", ",", "n"}], "]"}], ".", 
        RowBox[{"Cross", "[", 
         RowBox[{"J", ",", "n"}], "]"}]}]}], ",", 
      RowBox[{"{", "\[Iota]", "}"}]}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Element]", " ", 
       TemplateBox[{},
        "Integers"]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.781091716265204*^9, 3.781091800755872*^9}, {
  3.781091863175989*^9, 3.781091878587928*^9}, {3.781092248137405*^9, 
  3.781092248776301*^9}, {3.7810924560506897`*^9, 3.7810924575003653`*^9}, {
  3.781092524176347*^9, 3.781092524914341*^9}, {3.781092767618306*^9, 
  3.781092836246093*^9}, {3.78109542434359*^9, 3.7810954415416737`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"cfc595a3-6292-4cc7-8c88-907cfa15269e"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", " ", 
      RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "+", "B"}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", "theta", "]"}], "2"], "\[Equal]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Iota]", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", " ", 
         RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", " ", 
         RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ")"}], "2"]}]}], ",", 
   RowBox[{"{", "\[Iota]", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.781091742237468*^9, 3.781091762311593*^9}, 
   3.7810918234648542`*^9, {3.781091864490903*^9, 3.7810918790930233`*^9}, 
   3.7810922505467787`*^9, 3.7810924582868032`*^9, 3.781092525431044*^9, {
   3.781092806675403*^9, 3.781092836613039*^9}, 3.78109544341565*^9, 
   3.78109548394285*^9, 3.781095713841905*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"c1333d34-083f-41cf-8d0c-9013bbb2c0e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Iota]", "/.", 
          RowBox[{"sols", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
         RowBox[{"c", "\[Rule]", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["A", "2"], "+", 
            SuperscriptBox["B", "2"]}]]}]}], "/.", 
        RowBox[{"B", "\[Rule]", ".2"}]}], "/.", 
       RowBox[{"d", "\[Rule]", ".99"}]}], "/.", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Iota]", "/.", 
          RowBox[{"sols", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
         RowBox[{"c", "\[Rule]", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["A", "2"], "+", 
            SuperscriptBox["B", "2"]}]]}]}], "/.", 
        RowBox[{"B", "\[Rule]", ".2"}]}], "/.", 
       RowBox[{"d", "\[Rule]", ".99"}]}], "/.", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Iota]", "/.", 
            RowBox[{"sols", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
           RowBox[{"c", "\[Rule]", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["A", "2"], "+", 
              SuperscriptBox["B", "2"]}]]}]}], "/.", 
          RowBox[{"B", "\[Rule]", ".2"}]}], "/.", 
         RowBox[{"d", "\[Rule]", ".99"}]}], "/.", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], " ", ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Iota]", "/.", 
            RowBox[{"sols", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
           RowBox[{"c", "\[Rule]", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["A", "2"], "+", 
              SuperscriptBox["B", "2"]}]]}]}], "/.", 
          RowBox[{"B", "\[Rule]", ".2"}]}], "/.", 
         RowBox[{"d", "\[Rule]", ".99"}]}], "/.", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], ")"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"A", ",", "0", ",", ".5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.781092448774809*^9, 3.7810926527770576`*^9}, {
   3.781092852233611*^9, 3.781092918157302*^9}, {3.781093223562468*^9, 
   3.781093310067198*^9}, {3.7810933547963343`*^9, 3.781093393929421*^9}, 
   3.781093435891361*^9, {3.781093493336649*^9, 3.781093505533779*^9}, {
   3.781093772804658*^9, 3.7810937924374743`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"dab0e8ec-5376-40ea-aecb-67446a4cd23c"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVzGk81HkAx3Fil3JEOnbU6EUkqhXJlrLfRCpKjtJJklKS1bF0sFaLiuRs
TI5xjKMoM5hBzPST+ac2t3EW/lZWQkmStBvbPvi83s8+2h6/OB2fJSMjs+tb
/2t7fLCp8s3Wn8+sV+VvvCEm8laafjRDF5197p5xYWKyNo2dUswwhY60njMY
IiZ2de1FqQxryLG9c+Ivi8k+z0lxHGMPguIy5PpPi0m30TWrKIYnggf7VXzt
xSR9we7wCMYFbE5W01qhISYhisX6NxihSFBJf7MhWUT2H8jgvR9LQIlakrJq
bAVRmgk5vE0rDT+kBQ1vjS0neo7vBiWRWRBxxuKVYx6SgPoNYH+8B0syvVD7
XBlZJFDvkZXlofg+55jm0VJS0mdV27CpCMG8f7dKTEpIlXfq4gMjAuQyLLh5
ckIysdxi7oMzpVhifDYw6lUxmTWVr7ZYrxzMzKNi/+wiYjbjXuJcIELe4ODQ
oYBCUhtqWl9tSCAXrNz6hy2fLI0Znrr3rhLj7MZcmekHZHiS7mldUwXb6WH7
7yPySdZQxXPVWxJY6+/lnGq/S1SZuaP9/RRa4lNmZ+rnkJunhCfSdavx+agf
n5vKJZ825/efDH4KVqAYgdJ0csGEEiyUPEPkwS8L/nZPIXQBFdmk/Rw5TxST
mxNZ5B/vlmSDyzWYbzc3+nZ7DFlpqTB9oqIW1XMici1awsm2TG2vwkX1aLO0
8b3S+SsJYB7R+etwA/SzCwVSE12sGtmr1L6rERlGmU13XvtDY+57RepLI5gO
PZbMvGuQJ8m8ZSlNuG5z/INXYixOm1Z0zrZrhkreeS+HgUTk7/BIf/SpGTMj
A71DKziYGNZUG2BJkfTxWUC4QiaEztvkEqxbwLpi/opsyUbw9rA0wUAL1Ny4
AS/t70K727aDG9YKLmegUMk5H+Y/hSYwTNpgtdihbG9GAQ5rNUzJStugc9E6
zpfmY+J5VJ9fSDseLQuw0kgoAlve7YKTbgdyXA7GjxoJoNEjzJxFdWCdi5ZW
1lMhvgsK2bPhbCeUrb+aOoaXQuaeG69v3gsYRxmW+qx8iHNJvKh5VS/Q3Gle
5/u5HOKV1xXVfV/ig7v2jrbHIqjbnlt1VbUL7NtlMb1+j9C1ulF6SdQF/wK5
F5G6leBzoNvv1g0L4ZmFtnKP4cozU2dOd+N9/Gufbvoxfg/LCOnK60Gdgo+P
oKkKDwaZyao7adwaPxBfI5TgemqYe489jatvvfxqHkrg6fRWr8CRxsGbhkE1
YgmWiET8Xfto+Ih79WqfSBARfaj6pgeN7a4sQUOrBCfN7ozNuUSji+VSQ09I
oBM6f7tCDg39rPGZZWYUptcHqrTfpWElHOgyMKfQ+fZVc04+DaaZwZDRzxRi
9hW72hTS+GrBv73JhsKModP5MBGNCqGD8X4XCl1N0Rw5KY18T5Ngtj+FsvDJ
Y9JWGv71vscyLlNI2HjEgNtBo1/f9mLebxTssn8UbOmh4VExtlYcTqH8Yt2f
IW9o3DeOHe9nUWCtXhftOEJD66Wj62gShbN9KXu0R2nIijsnpzgUVuz0oSs/
fvudciZzcynIy7ZkxUzS2L1/94hmPoVe4UZv9y80dKqX2y7nURB5c43WfKWR
86ynw7iYQuJSpYmZGRp8/0C2RSmF/wAYN331
       "]]},
     Annotation[#, "Charting`Private`Tag$21378#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVjXk01AkAxw2zm9ajHBmjhkeIpMO1i/Jdi3KkzbHZdpFVJBTKPsr2yuaO
5bVSWww5JlZichXjSFaRHDkGO/zGkGsYM7/SpINt//i8z/v89dEJCPcIlJWR
kXH7zP92CZzta5lztE3s0HRWVOeDaq8ZQdD1UGPzKUpK48Ms72ZOFd0c+xwD
0yfofLi+4D7IpTvgyjvulRoGH94npI3X6F6IjmtL8tHnY2xXkn06/QRoRreW
WOZ85G/6PjGVHoULjnO+Jp58xMlXbUuhx+OM+kAxJZOPH4/eqRBLsqBASmKE
KhNQWIvzOaCVh/AdFraUtAnou4tmn1wtgvLWp0ZsigDR3Va4+aYUe2InpA6X
BaBVK49TKBX4R7K4PnxZgFqBfVfP3ge4kT3YE3xuEq0huZuPLlSj5JdwSx3R
JJYN9m0oP10HvQ4N285jU5BdKdu4Wb8elob5kaajU7Bc86/1vM9BedJhtYeu
r9AVb97dvr0ZzOGF00fqX0E7U7hSKmqB2eY6w+I90xBKifHB3a0Iuizq8sqf
RtF8Q6fSH08QbrUSzaLNQIlxd2lqqg3XNnRTt6XNIO1UTVC+Xjs+Hn3Ls383
g7fflk0FX3qKWEW/UmnYLKJM26rVnzyDmrB2LnBkFsT9tqt9Op2wU+ye9T80
hw8hA7eNLjyHjKqVbWPLHIzt1q0GNXQh8bpDrJzxPA4U6Jxk07qxdljmQ0/u
PKIZx3QnfHrAzmvqZcoLsWPhBwWuWy9YUWVyMpFCqG4Qy7e970XzkHfF5IQQ
1ObbFVtz+iDbl/JU5LKAUPOGkfWuL5HaMt0ew1lAmXNAftPbl9j7OtSOZbyI
ZaHmxunsfry/Qtu55c9F1HgekMtyGIBW9T0fFTkRLjkl5FVPD8BNwywiIFQE
nTGX4cKEQRSsWK7G9Ilg/XV8Ft10CLkGhdpq3y7BR6tnhdI/BFbdkVbdu0tY
7kwXRMRx0elU8txHQYybVL8oD71hmETGGpyCGKrjNQWybcOoqgyNCDorxhcX
47ysIkdwvMuJUl4qhkypX4VAZRQWzs3XbcfEOHurIl2ldRQlC958xiYJGo2T
5ZXP/IsZfQHznasEyi5nd/yuxMMNTc5Hg0sS8Ex6+89zeIhgZS+V1UpQyYTe
lN8Yki+mpabMS+BbYanMWB3Ds6QCdhiDxOWEO3G8v8ehcW/Ig+1FonyWcVvp
IIF1D6hFXskkknMT/McPEXhk7+hvk0LihMei/n13Apk2VC3dVBJbOJxKN28C
dE8Kc+kqidSMn9vTAgjsHletTM0gEWz5l+Sr8wRYpTGMx9kkdOPVnNaxCBT4
WentKiax+s1vitySz78OMxV1FomRxcmXrDICaxe7KJ8+d6Z3le9+NgGjLt6r
zhISa9s9ziVwCLC1rz8OukeC15fBlOsn4Lx3/zNmFYmHidLj/YMEgmnM3oRq
Elk2x4wKhwnY+RaNhtWQcC3eWf3dOIHzFi2vretI1Me86IibI+Dxq7s1t55E
tolFhvsCAY6s1eGmBhKRghwvnSUCnerck8UcEoYHw4iWNwRMJ61zzjWRoFIG
ijKlBL4skn30UzMJfo1NiP97AjEf47l2LSQ4IYW7dn8ioCFplRo+JnFDW2F5
bY1AVmIjfWMrif8AJbd1xg==
       "]]},
     Annotation[#, "Charting`Private`Tag$21378#2"]& ], 
    TagBox[
     {RGBColor[0.560181, 0.691569, 0.194885], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVznk41Akcx3Gix7SWQlumHGGUo4PMSmz7VRQlHcixbknSsR32KXarnZgU
OfJMpKmQSWutK7Q2o2+Yh1K5cxTzy8wYY8bM/PQ4Shs7+8fneT+v/z5mUT/7
HFmkpqbmrdr/3XNE0vV8fOePrCwjpLcKUdNt1WmCSoNlgdcbS14I0SH/9t1q
Kh0KTaHQpE2IXm/6H9+jukOS18NPWm+EGBA925BN9YPWaifKYLcQhzeluKVT
o2Fdi39VPF+IBd/tv5pKjQdBYGlk9rQQGZTqddepybDGkCKMtRBhYFBhBTnJ
AnM601mHKULtBUaIh0k++HzgfLHmi9DyoELSnMYBif9O7mOHUTzfvhVuT5UA
1bdx1fWMUVxZo8dXV6+A4NZI/+yRUXwicHvd8cNjSFl/y6lxqxib4u6tDpqo
gWHN/tScDDFOr922tOzk3+CpLJa7DIlx0efSZastn0JiyN7dIxvH0HEh4olv
OReaOGU3ixLH8HUyvb3FBuFSbIakuHkMTbNkn0sUz6GJRndg6klQNkvw39o1
gZfrsP10oAQ50vo23YxmEKbx9YwfSlDX+JFSJOJBx8BRy0KFBG8cq40poLWA
UcTXlSabx3HGtVQUe7kV3EeDTm5KHMf4zbyaFc0vQNIQo3+SO45EOS+ty6wN
TvkWXzTVkOKXuF62deIrCEqvkiZ4SNF2u9Z8TP1rqGoQnPG7KkWPB2ZHq1a2
Q9Lw0OSVl1I8bxxuPhLSAbl+SUXBWjJcP3FIu9+7EzzsKJ12bjI0WEpSeHOd
cDn0gLNLkgw1kV1hcbcL2otnUhyeyfA4vX5wiVc3OFuUuu36KsPS3VEFz2a6
obc+WhrmPIHTslXLxDk9UDl1p6Xo7ATW+nposNx74ci3CWHi8gm87MnMrxH3
wglBXV28eALNhvcMFDHfQl2moZunkRydtySzqJv7YJxmwps/JMcQk47P6j19
8MBKl6SnyXG6LV1wmtEPRmUjG7fw5HhbMyzehzYAzNy0n3o/ydGAX/tgEW8A
8nMMQgdsFbj4IsNv65lBcCcn32dGKVCtJKxCoP8OeK55rKW3FHj2TkW6ftM7
WHGJMrbhlQIbbK9R9E69h0rTgvgnCwrU23N2/RXdIfjVPHLM3k6JQxs6exK4
Q7Aj8i8JPVqJlfeBJgobhsb0i5muLCWGVjjqGc8PA8tGmyJoUuLvzELG0J98
2OafnTo9pcQyiTFbdy8Bt87l2bP1SLx2jxnB30fAkl1OH9X1SYz2kVuWHyRg
sTSsPFZlIy630juAgBMuO6mOBiSmZga33IgiIEWf8U/nchJjHfMmv0kgoK1P
h7bYkETz5OWeWsUEGEudOXEmJM47/abT/wcB4R9z+jpVHpQLu4tLCXAJSNHc
YkpiVkB16K4qAo7x1vpqrCFxwcbnHJNLwBzleD3bjMShrsz7Gj0E1CjD617R
SKy7Onu45y0BedvsOPaWJLJcwq2LBghwN2Sn5ars9XBjzQ4+ATrz270PryXx
6YU3LxnjBBjtJ9hz60jM2fB95sEJAgJbM6IjrEg8I7jrZ6YkwIZ4b9WistXe
E8TzKQJmfjnAuWlNoqZ6LydrloB/6y4Ez6r8odYlLmJO9cfCVTfUhkRuXNEm
u68EaBg+4japnGuqPb2wQMCz2bIYK1sS/wNgxJU2
       "]]},
     Annotation[#, "Charting`Private`Tag$21378#3"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.5}, {-1.0105365763588305`, 1.1723786359292818`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7810924649144363`*^9, 3.781092543191783*^9}, {
  3.781092580642281*^9, 3.781092653155892*^9}, {3.781092843333006*^9, 
  3.781092919850346*^9}, {3.781093223974842*^9, 3.781093243919445*^9}, {
  3.781093284306809*^9, 3.781093310403307*^9}, {3.7810933658889103`*^9, 
  3.781093394307025*^9}, {3.781093428930583*^9, 3.781093437108782*^9}, {
  3.7810934943173647`*^9, 3.7810935059938307`*^9}, {3.781093780097632*^9, 
  3.781093793570141*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"141e31cd-cf9b-4891-9143-38831c6f7e26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Iota]", "/.", 
          RowBox[{"sols", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
         RowBox[{"c", "\[Rule]", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["A", "2"], "+", 
            SuperscriptBox["B", "2"]}]]}]}], "/.", 
        RowBox[{"B", "\[Rule]", ".6"}]}], "/.", 
       RowBox[{"d", "\[Rule]", ".9"}]}], "/.", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], " ", ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Iota]", "/.", 
          RowBox[{"sols", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
         RowBox[{"c", "\[Rule]", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["A", "2"], "+", 
            SuperscriptBox["B", "2"]}]]}]}], "/.", 
        RowBox[{"B", "\[Rule]", ".6"}]}], "/.", 
       RowBox[{"d", "\[Rule]", ".9"}]}], "/.", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], ")"}]}], "/.", 
   RowBox[{"A", "\[Rule]", ".2"}]}], " ", "//", "N"}]], "Input",
 CellChangeTimes->{{3.781093446856597*^9, 3.781093526239956*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"601eff53-86f1-4ecb-9ba0-ea42c6b950ac"],

Cell[BoxData[
 RowBox[{"-", "1.7451477068646732`"}]], "Output",
 CellChangeTimes->{{3.781093458759202*^9, 3.781093526657816*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"b7dcb35d-2006-4afd-a075-b0afa3438770"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"A", ",", "B", ",", "c"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Iota]", "]"}], ",", " ", 
     RowBox[{"Sin", "[", "\[Iota]", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.781095238162271*^9, 3.781095264382683*^9}, {
  3.781095317532817*^9, 3.781095346085915*^9}, {3.78109547018147*^9, 
  3.781095478944055*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0bd78d57-53aa-4ddf-abc9-869d34f0758f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cross", "[", 
   RowBox[{"J", ",", "n"}], "]"}], ".", 
  RowBox[{"Cross", "[", 
   RowBox[{"J", ",", "n"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7810952720226393`*^9, 3.781095304987274*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"f928693b-d8bd-458c-adf7-e7b3147f5e34"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Sin", "[", "\[Iota]", "]"}]}], "-", 
     RowBox[{"B", " ", 
      RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"B", " ", 
      RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "A"}], " ", 
      RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.7810952773279333`*^9, 3.781095305268351*^9}, 
   3.781095347602832*^9, 3.7810954803075542`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"f9999b3a-1b5e-401a-84ca-e6cdda1f114f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], "\[Equal]", " ", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{"J", ",", "n"}], "]"}], ".", 
       RowBox[{"Cross", "[", 
        RowBox[{"J", ",", "n"}], "]"}]}]}], ",", 
     RowBox[{"{", "\[Iota]", "}"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "\[Element]", 
     TemplateBox[{},
      "Integers"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.781095356498098*^9, 3.781095371926599*^9}, {
  3.781095547295107*^9, 3.781095556798608*^9}, {3.781095588712071*^9, 
  3.781095624758337*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"dc2c78b8-2a5b-4b1e-96c6-09742d5895e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Iota]", "\[Rule]", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], " ", "c", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["A", "2"], "+", 
             SuperscriptBox["B", "2"], "-", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}]}]], 
         RowBox[{
          SqrtBox[
           FractionBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["A", "3"], " ", "B"}], "+", 
             RowBox[{"A", " ", 
              SuperscriptBox["B", "3"]}], "+", 
             RowBox[{"2", " ", "A", " ", "B", " ", 
              SuperscriptBox["c", "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "A"}], " ", "B"}], "+", 
                SuperscriptBox["c", "2"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
               SuperscriptBox["c", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "-", 
                    RowBox[{"A", " ", "B"}], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["A", "2"], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["B", "2"], "+", 
               SuperscriptBox["c", "2"]}], ")"}]}]]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["A", "2"], " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{"2", " ", "A", " ", "B", " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["B", "2"], " ", 
             SuperscriptBox["c", "2"]}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
              SuperscriptBox["c", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "-", 
                   RowBox[{"A", " ", "B"}], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
           ")"}]}]}], ",", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["A", "3"], " ", "B"}], "+", 
           RowBox[{"A", " ", 
            SuperscriptBox["B", "3"]}], "+", 
           RowBox[{"2", " ", "A", " ", "B", " ", 
            SuperscriptBox["c", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "A"}], " ", "B"}], "+", 
              SuperscriptBox["c", "2"]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["A", "2"], "+", 
                  SuperscriptBox["B", "2"], "+", 
                  SuperscriptBox["c", "2"]}], ")"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["A", "2"], "-", 
                  RowBox[{"A", " ", "B"}], "+", 
                  SuperscriptBox["B", "2"], "+", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["A", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["B", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}]}]]]}], "]"}], "+", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       TemplateBox[{"1"},
        "C"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Iota]", "\[Rule]", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"A", "+", "B"}], ")"}], " ", "c", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["A", "2"], "+", 
              SuperscriptBox["B", "2"], "-", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}]}]], 
          RowBox[{
           SqrtBox[
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["A", "3"], " ", "B"}], "+", 
              RowBox[{"A", " ", 
               SuperscriptBox["B", "3"]}], "+", 
              RowBox[{"2", " ", "A", " ", "B", " ", 
               SuperscriptBox["c", "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "A"}], " ", "B"}], "+", 
                 SuperscriptBox["c", "2"]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
                SuperscriptBox["c", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["A", "2"], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["A", "2"], "-", 
                    RowBox[{"A", " ", "B"}], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
             
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["A", "2"], "+", 
                SuperscriptBox["c", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B", "2"], "+", 
                SuperscriptBox["c", "2"]}], ")"}]}]]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["A", "2"], " ", 
              SuperscriptBox["c", "2"]}], "+", 
             RowBox[{"2", " ", "A", " ", "B", " ", 
              SuperscriptBox["c", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["B", "2"], " ", 
              SuperscriptBox["c", "2"]}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
               SuperscriptBox["c", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "-", 
                    RowBox[{"A", " ", "B"}], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
            ")"}]}]}]}], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["A", "3"], " ", "B"}], "+", 
            RowBox[{"A", " ", 
             SuperscriptBox["B", "3"]}], "+", 
            RowBox[{"2", " ", "A", " ", "B", " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "A"}], " ", "B"}], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
              SuperscriptBox["c", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "-", 
                   RowBox[{"A", " ", "B"}], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["A", "2"], "+", 
              SuperscriptBox["c", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["B", "2"], "+", 
              SuperscriptBox["c", "2"]}], ")"}]}]]]}]}], "]"}], "+", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       TemplateBox[{"1"},
        "C"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Iota]", "\[Rule]", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], " ", "c", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["A", "2"], "+", 
             SuperscriptBox["B", "2"], "-", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}]}]], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["A", "2"], " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{"2", " ", "A", " ", "B", " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["B", "2"], " ", 
             SuperscriptBox["c", "2"]}], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
              SuperscriptBox["c", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "-", 
                   RowBox[{"A", " ", "B"}], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
           ")"}], " ", 
          SqrtBox[
           FractionBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["A", "3"], " ", "B"}], "+", 
             RowBox[{"A", " ", 
              SuperscriptBox["B", "3"]}], "+", 
             RowBox[{"2", " ", "A", " ", "B", " ", 
              SuperscriptBox["c", "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "A"}], " ", "B"}], "+", 
                SuperscriptBox["c", "2"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
               SuperscriptBox["c", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "-", 
                    RowBox[{"A", " ", "B"}], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["A", "2"], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["B", "2"], "+", 
               SuperscriptBox["c", "2"]}], ")"}]}]]]}]}], ",", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["A", "3"], " ", "B"}], "+", 
           RowBox[{"A", " ", 
            SuperscriptBox["B", "3"]}], "+", 
           RowBox[{"2", " ", "A", " ", "B", " ", 
            SuperscriptBox["c", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "A"}], " ", "B"}], "+", 
              SuperscriptBox["c", "2"]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["A", "2"], "+", 
                  SuperscriptBox["B", "2"], "+", 
                  SuperscriptBox["c", "2"]}], ")"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["A", "2"], "-", 
                  RowBox[{"A", " ", "B"}], "+", 
                  SuperscriptBox["B", "2"], "+", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["A", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["B", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}]}]]]}], "]"}], "+", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       TemplateBox[{"1"},
        "C"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Iota]", "\[Rule]", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"A", "+", "B"}], ")"}], " ", "c", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["A", "2"], "+", 
              SuperscriptBox["B", "2"], "-", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}]}]], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["A", "2"], " ", 
              SuperscriptBox["c", "2"]}], "+", 
             RowBox[{"2", " ", "A", " ", "B", " ", 
              SuperscriptBox["c", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["B", "2"], " ", 
              SuperscriptBox["c", "2"]}], "-", 
             SqrtBox[
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
               SuperscriptBox["c", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["A", "2"], "-", 
                    RowBox[{"A", " ", "B"}], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
            ")"}], " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["A", "3"], " ", "B"}], "+", 
              RowBox[{"A", " ", 
               SuperscriptBox["B", "3"]}], "+", 
              RowBox[{"2", " ", "A", " ", "B", " ", 
               SuperscriptBox["c", "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "A"}], " ", "B"}], "+", 
                 SuperscriptBox["c", "2"]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
                SuperscriptBox["c", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["A", "2"], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["A", "2"], "-", 
                    RowBox[{"A", " ", "B"}], "+", 
                    SuperscriptBox["B", "2"], "+", 
                    SuperscriptBox["c", "2"]}], ")"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
             
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["A", "2"], "+", 
                SuperscriptBox["c", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B", "2"], "+", 
                SuperscriptBox["c", "2"]}], ")"}]}]]]}]}]}], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["A", "3"], " ", "B"}], "+", 
            RowBox[{"A", " ", 
             SuperscriptBox["B", "3"]}], "+", 
            RowBox[{"2", " ", "A", " ", "B", " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "A"}], " ", "B"}], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"A", "+", "B"}], ")"}], "2"]}], " ", 
              SuperscriptBox["c", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"A", "-", "B"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}]}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["A", "2"], "-", 
                   RowBox[{"A", " ", "B"}], "+", 
                   SuperscriptBox["B", "2"], "+", 
                   SuperscriptBox["c", "2"]}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["A", "2"], "+", 
              SuperscriptBox["c", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["B", "2"], "+", 
              SuperscriptBox["c", "2"]}], ")"}]}]]]}]}], "]"}], "+", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       TemplateBox[{"1"},
        "C"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.781095375143457*^9, 3.781095557418579*^9, {3.7810956145288343`*^9, 
   3.781095634076367*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"013eb680-fbdf-4c56-91dc-489cc7af9edc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LSF", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSF", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Iota]", "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], "-", "\[Phi]ref"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Iota]", "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", "\[Phi]ref"}], "]"}]}], 
     ",", 
     RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LEQ", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]l", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]l", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]l", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]l", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NEQ", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]s", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]s", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KSF", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"LSF", ",", "NSF"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KEQ", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"LEQ", ",", "NEQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JSF", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Jx", ",", "Jy", ",", "Jz"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.781104752735376*^9, 3.78110489171665*^9}, {
  3.7811051887428017`*^9, 3.781105206028884*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e0e12403-e056-4067-b967-fcdfaee4df8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"LSF", ",", "NSF", ",", "KSF"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"LEQ", ",", "NEQ", ",", "KEQ"}], "}"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7811048984621677`*^9, 3.781104946694324*^9}, {
  3.7811050844569883`*^9, 3.781105099172739*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"1384a3e3-2fb3-497f-a0e2-58f8e3599d5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"R", " ", "=", " ", 
   RowBox[{
    RowBox[{"B", ".", 
     RowBox[{"Inverse", "[", "A", "]"}]}], "//", "Simplify"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.781104935800352*^9, 3.7811050256124363`*^9}, {
  3.781105150944488*^9, 3.781105154308066*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"06e8f24f-c4cf-46d6-aed0-69f6d390bc54"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Csc", "[", "\[Iota]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Csc", "[", "\[Iota]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]l", "]"}]}]},
     {
      RowBox[{
       RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Iota]", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Csc", "[", "\[Iota]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]l", "]"}]}]},
     {
      RowBox[{
       RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]s", "]"}], "-", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Iota]", "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]l", "-", "\[Phi]s"}], "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]ref", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]l", "-", "\[Phi]s"}], "]"}]}]}], ")"}]}], 
      RowBox[{"Cos", "[", "\[Theta]l", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.78110493794307*^9, 3.7811050259919767`*^9}, 
   3.7811051023188133`*^9, 3.781105154564883*^9, 3.781106103622705*^9, 
   3.7812782506891947`*^9, 3.788095851504684*^9},
 CellLabel->
  "Out[10]//MatrixForm=",ExpressionUUID->"31a22543-7dd3-4a4c-9ba5-\
476956012090"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"R", ".", "JSF"}], "//", "FullSimplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.7811050286223087`*^9, 3.781105063691923*^9}, {
  3.781105108577086*^9, 3.781105129476722*^9}, {3.781105210033554*^9, 
  3.7811052266170473`*^9}, {3.781105661757*^9, 3.781105663231821*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"e4b144d9-a9d6-4478-9256-410330706c80"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"Jz", "-", 
           RowBox[{
            RowBox[{"Cot", "[", "\[Iota]", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Jy", " ", 
               RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "+", 
              RowBox[{"Jx", " ", 
               RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}]}]}], ")"}]}],
         "+", 
        RowBox[{
         RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]ref", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Jy", " ", 
               RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]s", "]"}]}], "-", 
              RowBox[{"Jx", " ", 
               RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "+", 
              RowBox[{"Jx", " ", 
               RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]ref", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Jx", " ", 
               RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]s", "]"}]}], "+", 
              RowBox[{"Jy", " ", 
               RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "-", 
              RowBox[{"Jy", " ", 
               RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"Jz", " ", 
         RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]l", "]"}], " ", 
         RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Jx", " ", 
            RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "-", 
           RowBox[{"Jy", " ", 
            RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
         RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Jx"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "+", 
           RowBox[{"Jy", " ", 
            RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Jy", " ", 
            RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "+", 
           RowBox[{"Jx", " ", 
            RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cot", "[", "\[Iota]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]l", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]l", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"Jz", "-", 
           RowBox[{
            RowBox[{"Cot", "[", "\[Iota]", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Jy", " ", 
               RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "+", 
              RowBox[{"Jx", " ", 
               RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}]}]}], ")"}]}],
         "+", 
        RowBox[{
         RowBox[{"Csc", "[", "\[Iota]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Jy", " ", 
               RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "+", 
              RowBox[{"Jx", " ", 
               RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]l", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Jx", " ", 
               RowBox[{"Cos", "[", "\[Phi]ref", "]"}]}], "-", 
              RowBox[{"Jy", " ", 
               RowBox[{"Sin", "[", "\[Phi]ref", "]"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]l", "-", "\[Phi]s"}], "]"}]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7811050309356537`*^9, 3.7811050641497602`*^9}, {
   3.7811051042814417`*^9, 3.7811051298813057`*^9}, {3.781105216796377*^9, 
   3.781105226893916*^9}, 3.7811056788739643`*^9, 3.781106106466462*^9, 
   3.781278255887875*^9, 3.788095875593877*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"38520dec-5815-4343-bbdd-\
b0b103edc2db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LSFn", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSFn", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"si", " ", "cp"}], ",", 
     RowBox[{"si", " ", "sp"}], ",", "ci"}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Direction", " ", "of", " ", "GW", " ", "propagation", " ", "\[Iota]", 
     " ", "is", " ", "the", " ", "angle", " ", "between", " ", "line", " ", 
     "of", " ", "sight", " ", "and", " ", "L"}], ",", " ", 
    RowBox[{
    "not", " ", "vector", " ", "to", " ", "source", " ", "and", " ", "L"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"LEQn", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"stl", " ", "cpl"}], ",", 
     RowBox[{"stl", " ", "spl"}], ",", "ctl"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NEQn", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sts"}], " ", "cps"}], ",", 
     RowBox[{
      RowBox[{"-", "sts"}], " ", "sps"}], ",", 
     RowBox[{"-", "cts"}]}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Direction", " ", "of", " ", "GW", " ", 
     RowBox[{"propagation", " ", "--"}], " ", 
     RowBox[{"(", "-", ")"}], " ", "sign", " ", "comes", " ", "from", " ", 
     "using", " ", "line", " ", "of", " ", "sight"}], ",", " ", 
    RowBox[{"not", " ", "source", " ", "vector"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"KSFn", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"LSFn", ",", "NSFn"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"KEQn", " ", "=", " ", 
  RowBox[{"Cross", "[", 
   RowBox[{"LEQn", ",", "NEQn"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JSFn", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Jxn", ",", "Jyn", ",", "Jzn"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.781105846226223*^9, 3.781105948436157*^9}, {
  3.781106120926708*^9, 3.781106128513913*^9}, {3.781107441584487*^9, 
  3.7811074445004663`*^9}, {3.781278527717287*^9, 3.781278533749957*^9}, {
  3.788098669027378*^9, 3.788098676160058*^9}, {3.788105133137169*^9, 
  3.7881052299069033`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8afdcbab-31ee-4131-b433-03db65d9afd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "si"}], " ", "sp"}], ",", 
   RowBox[{"cp", " ", "si"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7812785300721407`*^9, 3.781278534136198*^9}, 
   3.7880959189979763`*^9, 3.78809869226278*^9, {3.788105230331295*^9, 
   3.788105260076027*^9}},
 CellLabel->"Out[3]=",ExpressionUUID->"03fa5e93-6ea3-4c31-af07-4fadbb1dee2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "cts"}], " ", "spl", " ", "stl"}], "+", 
    RowBox[{"ctl", " ", "sps", " ", "sts"}]}], ",", 
   RowBox[{
    RowBox[{"cpl", " ", "cts", " ", "stl"}], "-", 
    RowBox[{"cps", " ", "ctl", " ", "sts"}]}], ",", 
   RowBox[{
    RowBox[{"cps", " ", "spl", " ", "stl", " ", "sts"}], "-", 
    RowBox[{"cpl", " ", "sps", " ", "stl", " ", "sts"}]}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.7812785300721407`*^9, 3.781278534136198*^9}, 
   3.7880959189979763`*^9, 3.78809869226278*^9, {3.788105230331295*^9, 
   3.788105260078184*^9}},
 CellLabel->"Out[4]=",ExpressionUUID->"d4dc8561-b15c-4205-a4cf-75b07bab7bb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"An", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"LSFn", ",", "NSFn", ",", "KSFn"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bn", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"LEQn", ",", "NEQn", ",", "KEQn"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Rn", " ", "=", " ", 
   RowBox[{
    RowBox[{"Bn", ".", 
     RowBox[{"Inverse", "[", "An", "]"}]}], "//", "Simplify"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7811059673131313`*^9, 3.781106004897963*^9}, {
  3.781278554950251*^9, 3.781278590339911*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0f5722bf-7684-4f22-ba39-c3d34524f4ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"ci", " ", "cp", " ", "cpl", " ", "stl"}], "-", 
         RowBox[{"cts", " ", "sp", " ", "spl", " ", "stl"}], "+", 
         RowBox[{"cp", " ", "cps", " ", "sts"}], "+", 
         RowBox[{"ctl", " ", "sp", " ", "sps", " ", "sts"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["cp", "2"], " ", "si"}], "+", 
         RowBox[{"si", " ", 
          SuperscriptBox["sp", "2"]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"ci", " ", "cpl", " ", "sp", " ", "stl"}], "+", 
         RowBox[{"cp", " ", "cts", " ", "spl", " ", "stl"}], "+", 
         RowBox[{"cps", " ", "sp", " ", "sts"}], "-", 
         RowBox[{"cp", " ", "ctl", " ", "sps", " ", "sts"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["cp", "2"], " ", "si"}], "+", 
         RowBox[{"si", " ", 
          SuperscriptBox["sp", "2"]}]}]]}], 
      RowBox[{"cpl", " ", "stl"}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"cpl", " ", "cts", " ", "sp", " ", "stl"}], "+", 
         RowBox[{"ci", " ", "cp", " ", "spl", " ", "stl"}], "-", 
         RowBox[{"cps", " ", "ctl", " ", "sp", " ", "sts"}], "+", 
         RowBox[{"cp", " ", "sps", " ", "sts"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["cp", "2"], " ", "si"}], "+", 
         RowBox[{"si", " ", 
          SuperscriptBox["sp", "2"]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"cp", " ", "cpl", " ", "cts", " ", "stl"}], "-", 
        RowBox[{"ci", " ", "sp", " ", "spl", " ", "stl"}], "-", 
        RowBox[{"cp", " ", "cps", " ", "ctl", " ", "sts"}], "-", 
        RowBox[{"sp", " ", "sps", " ", "sts"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["cp", "2"], " ", "si"}], "+", 
        RowBox[{"si", " ", 
         SuperscriptBox["sp", "2"]}]}]], 
      RowBox[{"spl", " ", "stl"}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"ci", " ", "cp", " ", "ctl"}], "+", 
         RowBox[{"cp", " ", "cts"}], "+", 
         RowBox[{"sp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cps", " ", "spl"}], "-", 
            RowBox[{"cpl", " ", "sps"}]}], ")"}], " ", "stl", " ", "sts"}]}], 
        
        RowBox[{"si", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["cp", "2"], "+", 
           SuperscriptBox["sp", "2"]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"ci", " ", "ctl", " ", "sp"}], "+", 
         RowBox[{"cts", " ", "sp"}], "+", 
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "cps"}], " ", "spl"}], "+", 
            RowBox[{"cpl", " ", "sps"}]}], ")"}], " ", "stl", " ", "sts"}]}], 
        
        RowBox[{"si", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["cp", "2"], "+", 
           SuperscriptBox["sp", "2"]}], ")"}]}]]}], "ctl"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.781105991883058*^9, 3.781106005257943*^9}, 
   3.781106047435445*^9, 3.78110608863894*^9, 3.781106130708468*^9, 
   3.781106672211296*^9, 3.781106911363662*^9, 3.781278257289464*^9, {
   3.781278568647154*^9, 3.781278590931203*^9}, 3.788095922812667*^9, 
   3.788098693423455*^9, {3.788105261685752*^9, 3.788105269445265*^9}},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"87217a91-85a5-4521-9234-\
09db3358a348"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"JEQ", " ", "=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Rn", ".", "JSFn"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      SuperscriptBox["cp", "2"], "+", 
      SuperscriptBox["sp", "2"]}], "->", "1"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.781105959165493*^9, 3.7811060368435507`*^9, {3.781106708763542*^9, 
   3.781106751866804*^9}, {3.781107653313102*^9, 3.78110765578085*^9}, {
   3.788095975854698*^9, 3.788095976862365*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"067b88b0-aca6-4329-b067-cfd191af8728"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["cp", "2"], " ", "cpl", " ", "Jzn", " ", "si", " ", 
          "stl"}], "-", 
         RowBox[{"ci", " ", "cpl", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cp", " ", "Jxn"}], "+", 
            RowBox[{"Jyn", " ", "sp"}]}], ")"}], " ", "stl"}], "-", 
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cts", " ", "Jyn", " ", "spl", " ", "stl"}], "+", 
            RowBox[{"cps", " ", "Jxn", " ", "sts"}], "-", 
            RowBox[{"ctl", " ", "Jyn", " ", "sps", " ", "sts"}]}], ")"}]}], 
         "+", 
         RowBox[{"sp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cpl", " ", "Jzn", " ", "si", " ", "sp", " ", "stl"}], 
            "+", 
            RowBox[{"cts", " ", "Jxn", " ", "spl", " ", "stl"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cps", " ", "Jyn"}], "+", 
               RowBox[{"ctl", " ", "Jxn", " ", "sps"}]}], ")"}], " ", 
             "sts"}]}], ")"}]}]}], "si"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["cp", "2"], " ", "Jzn", " ", "si", " ", "spl", " ", 
          "stl"}], "+", 
         RowBox[{"sp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "cpl"}], " ", "cts", " ", "Jxn", " ", "stl"}], "-", 
            
            RowBox[{"ci", " ", "Jyn", " ", "spl", " ", "stl"}], "+", 
            RowBox[{"Jzn", " ", "si", " ", "sp", " ", "spl", " ", "stl"}], 
            "+", 
            RowBox[{"cps", " ", "ctl", " ", "Jxn", " ", "sts"}], "-", 
            RowBox[{"Jyn", " ", "sps", " ", "sts"}]}], ")"}]}], "+", 
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cpl", " ", "cts", " ", "Jyn", " ", "stl"}], "-", 
            RowBox[{"ci", " ", "Jxn", " ", "spl", " ", "stl"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cps", " ", "ctl", " ", "Jyn"}], "+", 
               RowBox[{"Jxn", " ", "sps"}]}], ")"}], " ", "sts"}]}], 
           ")"}]}]}], "si"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"ctl", " ", "Jzn", " ", "si"}], "-", 
         RowBox[{"Jxn", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ci", " ", "cp", " ", "ctl"}], "+", 
            RowBox[{"cp", " ", "cts"}], "+", 
            RowBox[{"sp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cps", " ", "spl"}], "-", 
               RowBox[{"cpl", " ", "sps"}]}], ")"}], " ", "stl", " ", 
             "sts"}]}], ")"}]}], "-", 
         RowBox[{"Jyn", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ci", " ", "ctl", " ", "sp"}], "+", 
            RowBox[{"cts", " ", "sp"}], "+", 
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "cps"}], " ", "spl"}], "+", 
               RowBox[{"cpl", " ", "sps"}]}], ")"}], " ", "stl", " ", 
             "sts"}]}], ")"}]}]}], "si"]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.781105994824553*^9, 3.781106026187784*^9, 3.781106133858117*^9, 
   3.781106674427135*^9, {3.781106734568911*^9, 3.7811067523714447`*^9}, 
   3.781107656306823*^9, 3.781278259258421*^9, 3.788095927781801*^9, {
   3.788095961652054*^9, 3.788095977466769*^9}, 3.788098694827629*^9, 
   3.7881052736088037`*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"395de6a9-4feb-4356-a7b2-\
12ae3f87aed7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CForm", "[", 
   RowBox[{"JEQ", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7811076584659863`*^9, 3.781107667116766*^9}, {
  3.781108011936637*^9, 3.781108031016165*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"d4b97d94-683a-4020-8106-79f8257a64d5"],

Cell["\<\
(Power(cp,2)*cpl*Jzn*si*stl - ci*cpl*(cp*Jxn + Jyn*sp)*stl - \
cp*(cts*Jyn*spl*stl + cps*Jxn*sts - ctl*Jyn*sps*sts) + 
     sp*(cpl*Jzn*si*sp*stl + cts*Jxn*spl*stl - (cps*Jyn + \
ctl*Jxn*sps)*sts))/si\
\>", "Output",
 CellChangeTimes->{
  3.781107667473633*^9, {3.781108023766685*^9, 3.781108031356179*^9}, 
   3.781278260966112*^9, {3.7880959371028214`*^9, 3.78809597943148*^9}, 
   3.788098696364365*^9, 3.78810527474292*^9},
 CellLabel->
  "Out[13]//CForm=",ExpressionUUID->"1a58c987-ae72-4598-8536-41ab1f98843b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"JEQ", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"010deeab-0e74-4eec-b7b7-bf529df70753"],

Cell["\<\
(Power(cp,2)*Jzn*si*spl*stl + sp*(-(cpl*cts*Jxn*stl) - ci*Jyn*spl*stl + \
Jzn*si*sp*spl*stl + cps*ctl*Jxn*sts - Jyn*sps*sts) + 
     cp*(cpl*cts*Jyn*stl - ci*Jxn*spl*stl - (cps*ctl*Jyn + Jxn*sps)*sts))/si\
\>", "Output",
 CellChangeTimes->{3.7811080343855543`*^9, 3.7880959828993397`*^9, 
  3.788098697671218*^9, 3.7881052775870132`*^9},
 CellLabel->
  "Out[14]//CForm=",ExpressionUUID->"3a05ad81-f18d-46fe-baf3-7c48b8848c71"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"JEQ", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.7811080423133783`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"06ad0c1c-3598-463c-82e6-9b20c5990cdc"],

Cell["\<\
(ctl*Jzn*si - Jxn*(ci*cp*ctl + cp*cts + sp*(cps*spl - cpl*sps)*stl*sts) - \
Jyn*(ci*ctl*sp + cts*sp + cp*(-(cps*spl) + cpl*sps)*stl*sts))/si\
\>", "Output",
 CellChangeTimes->{3.781108042847458*^9, 3.7880959839028883`*^9, 
  3.788098698632041*^9, 3.788105279724709*^9},
 CellLabel->
  "Out[15]//CForm=",ExpressionUUID->"5889acc6-3478-4f0f-83f1-f6a1e3865449"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "Testing", "*)"}]], "Input",
 CellChangeTimes->{{3.781109128738907*^9, 3.7811091337018757`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"e6b9d0d9-ccd7-481a-ae5f-da8e3b1b1011"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m1", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", " ", "=", " ", 
   RowBox[{"m1", "+", "m2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", " ", "=", " ", 
   RowBox[{"m1", "*", 
    RowBox[{"m2", "/", 
     SuperscriptBox["m", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chi1sf", " ", "=", " ", ".1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chi2sf", " ", "=", " ", ".1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chip", " ", "=", " ", ".8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phip", " ", "=", " ", ".2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", " ", 
     RowBox[{"20", "*", 
      RowBox[{"(", 
       RowBox[{"m1", "+", "m2"}], ")"}], "*", "1.5*^-6", "  ", "\[Pi]"}], 
     ")"}], 
    RowBox[{"2", "/", "3"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"L", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"eta", "*", 
     RowBox[{"(", 
      RowBox[{"1.0", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1.5", "+", 
          RowBox[{"eta", "/", "6.0"}]}], ")"}], "*", "x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3.375", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"19.0", "*", "eta"}], ")"}], "/", "8."}], "-", 
          RowBox[{"eta", "*", 
           RowBox[{"eta", "/", "24.0"}]}]}], ")"}], "*", "x", "*", "x"}]}], 
      ")"}]}], ")"}], "/", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"(", "x", ")"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Jx", " ", "=", " ", 
  RowBox[{"m1", "*", "m1", "*", "chip", "*", 
   RowBox[{"Cos", "[", "phip", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Jy", " ", "=", 
  RowBox[{"m1", "*", "m1", "*", " ", "chip", "*", 
   RowBox[{"Sin", "[", "phip", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Jz", " ", "=", " ", 
  RowBox[{
   RowBox[{"m", "*", "m", "*", "L"}], " ", "+", " ", 
   RowBox[{"chi1sf", "*", "m1", "*", "m1"}], " ", "+", " ", 
   RowBox[{"chi2sf", "*", "m2", "*", "m2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jsf", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Jx", ",", "Jy", ",", "Jz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chi1eq", " ", "=", " ", 
   RowBox[{"Rn", ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "chi1sf"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chi2eq", " ", "=", " ", 
   RowBox[{"Rn", ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "chi2sf"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chipeq", " ", "=", " ", 
   RowBox[{
    RowBox[{"Rn", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"chip", " ", "*", " ", 
        RowBox[{"Cos", "[", "phip", "]"}]}], ",", 
       RowBox[{"chip", " ", "*", " ", 
        RowBox[{"Sin", "[", "phip", "]"}]}], ",", "0"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Leq", " ", "=", " ", 
   RowBox[{"Rn", ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "L"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jeq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"chi1eq", "*", "m1", "*", "m1"}], "+", 
     RowBox[{"chi2eq", "*", "m2", "*", "m2"}], "+", 
     RowBox[{"chipeq", "*", "m1", "*", "m1"}], "+", 
     RowBox[{"Leq", "*", "m", "*", "m"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jeqrot", " ", "=", " ", 
   RowBox[{
    RowBox[{"Rn", ".", "Jsf"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Leq", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"stl", " ", "cpl"}], ",", " ", 
     RowBox[{"stl", " ", "spl"}], ",", " ", "ctl"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jeqrot", ".", "Leq"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.781109136258144*^9, 3.781109185903572*^9}, {
  3.781109304868731*^9, 3.78110958427782*^9}, {3.781109622219849*^9, 
  3.781109722797708*^9}, {3.7811097544221373`*^9, 3.781109828953433*^9}, {
  3.78110994940306*^9, 3.781109975211081*^9}, {3.781278497118805*^9, 
  3.781278498515525*^9}, {3.781280630446146*^9, 3.781280684556259*^9}, {
  3.781281189684248*^9, 3.781281223711514*^9}, {3.781281272508555*^9, 
  3.781281387340845*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"d3f53929-f3f3-4e01-ac68-3e64545a1bb5"],

Cell[BoxData["2.715885542743934`"], "Output",
 CellChangeTimes->{
  3.781278498903536*^9, {3.781280631731529*^9, 3.781280685620137*^9}, {
   3.781281204731865*^9, 3.7812812240121193`*^9}, {3.781281273382279*^9, 
   3.7812813073305817`*^9}, {3.781281339182579*^9, 3.781281389968876*^9}, 
   3.788096020852972*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"ca831b28-9cbf-43e1-a384-434a7cf45dc5"],

Cell[BoxData["12.544852196367893`"], "Output",
 CellChangeTimes->{
  3.781278498903536*^9, {3.781280631731529*^9, 3.781280685620137*^9}, {
   3.781281204731865*^9, 3.7812812240121193`*^9}, {3.781281273382279*^9, 
   3.7812813073305817`*^9}, {3.781281339182579*^9, 3.781281389968876*^9}, 
   3.788096020854385*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"b839cdfc-b01f-4828-abd8-8c5148c1cd00"],

Cell[BoxData["2.542967434176784`"], "Output",
 CellChangeTimes->{
  3.781278498903536*^9, {3.781280631731529*^9, 3.781280685620137*^9}, {
   3.781281204731865*^9, 3.7812812240121193`*^9}, {3.781281273382279*^9, 
   3.7812813073305817`*^9}, {3.781281339182579*^9, 3.781281389968876*^9}, 
   3.788096020855669*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"5299ac7e-4aa8-4f94-9600-05c0a3431b2a"],

Cell[BoxData["99.77187953878162`"], "Output",
 CellChangeTimes->{
  3.781278498903536*^9, {3.781280631731529*^9, 3.781280685620137*^9}, {
   3.781281204731865*^9, 3.7812812240121193`*^9}, {3.781281273382279*^9, 
   3.7812813073305817`*^9}, {3.781281339182579*^9, 3.781281389968876*^9}, 
   3.788096020857057*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"ce78258f-7614-409b-9203-aedd2ec57d8f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"si", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["cp", "2"], "+", 
      SuperscriptBox["sp", "2"]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"2.542967434176784`", " ", "ctl", " ", "cts", " ", "sp"}], "+", 
    RowBox[{"99.77187953878162`", " ", 
     SuperscriptBox["ctl", "2"], " ", "si", " ", 
     SuperscriptBox["sp", "2"]}], "+", 
    RowBox[{"99.77187953878162`", " ", 
     SuperscriptBox["cpl", "2"], " ", "si", " ", 
     SuperscriptBox["sp", "2"], " ", 
     SuperscriptBox["stl", "2"]}], "+", 
    RowBox[{"99.77187953878162`", " ", "si", " ", 
     SuperscriptBox["sp", "2"], " ", 
     SuperscriptBox["spl", "2"], " ", 
     SuperscriptBox["stl", "2"]}], "+", 
    RowBox[{"ci", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "12.54485219636789`"}], " ", "cp", " ", 
        SuperscriptBox["ctl", "2"]}], "-", 
       RowBox[{"2.542967434176784`", " ", 
        SuperscriptBox["ctl", "2"], " ", "sp"}], "+", 
       RowBox[{"cp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "12.544852196367893`"}], " ", 
           SuperscriptBox["cpl", "2"]}], "-", 
          RowBox[{"12.544852196367893`", " ", 
           SuperscriptBox["spl", "2"]}]}], ")"}], " ", 
        SuperscriptBox["stl", "2"]}], "+", 
       RowBox[{"sp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2.542967434176784`"}], " ", 
           SuperscriptBox["cpl", "2"]}], "-", 
          RowBox[{"2.542967434176784`", " ", 
           SuperscriptBox["spl", "2"]}]}], ")"}], " ", 
        SuperscriptBox["stl", "2"]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["cp", "2"], " ", "si", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"99.77187953878162`", " ", 
        SuperscriptBox["ctl", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"99.77187953878162`", " ", 
           SuperscriptBox["cpl", "2"]}], "+", 
          RowBox[{"99.77187953878162`", " ", 
           SuperscriptBox["spl", "2"]}]}], ")"}], " ", 
        SuperscriptBox["stl", "2"]}]}], ")"}]}], "+", 
    RowBox[{
    "2.542967434176784`", " ", "cpl", " ", "cps", " ", "sp", " ", "stl", " ", 
     "sts"}], "-", 
    RowBox[{
    "3.552713678800501`*^-15", " ", "cps", " ", "ctl", " ", "sp", " ", "spl", 
     " ", "stl", " ", "sts"}], "+", 
    RowBox[{
    "3.552713678800501`*^-15", " ", "cpl", " ", "ctl", " ", "sp", " ", "sps", 
     " ", "stl", " ", "sts"}], "+", 
    RowBox[{
    "2.542967434176784`", " ", "sp", " ", "spl", " ", "sps", " ", "stl", " ", 
     "sts"}], "+", 
    RowBox[{"cp", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12.54485219636789`", " ", "ctl", " ", "cts"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"12.544852196367893`", " ", "cpl", " ", "cps"}], "+", 
          RowBox[{"12.544852196367893`", " ", "spl", " ", "sps"}]}], ")"}], 
        " ", "stl", " ", "sts"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.781278498903536*^9, {3.781280631731529*^9, 3.781280685620137*^9}, {
   3.781281204731865*^9, 3.7812812240121193`*^9}, {3.781281273382279*^9, 
   3.7812813073305817`*^9}, {3.781281339182579*^9, 3.781281389968876*^9}, 
   3.788096020939588*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"611d174d-70f4-403f-9e29-74d5ff4a27c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Self", " ", "consistent", " ", "at", " ", "least"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Jeq", " ", "-", " ", "Jeqrot"}], "//", "FullSimplify"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.781109830972456*^9, 3.78110983778022*^9}, {
  3.781109873177103*^9, 3.781109907519232*^9}, {3.7811100180948477`*^9, 
  3.7811100297848186`*^9}, {3.781280610429783*^9, 3.7812806119466257`*^9}, {
  3.781281245010306*^9, 3.781281254575288*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"30f4164b-ea10-41f6-bc79-5a78b29c6be5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.`"},
      {
       FractionBox[
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{
         "1.7763568394002505`*^-15", " ", "cpl", " ", "cts", " ", "sp", " ", 
          "stl"}], "+", 
         RowBox[{
         "1.7763568394002505`*^-15", " ", "cps", " ", "ctl", " ", "sp", " ", 
          "sts"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["cp", "2"], " ", "si"}], "+", 
         RowBox[{"si", " ", 
          SuperscriptBox["sp", "2"]}]}]]},
      {"0.`"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7811098345375*^9, 3.781109838065585*^9}, {
   3.781109874870735*^9, 3.781109908383047*^9}, 3.781109978510088*^9, 
   3.781110030957089*^9, 3.781278270236408*^9, 3.7812806123875837`*^9, 
   3.7812812551546707`*^9, 3.7880960297515*^9},
 CellLabel->
  "Out[52]//MatrixForm=",ExpressionUUID->"5f1344d3-e7bb-419a-aa8b-\
ce9bb87e9bef"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Equatorial", " ", "to", " ", 
   RowBox[{"Ecliptic", " ", "--"}], " ", "Rotation", " ", "about", " ", "x", 
   " ", "by", " ", "axial_tilt"}], "*)"}]], "Input",
 CellChangeTimes->{{3.78113499851547*^9, 3.781135013205414*^9}, {
  3.781135212394558*^9, 3.7811352208598213`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ccb0e3a0-cea9-420e-9cc8-62308e3768d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eclvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "thetaecl", "]"}], 
       RowBox[{"Cos", "[", "phiecl", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "thetaecl", "]"}], 
       RowBox[{"Cos", "[", "phiecl", "]"}]}], ",", 
      RowBox[{"Cos", "[", "thetaecl", "]"}]}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eclvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "thetaeq", "]"}], 
       RowBox[{"Cos", "[", "phieq", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "thetaeq", "]"}], 
       RowBox[{"Cos", "[", "phieq", "]"}]}], ",", 
      RowBox[{"Cos", "[", "thetaeq", "]"}]}], "}"}]}], ";"}], " "}]}], "Input",\

 CellChangeTimes->{{3.7811350210113564`*^9, 3.7811350256089487`*^9}, {
  3.781135224368712*^9, 3.781135309669744*^9}, {3.7811355441473503`*^9, 
  3.7811355581175203`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"f450a287-a08d-46c1-a321-dd1097312c18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"roteq", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "TILT", "]"}], ",", 
         RowBox[{"Sin", "[", "TILT", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "TILT", "]"}]}], ",", 
         RowBox[{"Cos", "[", "TILT", "]"}]}], "}"}]}], "}"}], ".", "eqvec"}], 
    "/.", 
    RowBox[{"TILT", "\[Rule]", 
     RowBox[{"23.44", 
      RowBox[{"\[Pi]", "/", "180"}]}]}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.781135320572584*^9, 3.781135416090564*^9}, {
  3.781136011103201*^9, 3.7811360140694*^9}, {3.7811360605847797`*^9, 
  3.781136063104354*^9}, {3.781136101384117*^9, 3.781136103009268*^9}, {
  3.7811375086329193`*^9, 3.781137511638556*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ded753fb-c821-429d-a246-0bfede0442b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "phieq", "]"}], " ", 
    RowBox[{"Sin", "[", "thetaeq", "]"}]}], ",", 
   RowBox[{
    RowBox[{"0.39778850739794974`", " ", 
     RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
    RowBox[{"0.9174771405229186`", " ", 
     RowBox[{"Cos", "[", "phieq", "]"}], " ", 
     RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"0.9174771405229186`", " ", 
     RowBox[{"Cos", "[", "thetaeq", "]"}]}], "-", 
    RowBox[{"0.39778850739794974`", " ", 
     RowBox[{"Cos", "[", "phieq", "]"}], " ", 
     RowBox[{"Sin", "[", "thetaeq", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7811354000707617`*^9, 3.781135416664362*^9}, 
   3.7811359760518103`*^9, 3.7811360145233*^9, {3.781136063395797*^9, 
   3.781136070859809*^9}, {3.781136103240994*^9, 3.7811361090110826`*^9}, {
   3.781137512135572*^9, 3.781137516983015*^9}},
 CellLabel->"Out[5]=",ExpressionUUID->"8bb8e114-490d-4f3f-aca7-6c908357cdae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"eclvec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
     RowBox[{"roteq", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"eclvec", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"roteq", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ".", 
      RowBox[{"eclvec", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "\[Equal]", 
     RowBox[{"roteq", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.781135423921605*^9, 3.781135456549202*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"cca1ee52-e001-4637-ab53-b8077a49e06d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.39778850739794974`"}], " ", 
      RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
     RowBox[{"0.9174771405229186`", " ", 
      RowBox[{"Cos", "[", "phieq", "]"}], " ", 
      RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.39778850739794974`"}], " ", 
        RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
       RowBox[{"0.9174771405229186`", " ", 
        RowBox[{"Cos", "[", "phieq", "]"}], " ", 
        RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.9174771405229186`", " ", 
        RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
       RowBox[{"0.39778850739794974`", " ", 
        RowBox[{"Cos", "[", "phieq", "]"}], " ", 
        RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], ")"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"0.9174771405229186`", " ", 
      RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
     RowBox[{"0.39778850739794974`", " ", 
      RowBox[{"Cos", "[", "phieq", "]"}], " ", 
      RowBox[{"Sin", "[", "thetaeq", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7811354569443007`*^9, 3.781135572909766*^9, 
  3.781135977181671*^9, 3.781136016760425*^9, 3.781136072332973*^9, 
  3.781136110189639*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"28d0f907-a3a0-4bcb-92f3-fcb81d7de492"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.781136016702002*^9, 
  3.781136017696813*^9}},ExpressionUUID->"c33f7b1e-c43d-4f1a-a5fc-\
72b5efe5ae4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"roteq", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", " ", "=", " ", 
   RowBox[{"roteq", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", " ", "=", " ", 
   RowBox[{"roteq", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.781135631953964*^9, 3.7811356568182*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"ded509b9-619e-49ff-851f-6b7b5cdea695"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"phiecl", " ", "=", " ", 
  RowBox[{"ArcTan", "[", 
   RowBox[{"y", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"thetaecl", " ", "=", " ", 
  RowBox[{"ArcTan", "[", 
   FractionBox[
    SqrtBox[
     RowBox[{
      RowBox[{"x", "*", "x"}], " ", "+", " ", 
      RowBox[{"y", " ", "y"}]}]], "z"], "]"}]}]}], "Input",
 CellChangeTimes->{{3.781135659398039*^9, 3.781135726776105*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"3c5d44c9-9697-4c94-87a5-fb24f5997cef"],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"0.39778850739794974`", " ", 
     RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
    RowBox[{"0.9174771405229186`", " ", 
     RowBox[{"Cos", "[", "phieq", "]"}], " ", 
     RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "phieq", "]"}], " ", 
    RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.781135677456094*^9, 3.781135727011395*^9, 
  3.781135981631145*^9, 3.781136021157117*^9, 3.78113607621247*^9, 
  3.7811361180084*^9, 3.781137521905912*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"4e613e4f-a920-4d65-847b-047d0df4f6bf"],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "phieq", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "thetaeq", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"0.39778850739794974`", " ", 
         RowBox[{"Cos", "[", "thetaeq", "]"}]}], "+", 
        RowBox[{"0.9174771405229186`", " ", 
         RowBox[{"Cos", "[", "phieq", "]"}], " ", 
         RowBox[{"Sin", "[", "thetaeq", "]"}]}]}], ")"}], "2"]}]], 
   RowBox[{
    RowBox[{"0.9174771405229186`", " ", 
     RowBox[{"Cos", "[", "thetaeq", "]"}]}], "-", 
    RowBox[{"0.39778850739794974`", " ", 
     RowBox[{"Cos", "[", "phieq", "]"}], " ", 
     RowBox[{"Sin", "[", "thetaeq", "]"}]}]}]], "]"}]], "Output",
 CellChangeTimes->{3.781135677456094*^9, 3.781135727011395*^9, 
  3.781135981631145*^9, 3.781136021157117*^9, 3.78113607621247*^9, 
  3.7811361180084*^9, 3.7811375219073067`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"7fe9d8bc-94ae-498e-87b5-267f13b46e0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", "phiecl", ")"}], ",", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[Pi]", "2"], "-", "thetaecl"}], ")"}]}], "}"}], "/.", 
   RowBox[{"thetaeq", "\[Rule]", 
    RowBox[{
     FractionBox["\[Pi]", "2"], "-", 
     RowBox[{"23.44", 
      RowBox[{"\[Pi]", "/", "180"}]}]}]}]}], " ", "/.", 
  RowBox[{"phieq", "\[Rule]", " ", 
   RowBox[{"60", 
    RowBox[{"\[Pi]", "/", "180"}]}]}]}]], "Input",
 CellChangeTimes->{{3.781135731454032*^9, 3.781135780707374*^9}, {
  3.781135837601952*^9, 3.781135891216563*^9}, {3.781135958583159*^9, 
  3.7811359598951063`*^9}, {3.7811362553372793`*^9, 3.781136274210265*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"db5d42a7-22e2-425a-a485-0244aa4a764f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6699257733591708`", ",", "0.24215120963115533`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.781135760914987*^9, 3.78113578097876*^9}, 
   3.781135860408991*^9, 3.781135891667877*^9, {3.781135961103891*^9, 
   3.781135982719535*^9}, 3.781136021911162*^9, 3.781136076946292*^9, 
   3.7811361188137836`*^9, {3.7811362568330917`*^9, 3.781136280093463*^9}, 
   3.781137525082631*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"341af3a3-97cd-43d0-8920-41ed167acc0f"]
}, Open  ]]
},
WindowSize->{1203, 751},
WindowMargins->{{Automatic, 1}, {Automatic, 98}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 282, 6, 30, "Input",ExpressionUUID->"31660c16-dd4f-4ea4-a526-bc4ea355f86c"],
Cell[843, 28, 283, 6, 30, "Input",ExpressionUUID->"860a80c4-9cb0-4920-9eb0-6b74a4ab1462"],
Cell[CellGroupData[{
Cell[1151, 38, 358, 8, 30, "Input",ExpressionUUID->"1925ba79-01d9-4699-b9d4-e9824ff34d75"],
Cell[1512, 48, 2282, 62, 56, "Output",ExpressionUUID->"d3c7b4c1-6840-4c34-9bac-8e8845cfa23e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3831, 115, 836, 23, 30, "Input",ExpressionUUID->"e1bc3493-3e6d-400d-8385-04851e5f258f"],
Cell[4670, 140, 2226, 61, 56, "Output",ExpressionUUID->"9a5b2795-7130-45b4-884b-b79b50cfb81e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6933, 206, 383, 8, 73, "Input",ExpressionUUID->"a8b19609-7c7f-466a-a1c4-ad459609824b"],
Cell[7319, 216, 907, 25, 34, "Output",ExpressionUUID->"613aae73-11bb-4d92-b66b-88003b7b4926"],
Cell[8229, 243, 898, 24, 34, "Output",ExpressionUUID->"7abdebc9-3fe2-4639-afde-e1b435333654"],
Cell[9130, 269, 532, 13, 34, "Output",ExpressionUUID->"1cf139f8-0a68-4569-9555-a291e1b9b7bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9699, 287, 310, 7, 30, "Input",ExpressionUUID->"b87713bb-4945-432a-8c3a-fd421941372e"],
Cell[10012, 296, 241, 4, 34, "Output",ExpressionUUID->"30fcba38-fb68-494a-844a-c1e8337dbab6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10290, 305, 348, 8, 30, "Input",ExpressionUUID->"2ce72a15-5721-475c-b325-c1bc93fe9c67"],
Cell[10641, 315, 2433, 67, 80, "Output",ExpressionUUID->"eb1cb781-f700-48ec-8c7f-4a5e154d27de"]
}, Open  ]],
Cell[13089, 385, 943, 25, 52, "Input",ExpressionUUID->"16a6fd0d-90a4-4bd6-8bce-23e5e8ebaf85"],
Cell[CellGroupData[{
Cell[14057, 414, 299, 6, 30, "Input",ExpressionUUID->"105226b0-21eb-4ec6-a2b5-d1ab29e089a6"],
Cell[14359, 422, 1159, 29, 56, "Output",ExpressionUUID->"a0b6ad2a-23f6-4da0-abda-bae8cd994d54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15555, 456, 273, 6, 32, "Input",ExpressionUUID->"139d80a4-0826-4632-8c77-930d4dfb57f9"],
Cell[15831, 464, 1143, 31, 37, "Output",ExpressionUUID->"3baa6f4e-4252-4270-886c-c8b233639256"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17011, 500, 263, 5, 30, "Input",ExpressionUUID->"9e119791-74dd-44e9-9ce5-64cd888a76ae"],
Cell[17277, 507, 487, 11, 34, "Output",ExpressionUUID->"c9b494ab-ac2f-4360-8fb6-5e3218fc4e67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17801, 523, 880, 27, 30, "Input",ExpressionUUID->"020e207f-456c-49d3-82b5-4e00f6890ea1"],
Cell[18684, 552, 2325, 60, 77, "Output",ExpressionUUID->"48d0c837-5fdd-4531-aa3e-537b8d3c16bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21046, 617, 551, 13, 49, "Input",ExpressionUUID->"adc7f257-f4ad-43d4-9032-f6f599e5613a"],
Cell[21600, 632, 23664, 591, 667, "Output",ExpressionUUID->"470d857e-a87c-48ec-a97b-b1794bc2d176"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45301, 1228, 576, 13, 30, "Input",ExpressionUUID->"b4a9aa3a-d2c5-4797-a52c-2ca1e25aa4dc"],
Cell[45880, 1243, 577, 14, 34, "Output",ExpressionUUID->"feafd0b8-6047-4889-a56a-89ddca5341fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46494, 1262, 1473, 36, 33, "Input",ExpressionUUID->"cfc595a3-6292-4cc7-8c88-907cfa15269e"],
Cell[47970, 1300, 1578, 42, 37, "Output",ExpressionUUID->"c1333d34-083f-41cf-8d0c-9013bbb2c0e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49585, 1347, 2875, 80, 110, "Input",ExpressionUUID->"dab0e8ec-5376-40ea-aecb-67446a4cd23c"],
Cell[52463, 1429, 7707, 149, 231, "Output",ExpressionUUID->"141e31cd-cf9b-4891-9143-38831c6f7e26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60207, 1583, 1384, 40, 69, "Input",ExpressionUUID->"601eff53-86f1-4ecb-9ba0-ea42c6b950ac"],
Cell[61594, 1625, 208, 3, 34, "Output",ExpressionUUID->"b7dcb35d-2006-4afd-a075-b0afa3438770"]
}, Open  ]],
Cell[61817, 1631, 642, 16, 52, "Input",ExpressionUUID->"0bd78d57-53aa-4ddf-abc9-869d34f0758f"],
Cell[CellGroupData[{
Cell[62484, 1651, 308, 7, 30, "Input",ExpressionUUID->"f928693b-d8bd-458c-adf7-e7b3147f5e34"],
Cell[62795, 1660, 894, 26, 34, "Output",ExpressionUUID->"f9999b3a-1b5e-401a-84ca-e6cdda1f114f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63726, 1691, 825, 22, 33, "Input",ExpressionUUID->"dc2c78b8-2a5b-4b1e-96c6-09742d5895e9"],
Cell[64554, 1715, 26491, 692, 799, "Output",ExpressionUUID->"013eb680-fbdf-4c56-91dc-489cc7af9edc"]
}, Open  ]],
Cell[91060, 2410, 2066, 61, 157, "Input",ExpressionUUID->"e0e12403-e056-4067-b967-fcdfaee4df8e"],
Cell[93129, 2473, 567, 15, 52, "Input",ExpressionUUID->"1384a3e3-2fb3-497f-a0e2-58f8e3599d5e"],
Cell[CellGroupData[{
Cell[93721, 2492, 389, 9, 30, "Input",ExpressionUUID->"06e8f24f-c4cf-46d6-aed0-69f6d390bc54"],
Cell[94113, 2503, 6824, 169, 80, "Output",ExpressionUUID->"31a22543-7dd3-4a4c-9ba5-476956012090"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100974, 2677, 414, 7, 30, "Input",ExpressionUUID->"e4b144d9-a9d6-4478-9256-410330706c80"],
Cell[101391, 2686, 6229, 155, 80, "Output",ExpressionUUID->"38520dec-5815-4343-bbdd-b0b103edc2db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107657, 2846, 2284, 59, 199, "Input",ExpressionUUID->"8afdcbab-31ee-4131-b433-03db65d9afd5"],
Cell[109944, 2907, 400, 9, 34, "Output",ExpressionUUID->"03fa5e93-6ea3-4c31-af07-4fadbb1dee2c"],
Cell[110347, 2918, 693, 17, 34, "Output",ExpressionUUID->"d4dc8561-b15c-4205-a4cf-75b07bab7bb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111077, 2940, 771, 21, 73, "Input",ExpressionUUID->"0f5722bf-7684-4f22-ba39-c3d34524f4ff"],
Cell[111851, 2963, 3943, 106, 120, "Output",ExpressionUUID->"87217a91-85a5-4521-9234-09db3358a348"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115831, 3074, 593, 14, 33, "Input",ExpressionUUID->"067b88b0-aca6-4329-b067-cfd191af8728"],
Cell[116427, 3090, 4137, 109, 112, "Output",ExpressionUUID->"395de6a9-4feb-4356-a7b2-12ae3f87aed7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120601, 3204, 346, 7, 52, "Input",ExpressionUUID->"d4b97d94-683a-4020-8106-79f8257a64d5"],
Cell[120950, 3213, 526, 11, 63, "Output",ExpressionUUID->"1a58c987-ae72-4598-8536-41ab1f98843b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121513, 3229, 191, 4, 30, "Input",ExpressionUUID->"010deeab-0e74-4eec-b7b7-bf529df70753"],
Cell[121707, 3235, 436, 8, 63, "Output",ExpressionUUID->"3a05ad81-f18d-46fe-baf3-7c48b8848c71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122180, 3248, 235, 5, 30, "Input",ExpressionUUID->"06ad0c1c-3598-463c-82e6-9b20c5990cdc"],
Cell[122418, 3255, 368, 7, 45, "Output",ExpressionUUID->"5889acc6-3478-4f0f-83f1-f6a1e3865449"]
}, Open  ]],
Cell[122801, 3265, 208, 4, 30, "Input",ExpressionUUID->"e6b9d0d9-ccd7-481a-ae5f-da8e3b1b1011"],
Cell[CellGroupData[{
Cell[123034, 3273, 4561, 126, 473, "Input",ExpressionUUID->"d3f53929-f3f3-4e01-ac68-3e64545a1bb5"],
Cell[127598, 3401, 391, 6, 34, "Output",ExpressionUUID->"ca831b28-9cbf-43e1-a384-434a7cf45dc5"],
Cell[127992, 3409, 392, 6, 34, "Output",ExpressionUUID->"b839cdfc-b01f-4828-abd8-8c5148c1cd00"],
Cell[128387, 3417, 391, 6, 34, "Output",ExpressionUUID->"5299ac7e-4aa8-4f94-9600-05c0a3431b2a"],
Cell[128781, 3425, 391, 6, 34, "Output",ExpressionUUID->"ce78258f-7614-409b-9203-aedd2ec57d8f"],
Cell[129175, 3433, 3462, 89, 128, "Output",ExpressionUUID->"611d174d-70f4-403f-9e29-74d5ff4a27c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132674, 3527, 614, 13, 52, "Input",ExpressionUUID->"30f4164b-ea10-41f6-bc79-5a78b29c6be5"],
Cell[133291, 3542, 1357, 38, 92, "Output",ExpressionUUID->"5f1344d3-e7bb-419a-aa8b-ce9bb87e9bef"]
}, Open  ]],
Cell[134663, 3583, 395, 7, 30, "Input",ExpressionUUID->"ccb0e3a0-cea9-420e-9cc8-62308e3768d6"],
Cell[135061, 3592, 1240, 36, 73, "Input",ExpressionUUID->"f450a287-a08d-46c1-a321-dd1097312c18"],
Cell[CellGroupData[{
Cell[136326, 3632, 1039, 26, 30, "Input",ExpressionUUID->"ded753fb-c821-429d-a246-0bfede0442b8"],
Cell[137368, 3660, 995, 22, 34, "Output",ExpressionUUID->"8bb8e114-490d-4f3f-aca7-6c908357cdae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138400, 3687, 744, 20, 30, "Input",ExpressionUUID->"cca1ee52-e001-4637-ab53-b8077a49e06d"],
Cell[139147, 3709, 1478, 36, 77, "Output",ExpressionUUID->"28d0f907-a3a0-4bcb-92f3-fcb81d7de492"]
}, Open  ]],
Cell[140640, 3748, 152, 3, 30, "Input",ExpressionUUID->"c33f7b1e-c43d-4f1a-a5fc-72b5efe5ae4b"],
Cell[140795, 3753, 551, 14, 73, "Input",ExpressionUUID->"ded509b9-619e-49ff-851f-6b7b5cdea695"],
Cell[CellGroupData[{
Cell[141371, 3771, 493, 12, 73, "Input",ExpressionUUID->"3c5d44c9-9697-4c94-87a5-fb24f5997cef"],
Cell[141867, 3785, 672, 15, 34, "Output",ExpressionUUID->"4e613e4f-a920-4d65-847b-047d0df4f6bf"],
Cell[142542, 3802, 1089, 27, 62, "Output",ExpressionUUID->"7fe9d8bc-94ae-498e-87b5-267f13b46e0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143668, 3834, 778, 20, 43, "Input",ExpressionUUID->"db5d42a7-22e2-425a-a485-0244aa4a764f"],
Cell[144449, 3856, 501, 9, 34, "Output",ExpressionUUID->"341af3a3-97cd-43d0-8920-41ed167acc0f"]
}, Open  ]]
}
]
*)

