(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45113,       1122]
NotebookOptionsPosition[     38828,       1003]
NotebookOutlinePosition[     39168,       1018]
CellTagsIndexPosition[     39125,       1015]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Explicitly calculate polarization angle \[Psi] for a detector at the center \
of Earth in the equatorial coordinate system (\[Psi] is independent of time, \
but \[Phi] does depend on the rotation of Earth)\
\>", "Chapter",
 CellChangeTimes->{{3.781003385525128*^9, 
  3.781003451965478*^9}},ExpressionUUID->"62ca31fa-be6c-439b-88ce-\
8ff72489cf28"],

Cell[CellGroupData[{

Cell["\<\
\[Theta]s, \[Phi]s describe the location of the source in spherical polar \
coordinates in the equatorial system (\[Theta]s = \[Pi]/2 - \[Delta] and \
\[Phi]s = \[Alpha])
\[Theta]j, \[Phi]j describe the orientation of the binary in spherical polar \
coordinates in the equatorial coordinate system\
\>", "Section",
 CellChangeTimes->{{3.78100348145224*^9, 
  3.781003575452856*^9}},ExpressionUUID->"d1c93c6b-4e00-4eb2-aaed-\
59a9e235309e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]s", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]s", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Location", " ", "to", " ", 
    RowBox[{"source", " ", "--"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Nvec"}], " ", "is", " ", "the", " ", "direction", " ", 
      "of", " ", "propagation"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Zvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "Vector", " ", "orthogonal", " ", "to", " ", "detector", " ", "plane", " ",
     "for", " ", "detector", " ", "at", " ", "the", " ", "center", " ", "of", 
    " ", "earth"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Jvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]j", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]j", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "Unit", " ", "vector", " ", "of", " ", "the", " ", "total", " ", "angular",
     " ", "momentum", " ", "of", " ", "the", " ", "source", " ", "in", " ", 
    "equatorial", " ", "coordinates"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.781002514009783*^9, 3.781002708259411*^9}, {
  3.78100273891555*^9, 3.78100274313264*^9}, {3.7810028627070723`*^9, 
  3.781002873827814*^9}, {3.781003157548829*^9, 3.781003170473493*^9}, {
  3.781003246563079*^9, 3.781003252914217*^9}, {3.781003364680688*^9, 
  3.7810033792880697`*^9}, {3.788032877874857*^9, 3.788032930535829*^9}, {
  3.788113529794736*^9, 3.7881135362153482`*^9}, {3.788113594562807*^9, 
  3.788113600303267*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"0827f807-305c-4fd6-8008-ce37fc55f182"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Psi]", " ", "=", " ", 
  RowBox[{
   RowBox[{"ArcTan", "[", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Jvec", ".", "Zvec"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Jvec", ".", "Nvec"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Zvec", ".", "Nvec"}], ")"}]}]}], ")"}], 
     RowBox[{"Nvec", ".", 
      RowBox[{"(", 
       RowBox[{"Cross", "[", 
        RowBox[{"Jvec", ",", "Zvec"}], "]"}], ")"}]}]], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.781002782954784*^9, 3.781002797397287*^9}, {
   3.781002933452324*^9, 3.781003014434353*^9}, {3.78100326435557*^9, 
   3.781003265356716*^9}, {3.7880323916617517`*^9, 3.788032405948954*^9}, 
   3.788032938641451*^9, {3.788032970355054*^9, 3.788032971231933*^9}, 
   3.788033083355894*^9, 3.788039058938764*^9, 3.7881099309898043`*^9, 
   3.788109971926693*^9, {3.7881117666211977`*^9, 3.788111767215392*^9}, {
   3.788115675857719*^9, 3.788115675989826*^9}, {3.7881158100091553`*^9, 
   3.788115814537261*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"0fca73d0-a3e5-4afe-90ba-9e561dd14f60"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
     RowBox[{"Cot", "[", 
      RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cot", "[", "\[Theta]j", "]"}], " ", 
     RowBox[{"Csc", "[", 
      RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]s", "]"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.7810030150208693`*^9, 3.781003172658382*^9, {3.7810032543176117`*^9, 
   3.781003265708749*^9}, 3.7810035881222477`*^9, 3.781457216744123*^9, 
   3.7880319130113277`*^9, {3.788032392082656*^9, 3.788032406280487*^9}, {
   3.788032881848568*^9, 3.788032938995673*^9}, 3.788032971500086*^9, 
   3.788033083771549*^9, 3.788039059396125*^9, 3.788109720671932*^9, 
   3.78810993151927*^9, 3.788109972668109*^9, 3.7881108511684732`*^9, 
   3.788111417431443*^9, 3.788111768141965*^9, 3.788112033810733*^9, 
   3.788113538625517*^9, 3.788113602209874*^9, 3.788114296062449*^9, 
   3.788115676320426*^9, 3.7881158152024527`*^9, 3.7881175132930737`*^9, 
   3.7881175530586233`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"34a36cb2-b7b8-458f-913d-533774aeb801"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "/.", 
    RowBox[{"\[Theta]s", "\[Rule]", 
     RowBox[{
      FractionBox["\[Pi]", "2"], "-", "DEC"}]}]}], "/.", 
   RowBox[{"\[Phi]s", "\[Rule]", " ", "RA"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.781003271504383*^9, 3.781003329364181*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"c82f3199-cae1-4187-a34d-8e2a269ae444"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "DEC", "]"}], " ", 
     RowBox[{"Cot", "[", "\[Theta]j", "]"}], " ", 
     RowBox[{"Csc", "[", 
      RowBox[{"RA", "-", "\[Phi]j"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cot", "[", 
      RowBox[{"RA", "-", "\[Phi]j"}], "]"}], " ", 
     RowBox[{"Sin", "[", "DEC", "]"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.781003303314293*^9, 3.781003329727716*^9}, 
   3.781003457559598*^9, 3.781003588179398*^9, 3.7814572183162203`*^9, 
   3.788031926700748*^9, {3.7880328849765263`*^9, 3.788032910760109*^9}, 
   3.7880390620474253`*^9, 3.788112746627264*^9, 3.788115817039221*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"a596f127-78d8-4a33-9bb8-42eaabab6799"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Psi]", "/.", 
       RowBox[{"\[Theta]s", "\[Rule]", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "-", "DEC"}]}]}], "/.", 
      RowBox[{"\[Phi]s", "\[Rule]", " ", "RA"}]}], "/.", 
     RowBox[{"\[Theta]j", "\[Rule]", "thetaj"}]}], "/.", 
    RowBox[{"\[Phi]j", "\[Rule]", "phij"}]}], "//", "Simplify"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7810034774578667`*^9, 3.781003478542425*^9}, {
  3.781003893086302*^9, 3.781003936041815*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"8190c91c-791c-479b-9752-7650a5fc6632"],

Cell["\<\
ArcTan(Cos(DEC)*Cot(thetaj)*Csc(phij - RA) - Cot(phij - RA)*Sin(DEC))\
\>", "Output",
 CellChangeTimes->{{3.781003911713273*^9, 3.781003936757949*^9}, 
   3.781457219007601*^9, 3.788031927760244*^9, {3.7880328859979153`*^9, 
   3.7880329116659307`*^9}, 3.788039065543323*^9, {3.788112744586142*^9, 
   3.7881127485360823`*^9}, 3.788115818043892*^9},
 CellLabel->
  "Out[107]//CForm=",ExpressionUUID->"cab6e633-6429-4111-b95f-f1176afecdd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Iota]", " ", "=", " ", 
  RowBox[{"ArcCos", "[", 
   RowBox[{"Jvec", ".", 
    RowBox[{"-", "Nvec"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.781004259221904*^9, 3.781004269832234*^9}, {
   3.781004330123331*^9, 3.7810043364731092`*^9}, 3.7814572115086803`*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"7ff145ea-1341-4cba-9031-891988cfc969"],

Cell[BoxData[
 RowBox[{"ArcCos", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], " ", 
    RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "-", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Phi]j", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]s", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]s", "]"}]}], "-", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]j", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7810042710909*^9, 3.781004336834957*^9, {3.781457212389399*^9, 
   3.781457219940715*^9}, 3.7880319286372423`*^9, {3.788032886763709*^9, 
   3.788032912433093*^9}, 3.788111701084002*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"53323996-9f81-4919-8c20-5498aa5f89ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Iota]", "/.", 
       RowBox[{"\[Theta]s", "\[Rule]", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "-", "DEC"}]}]}], "/.", 
      RowBox[{"\[Phi]s", "\[Rule]", " ", "RA"}]}], "/.", 
     RowBox[{"\[Theta]j", "\[Rule]", "thetaj"}]}], "/.", 
    RowBox[{"\[Phi]j", "\[Rule]", "phij"}]}], "//", "Simplify"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.781004279810124*^9, 3.781004281303207*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"c7583130-f5d4-4e27-89fe-b3467f206b14"],

Cell["\<\
ArcCos(-(Cos(thetaj)*Sin(DEC)) - Cos(DEC)*Cos(phij - RA)*Sin(thetaj))\
\>", "Output",
 CellChangeTimes->{
  3.781004282679031*^9, 3.781004338591879*^9, 3.7814572207456083`*^9, 
   3.788031929970728*^9, {3.788032887863608*^9, 3.78803291357421*^9}},
 CellLabel->
  "Out[52]//CForm=",ExpressionUUID->"f4045687-c7a8-476e-9004-7514da1b50d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "TESTING", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Iota]new", " ", "=", " ", 
   RowBox[{"ArcCos", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", " ", 
       RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], 
      RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
      RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.788032082370573*^9, 3.788032126240489*^9}, {
  3.788033369747394*^9, 3.788033375501754*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"0940c4fc-e8ce-41ac-b10a-8f4d2fb5a03d"],

Cell[BoxData[
 RowBox[{"ArcCos", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], " ", 
    RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "-", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]s", "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.788032137200733*^9, 3.788032234899453*^9, {3.788032889665449*^9, 
   3.7880329144998493`*^9}, 3.78803337615775*^9, 3.7881097465969048`*^9, 
   3.788111609509368*^9, 3.7881116909605722`*^9, 3.788112042781109*^9, 
   3.788114406628502*^9, 3.78811752619748*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"4631c161-479c-4d27-b9ce-3529f1e7d803"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Theta]sc", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", 
   RowBox[{"ArcSin", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", "\[Theta]s"}], "]"}], " ", 
      RowBox[{"Cos", "[", "ep", "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], "-", "\[Theta]s"}], "]"}], " ", 
      RowBox[{"Sin", "[", "ep", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.788109608531149*^9, 3.788109680560223*^9}, {
  3.7881154324988947`*^9, 3.7881154341914787`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"39413b40-39cd-4bd5-863d-e64986a84cfd"],

Cell[BoxData[
 RowBox[{
  FractionBox["\[Pi]", "2"], "-", 
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "ep", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", "ep", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]s", "]"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.788109681157983*^9, 3.788111414504588*^9, 
  3.7881116919366426`*^9, 3.788113353158984*^9, 3.7881143077873573`*^9, 
  3.7881154346224327`*^9, 3.788115824666656*^9, 3.788117581627214*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"80db8817-9d39-4870-9926-9d1a7203535e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Psi]new1", " ", "=", " ", 
  RowBox[{"ArcTan", "[", " ", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
      RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]j", "]"}], "+", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]s", "]"}], 
       RowBox[{"Cos", "[", "\[Iota]new", "]"}]}]}], ")"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.788032011634759*^9, 3.7880320805401506`*^9}, {
   3.788032134116171*^9, 3.788032148628393*^9}, {3.788033197203477*^9, 
   3.788033227292327*^9}, 3.788033324731522*^9, {3.7880333928037233`*^9, 
   3.788033396065035*^9}, {3.788109600668532*^9, 3.788109606755885*^9}, 
   3.7881096863177137`*^9, {3.788109855886702*^9, 3.7881098563680143`*^9}, {
   3.788110164402358*^9, 3.7881101671422033`*^9}, {3.788111579846656*^9, 
   3.788111579994093*^9}, {3.788111771893936*^9, 3.7881117742766733`*^9}, 
   3.7881133571461554`*^9, 3.788113410153144*^9, 3.788113635305612*^9, {
   3.78811506839529*^9, 3.788115070816576*^9}, {3.7881156672584047`*^9, 
   3.788115716367509*^9}, {3.7881159142982273`*^9, 3.7881159146223783`*^9}, {
   3.788115950681314*^9, 3.788115950958107*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"a521b36c-8107-4b4d-bb21-da03433d3479"],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  FractionBox[
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]s", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}]}], 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]j", "]"}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Iota]new", "]"}]}]}]], "]"}]], "Output",
 CellChangeTimes->{{3.7880321382289877`*^9, 3.788032149038188*^9}, 
   3.788032235689151*^9, {3.788032890736075*^9, 3.788032915467999*^9}, {
   3.7880331991923113`*^9, 3.788033227669002*^9}, {3.788033385732716*^9, 
   3.78803339667318*^9}, {3.7881096822860003`*^9, 3.788109687050449*^9}, 
   3.788109749338293*^9, {3.788109849589719*^9, 3.78810986160004*^9}, {
   3.788110168370903*^9, 3.788110187246501*^9}, 3.7881109249371223`*^9, 
   3.788111433155744*^9, 3.788111580330261*^9, 3.7881116928844643`*^9, 
   3.7881117747147627`*^9, {3.788112031037683*^9, 3.788112046251135*^9}, 
   3.788112669337034*^9, 3.78811337189718*^9, 3.788113580464067*^9, 
   3.788113613844771*^9, 3.788113662224503*^9, 3.7881143017970247`*^9, 
   3.788115071473394*^9, {3.788115667520151*^9, 3.7881157166977377`*^9}, 
   3.7881158261510153`*^9, 3.788115914971944*^9, 3.788115951664229*^9, 
   3.788117520534493*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"be56b80d-e71f-4d47-ab2e-162bda6bf31a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]new2", " ", "=", " ", 
   RowBox[{"ArcTan", "[", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]s", "]"}], 
       RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]j", "]"}], "+", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]sc", "]"}], 
        RowBox[{"Cos", "[", "\[Iota]new", "]"}]}]}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7881136436621647`*^9, 3.788113646270887*^9}, {
  3.7881148452600393`*^9, 3.788114863998556*^9}, {3.788115031940258*^9, 
  3.788115034512434*^9}, {3.7881159982653503`*^9, 3.7881159984781027`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"8780e826-6a27-4615-ac16-c9bb7acdac50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]new1", "-", "\[Psi]"}], "//", "Expand"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7880321507526207`*^9, 3.788032167296393*^9}, {
   3.788033095794207*^9, 3.7880331275759974`*^9}, 3.7881098763262367`*^9, {
   3.7881150784108562`*^9, 3.788115079679915*^9}, {3.788115649953704*^9, 
   3.788115670164731*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"1090ef09-8090-47d0-9fa4-6d16765e1831"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"ArcCot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]s", "]"}], " ", 
      RowBox[{"Cot", "[", 
       RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cot", "[", "\[Theta]j", "]"}], " ", 
      RowBox[{"Csc", "[", 
       RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]s", "]"}]}]}], "]"}]}], "-", 
  RowBox[{"ArcTan", "[", 
   FractionBox[
    RowBox[{
     RowBox[{"Jvec", ".", "Zvec"}], "-", 
     RowBox[{
      RowBox[{"Jvec", ".", "Nvec"}], " ", 
      RowBox[{"Zvec", ".", "Nvec"}]}]}], 
    RowBox[{"Nvec", ".", 
     RowBox[{"Jvec", "\[Cross]", "Zvec"}]}]], "]"}]}]], "Output",
 CellChangeTimes->{{3.788032156204508*^9, 3.7880321687485647`*^9}, 
   3.788032238893736*^9, {3.788032894059125*^9, 3.78803294845516*^9}, {
   3.788033089143427*^9, 3.7880331283413687`*^9}, {3.788033200358645*^9, 
   3.78803322893528*^9}, 3.788033388695519*^9, 3.788109734459442*^9, 
   3.78810978481124*^9, {3.7881098732560883`*^9, 3.788109898894391*^9}, 
   3.788109959765101*^9, {3.788110170416626*^9, 3.7881101903702803`*^9}, 
   3.788110855803155*^9, 3.788110926405951*^9, 3.788111426633648*^9, 
   3.788111587703887*^9, 3.7881116939721737`*^9, 3.788111777068074*^9, 
   3.788112671386755*^9, {3.788113577246957*^9, 3.788113614913162*^9}, 
   3.7881150804270983`*^9, {3.788115645174934*^9, 3.788115727462842*^9}, 
   3.788115831641903*^9, 3.788117539417096*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"224dbfd3-81f9-4634-ba2d-6e56367b936c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Iota]new", " ", "-", " ", "\[Iota]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.788032185568617*^9, 3.7880321947335587`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"42687afa-a34f-443c-bfd7-1057cd34fb8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Iota]"}], "+", 
  RowBox[{"ArcCos", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], " ", 
     RowBox[{"Cos", "[", "\[Theta]s", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]j", "-", "\[Phi]s"}], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]s", "]"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.788032191365951*^9, 3.788032195054387*^9}, {
   3.788032896069641*^9, 3.788032921113302*^9}, {3.788111695412781*^9, 
   3.788111705815651*^9}, 3.788113615876045*^9, 3.788114402086636*^9, 
   3.7881158328479233`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"d603a675-2ac2-4d1a-bfc0-25b3d62e8e58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Psi]2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ArcTan", "[", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Jvec", ".", "Zvec"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Jvec", ".", "Nvec"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"Zvec", ".", "Nvec"}], ")"}]}]}], ")"}], "/", 
         RowBox[{"Nvec", ".", 
          RowBox[{"(", 
           RowBox[{"Cross", "[", 
            RowBox[{"Jvec", ",", "Zvec"}], "]"}], ")"}]}]}], "]"}], "/.", 
       RowBox[{"\[Theta]s", "\[Rule]", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "-", "DEC"}]}]}], "/.", 
      RowBox[{"\[Phi]s", "\[Rule]", " ", "RA"}]}], "/.", 
     RowBox[{"\[Theta]j", "\[Rule]", "thetaj"}]}], "/.", 
    RowBox[{"\[Phi]j", "\[Rule]", "phij"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.788112816576255*^9, 3.7881128172102127`*^9}, {
  3.788113864289606*^9, 3.788113871110244*^9}, {3.788113997952704*^9, 
  3.788114001582926*^9}, {3.788114525625408*^9, 3.78811453204405*^9}, {
  3.788114965398631*^9, 3.7881149723543367`*^9}, {3.788115234107819*^9, 
  3.788115234335966*^9}, {3.788115332042927*^9, 3.788115334409484*^9}, {
  3.788115870721957*^9, 3.788115874416411*^9}, {3.788115969409568*^9, 
  3.788115969678389*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"c2aa62cf-9927-4150-a455-e4fd6a6e9e08"],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "DEC", "]"}], " ", 
    RowBox[{"Cot", "[", "thetaj", "]"}], " ", 
    RowBox[{"Csc", "[", 
     RowBox[{"phij", "-", "RA"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Cot", "[", 
     RowBox[{"phij", "-", "RA"}], "]"}], " ", 
    RowBox[{"Sin", "[", "DEC", "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.788114532762195*^9, 3.788114972915525*^9, 3.788115234758712*^9, 
   3.788115334767228*^9, 3.788115834034477*^9, {3.788115871396467*^9, 
   3.7881158748710327`*^9}, 3.788115970146112*^9, 3.788116223538842*^9, {
   3.788117541222843*^9, 3.78811755670089*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"77c496d4-4136-4e47-a809-5102ba920979"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "\[Psi]2", "]"}]], "Input",
 CellChangeTimes->{{3.788115314296595*^9, 3.788115322221236*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"c16a8f67-b5e9-45f5-b752-5122b46fba08"],

Cell["\<\
ArcTan(Cos(DEC)*Cot(thetaj)*Csc(phij - RA) - Cot(phij - RA)*Sin(DEC))\
\>", "Output",
 CellChangeTimes->{{3.788115322497361*^9, 3.7881153380066967`*^9}, 
   3.7881155166449003`*^9, 3.788115835233861*^9},
 CellLabel->
  "Out[114]//CForm=",ExpressionUUID->"8e6c12c8-5298-43a0-a8b7-ad19ef04d702"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Pi]", "/", "2."}], " ", "-", " ", "\[Psi]"}], "/.", 
     RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
    RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
   RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
  RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}]], "Input",
 CellChangeTimes->{{3.7881141300311623`*^9, 3.7881141716220617`*^9}, {
   3.7881147646628857`*^9, 3.7881147708290243`*^9}, 3.7881155061218576`*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"eed66a2d-2cbd-48af-ae9c-fd341c836865"],

Cell[BoxData["0.9111271416603455`"], "Output",
 CellChangeTimes->{3.7881141417273083`*^9, 3.7881141724005327`*^9, 
  3.7881142128727713`*^9, 3.788114354778323*^9, 3.788114392786426*^9, 
  3.788114537006145*^9, 3.788114779000367*^9, 3.788115723193275*^9, 
  3.788117564286984*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"c68de01b-a365-4039-b6f4-e58f7709b2ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], " ", "-", "\[Psi]2"}], "/.", 
      RowBox[{"RA", "\[Rule]", "3.59251"}]}], "/.", 
     RowBox[{"DEC", "\[Rule]", " ", "1.21682"}]}], "/.", 
    RowBox[{"thetaj", "\[Rule]", "2.33115"}]}], "/.", 
   RowBox[{"phij", "\[Rule]", "6.1285"}]}]}]], "Input",
 CellChangeTimes->{{3.788114173700635*^9, 3.788114182216391*^9}, 
   3.788114776087983*^9, {3.7881149844114323`*^9, 3.788114985544239*^9}, 
   3.788115507778715*^9, {3.7881158444486723`*^9, 3.788115845950474*^9}, 
   3.78811588443364*^9, {3.788117567385145*^9, 3.788117568841613*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"02670654-0814-4f50-9445-c390d2d01d34"],

Cell[BoxData["0.9111314371809618`"], "Output",
 CellChangeTimes->{
  3.788114182849227*^9, 3.788114214166299*^9, 3.78811435678071*^9, 
   3.7881143939526978`*^9, 3.7881145391489153`*^9, 3.788114780056724*^9, {
   3.78811498066461*^9, 3.788114986057082*^9}, {3.788115839496304*^9, 
   3.788115846414743*^9}, {3.788115879162889*^9, 3.788115885039617*^9}, {
   3.788117565197043*^9, 3.788117569521037*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"fc712c81-c40d-45ad-b321-b6c77a206174"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]new1", "/.", 
      RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
     RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
    RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
   RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}]}]], "Input",
 CellChangeTimes->{{3.788114184740799*^9, 3.788114193128284*^9}, {
   3.788115484954196*^9, 3.7881155102941113`*^9}, {3.7881159206094637`*^9, 
   3.788115924518249*^9}, 3.788115958657063*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"af92dd81-0a3e-46e6-8a26-5aba6d691821"],

Cell[BoxData["0.9111271416603454`"], "Output",
 CellChangeTimes->{
  3.788114193853064*^9, 3.788114234834483*^9, 3.7881143613372803`*^9, {
   3.7881143951286287`*^9, 3.788114412423222*^9}, 3.788114541922399*^9, 
   3.788115511408948*^9, {3.7881157078687687`*^9, 3.788115720303001*^9}, {
   3.788115909960347*^9, 3.788115924996632*^9}, 3.788115958950654*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"24ac659d-240c-4527-8a15-bf654d4fe2a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"    ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Psi]new2", "/.", 
       RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
      RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
     RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
    RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}], "/.", 
   RowBox[{"ep", "\[Rule]", ".4075"}]}]}]], "Input",
 CellChangeTimes->{{3.7881144207751293`*^9, 3.788114428823683*^9}, {
   3.788114790895998*^9, 3.7881147991805162`*^9}, {3.788114873755817*^9, 
   3.7881148989019213`*^9}, {3.788115042682767*^9, 3.788115048265753*^9}, {
   3.78811510637132*^9, 3.788115107280221*^9}, {3.788115210275361*^9, 
   3.788115248503742*^9}, {3.788115488513967*^9, 3.788115489135148*^9}, 
   3.7881160076247177`*^9, {3.788116237368054*^9, 3.788116239845251*^9}, {
   3.7881175886609573`*^9, 3.788117598076417*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"2ee4c30e-9da1-4bcb-880a-5412e3dcfebd"],

Cell[BoxData["0.9773891727584817`"], "Output",
 CellChangeTimes->{
  3.788114200990981*^9, 3.788114235990807*^9, {3.788114396141842*^9, 
   3.788114429294834*^9}, 3.78811454366673*^9, {3.788114793260564*^9, 
   3.788114799555175*^9}, {3.788114870239562*^9, 3.788114899293631*^9}, {
   3.7881150164297047`*^9, 3.788115048570259*^9}, {3.78811510311061*^9, 
   3.788115107820981*^9}, {3.788115214177245*^9, 3.788115249163162*^9}, {
   3.788115453300496*^9, 3.788115512345395*^9}, {3.788115960524509*^9, 
   3.788116007931663*^9}, {3.7881162275928698`*^9, 3.788116240309387*^9}, {
   3.788117576127698*^9, 3.788117598471663*^9}},
 CellLabel->"Out[72]=",ExpressionUUID->"7333ca3f-f54b-481f-964e-cb56588e5429"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]sc", "  ", "/.", 
      RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
     RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
    RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
   RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}], "/.", 
  RowBox[{"ep", "\[Rule]", ".4075"}]}]], "Input",
 CellChangeTimes->{{3.788115380078096*^9, 3.7881153893120823`*^9}, {
  3.7881154477305202`*^9, 3.788115448477055*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"722ba097-fb30-413b-abb6-ac0683e3d172"],

Cell[BoxData["0.40000161372044674`"], "Output",
 CellChangeTimes->{
  3.7881153896830187`*^9, {3.788115438981287*^9, 3.788115449013096*^9}, 
   3.78811551313973*^9, 3.788115985689481*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"9ead7741-5b45-4556-9eae-4ac6c3a138dc"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.78811271741807*^9, 
  3.78811271877634*^9}},ExpressionUUID->"0174b86d-532d-4bdf-a94f-\
c9472c6b2f1e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", "\[Psi]", "-", 
        "\[Psi]new1"}], ")"}], "/.", 
      RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
     RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
    RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
   RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}], "/.", 
  RowBox[{"ep", "\[Rule]", ".405"}]}]], "Input",
 CellChangeTimes->{{3.7880322475878077`*^9, 3.788032299468977*^9}, 
   3.788032400462867*^9, {3.788109883546344*^9, 3.788109906365892*^9}, {
   3.788111388926901*^9, 3.788111406307563*^9}, {3.788111858621531*^9, 
   3.78811189876213*^9}, {3.788113672809445*^9, 3.7881136814225483`*^9}, {
   3.7881142430045443`*^9, 3.7881142557181177`*^9}, {3.788114447056714*^9, 
   3.788114463947969*^9}, {3.788115764369944*^9, 3.7881157670943413`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"4ffefe58-6a58-4313-998e-5cad48c25d11"],

Cell[BoxData[
 RowBox[{"-", "4.440892098500626`*^-16"}]], "Output",
 CellChangeTimes->{{3.788032280739975*^9, 3.7880322998154087`*^9}, {
   3.7880323948427553`*^9, 3.788032409723181*^9}, {3.788032896921609*^9, 
   3.788032922279078*^9}, {3.7880330924726562`*^9, 3.788033101396546*^9}, 
   3.788109691070038*^9, 3.788109726328473*^9, {3.788109899036813*^9, 
   3.788109907316621*^9}, {3.788109959901432*^9, 3.788109965823906*^9}, {
   3.78811017415842*^9, 3.788110200110539*^9}, {3.788110848419787*^9, 
   3.788110858139032*^9}, 3.7881109284821033`*^9, {3.7881114078318853`*^9, 
   3.788111435814809*^9}, {3.788111697006336*^9, 3.788111706773892*^9}, 
   3.788111789277296*^9, 3.788111899500142*^9, {3.788112037299005*^9, 
   3.7881120485111237`*^9}, 3.7881126733475*^9, 3.7881135456060677`*^9, 
   3.7881136220657*^9, {3.788113677822661*^9, 3.788113681832588*^9}, 
   3.7881137412992764`*^9, {3.788114238192465*^9, 3.788114256016636*^9}, {
   3.788114416905212*^9, 3.788114464592338*^9}, {3.788115755123623*^9, 
   3.7881157674762907`*^9}},
 CellLabel->
  "Out[103]=",ExpressionUUID->"74284001-98aa-4873-92e7-7e3cbbd3eba2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", "\[Psi]", "-", 
        "\[Psi]new2"}], ")"}], "/.", 
      RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
     RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
    RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
   RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}], "/.", 
  RowBox[{"ep", "\[Rule]", ".405"}]}]], "Input",
 CellChangeTimes->{{3.78811445299541*^9, 3.788114466951429*^9}, {
  3.788115776408224*^9, 3.788115778790516*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"a3a2b9aa-2fd6-4dfd-b214-05c75480074d"],

Cell[BoxData["0.3153466327819403`"], "Output",
 CellChangeTimes->{{3.78811445746624*^9, 3.788114468465337*^9}, 
   3.788115779208836*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"a76e7b3b-7956-4b54-aee3-c9d6b1247271"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Psi]new2", "-", "\[Psi]new1"}], ")"}], "/.", 
      RowBox[{"\[Theta]s", "\[Rule]", "0.353973"}]}], "/.", 
     RowBox[{"\[Phi]s", "\[Rule]", " ", "3.59251"}]}], "/.", 
    RowBox[{"\[Theta]j", "\[Rule]", "2.33115"}]}], "/.", 
   RowBox[{"\[Phi]j", "\[Rule]", "6.1285"}]}], "/.", 
  RowBox[{"ep", "\[Rule]", ".405"}]}]], "Input",
 CellChangeTimes->{{3.78811268155499*^9, 3.788112686560774*^9}, 
   3.78811445439051*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"95ea4676-8e21-4cea-a440-b4abf9d53f7c"],

Cell[BoxData[
 RowBox[{"-", "1.2909078796054825`"}]], "Output",
 CellChangeTimes->{{3.788114454903911*^9, 3.788114469801399*^9}},
 CellLabel->"Out[39]=",ExpressionUUID->"63459599-fb1a-4a98-aa54-3b9053d2f3a5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JN", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"Cos", "[", "\[Iota]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jz", " ", "=", " ", 
   RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nz", " ", "=", " ", 
   RowBox[{"Cos", "[", "\[Theta]n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NdotJcrossz", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]n", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]n", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]j", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]j", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]j", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
     RowBox[{"Sin", "[", "\[Theta]n", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]n", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.788116738105678*^9, 3.788116932011944*^9}, {
  3.788116963079977*^9, 3.788117012151319*^9}, {3.788117057001443*^9, 
  3.788117065114949*^9}, {3.788117101388954*^9, 3.788117104656436*^9}, {
  3.78811727282681*^9, 3.7881172730601892`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"a24236c7-999a-4a86-beb1-945ba86ca145"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cross", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]j", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]j", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]j", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.788117051774777*^9, 3.788117052133008*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"dc97278b-5fa0-42cf-bc41-ac61c2dbc434"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]j", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "\[Phi]j", "]"}]}], " ", 
    RowBox[{"Sin", "[", "\[Theta]j", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.788116952244913*^9, 3.788117052535236*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"7612fd1d-7bb8-409d-b42f-67acadf75e60"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jz", " ", "-", " ", 
  RowBox[{"JN", " ", "*", " ", "Nz", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"/.", 
      RowBox[{"\[Iota]", "\[Rule]", 
       RowBox[{"ArcCos", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Theta]j", "]"}]}], 
          RowBox[{"Sin", "[", "\[Theta]n", "]"}], 
          RowBox[{"Cos", "[", "\[Phi]j", "]"}], 
          RowBox[{"Cos", "[", "\[Phi]n", "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]j", "]"}], 
          RowBox[{"Sin", "[", "\[Phi]j", "]"}], 
          RowBox[{"Sin", "[", "\[Phi]j", "]"}], 
          RowBox[{"Sin", "[", "\[Phi]n", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]j", "]"}], 
          RowBox[{"Cos", "[", "\[Phi]n", "]"}]}]}], "]"}]}]}], "//", 
     "FullSimplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.788117079500267*^9, 3.78811722172834*^9}, {
  3.788117345885034*^9, 3.788117348809701*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"204eaa86-6b42-4920-b64d-05d4afdccfa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", "\[Theta]j", "]"}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Theta]n", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Iota]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.788117089668771*^9, 3.788117094844438*^9}, {
   3.7881171902085333`*^9, 3.788117222655921*^9}, 3.78811728095233*^9, 
   3.788117349227436*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"73e0bd35-fa3b-4b1d-8457-79fa93abea09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NdotJcrossz", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.788117228389032*^9, 3.788117239304043*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"a94c5644-2731-4e12-974b-b1437c117f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", "\[Theta]j", "]"}], " ", 
  RowBox[{"Sin", "[", "\[Theta]n", "]"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Phi]j", "-", "\[Phi]n"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.788117232033186*^9, 3.788117239643433*^9}, 
   3.788117275613813*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"bf25ba80-539e-4fc4-8043-270313410a10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", 
  RowBox[{"ArcTan", "[", ".5", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ArcTan", "[", "2.", "]"}]}], "Input",
 CellChangeTimes->{{3.7881174006129837`*^9, 3.788117421786437*^9}, {
  3.788117462244544*^9, 3.78811747310546*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"794d3876-69d3-421e-a551-9f18ea13f7dc"],

Cell[BoxData["1.1071487177940904`"], "Output",
 CellChangeTimes->{{3.788117412087378*^9, 3.788117422247007*^9}, {
  3.788117462595882*^9, 3.788117473524473*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"b24b2aed-bacf-42e0-a684-d8bc61722dc9"],

Cell[BoxData["1.1071487177940906`"], "Output",
 CellChangeTimes->{{3.788117412087378*^9, 3.788117422247007*^9}, {
  3.788117462595882*^9, 3.7881174735268793`*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"dd5f70fa-0b8b-440f-b09e-520334a23615"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1004, 1141},
WindowMargins->{{52, Automatic}, {313, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 358, 7, 165, "Chapter",ExpressionUUID->"62ca31fa-be6c-439b-88ce-8ff72489cf28"],
Cell[CellGroupData[{
Cell[963, 33, 449, 9, 181, "Section",ExpressionUUID->"d1c93c6b-4e00-4eb2-aaed-59a9e235309e"],
Cell[1415, 44, 2147, 49, 115, "Input",ExpressionUUID->"0827f807-305c-4fd6-8008-ce37fc55f182"],
Cell[CellGroupData[{
Cell[3587, 97, 1155, 26, 50, "Input",ExpressionUUID->"0fca73d0-a3e5-4afe-90ba-9e561dd14f60"],
Cell[4745, 125, 1204, 24, 34, "Output",ExpressionUUID->"34a36cb2-b7b8-458f-913d-533774aeb801"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5986, 154, 398, 10, 44, "Input",ExpressionUUID->"c82f3199-cae1-4187-a34d-8e2a269ae444"],
Cell[6387, 166, 774, 18, 34, "Output",ExpressionUUID->"a596f127-78d8-4a33-9bb8-42eaabab6799"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7198, 189, 638, 17, 44, "Input",ExpressionUUID->"8190c91c-791c-479b-9752-7650a5fc6632"],
Cell[7839, 208, 449, 8, 34, "Output",ExpressionUUID->"cab6e633-6429-4111-b95f-f1176afecdd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8325, 221, 369, 7, 30, "Input",ExpressionUUID->"7ff145ea-1341-4cba-9031-891988cfc969"],
Cell[8697, 230, 908, 21, 34, "Output",ExpressionUUID->"53323996-9f81-4919-8c20-5498aa5f89ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9642, 256, 584, 15, 44, "Input",ExpressionUUID->"c7583130-f5d4-4e27-89fe-b3467f206b14"],
Cell[10229, 273, 346, 7, 34, "Output",ExpressionUUID->"f4045687-c7a8-476e-9004-7514da1b50d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10612, 285, 725, 17, 52, "Input",ExpressionUUID->"0940c4fc-e8ce-41ac-b10a-8f4d2fb5a03d"],
Cell[11340, 304, 754, 17, 34, "Output",ExpressionUUID->"4631c161-479c-4d27-b9ce-3529f1e7d803"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12131, 326, 784, 19, 30, "Input",ExpressionUUID->"39413b40-39cd-4bd5-863d-e64986a84cfd"],
Cell[12918, 347, 668, 15, 47, "Output",ExpressionUUID->"80db8817-9d39-4870-9926-9d1a7203535e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13623, 367, 1419, 28, 30, "Input",ExpressionUUID->"a521b36c-8107-4b4d-bb21-da03433d3479"],
Cell[15045, 397, 1409, 26, 54, "Output",ExpressionUUID->"be56b80d-e71f-4d47-ab2e-162bda6bf31a"]
}, Open  ]],
Cell[16469, 426, 884, 21, 30, "Input",ExpressionUUID->"8780e826-6a27-4615-ac16-c9bb7acdac50"],
Cell[CellGroupData[{
Cell[17378, 451, 456, 9, 30, "Input",ExpressionUUID->"1090ef09-8090-47d0-9fa4-6d16765e1831"],
Cell[17837, 462, 1580, 34, 51, "Output",ExpressionUUID->"224dbfd3-81f9-4634-ba2d-6e56367b936c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19454, 501, 259, 6, 30, "Input",ExpressionUUID->"42687afa-a34f-443c-bfd7-1057cd34fb8c"],
Cell[19716, 509, 770, 19, 34, "Output",ExpressionUUID->"d603a675-2ac2-4d1a-bfc0-25b3d62e8e58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20523, 533, 1459, 34, 87, "Input",ExpressionUUID->"c2aa62cf-9927-4150-a455-e4fd6a6e9e08"],
Cell[21985, 569, 731, 17, 34, "Output",ExpressionUUID->"77c496d4-4136-4e47-a809-5102ba920979"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22753, 591, 213, 4, 30, "Input",ExpressionUUID->"c16a8f67-b5e9-45f5-b752-5122b46fba08"],
Cell[22969, 597, 303, 6, 34, "Output",ExpressionUUID->"8e6c12c8-5298-43a0-a8b7-ad19ef04d702"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23309, 608, 604, 13, 30, "Input",ExpressionUUID->"eed66a2d-2cbd-48af-ae9c-fd341c836865"],
Cell[23916, 623, 358, 5, 34, "Output",ExpressionUUID->"c68de01b-a365-4039-b6f4-e58f7709b2ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24311, 633, 745, 16, 30, "Input",ExpressionUUID->"02670654-0814-4f50-9445-c390d2d01d34"],
Cell[25059, 651, 482, 7, 34, "Output",ExpressionUUID->"fc712c81-c40d-45ad-b321-b6c77a206174"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25578, 663, 613, 14, 30, "Input",ExpressionUUID->"af92dd81-0a3e-46e6-8a26-5aba6d691821"],
Cell[26194, 679, 440, 7, 34, "Output",ExpressionUUID->"24ac659d-240c-4527-8a15-bf654d4fe2a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26671, 691, 976, 19, 30, "Input",ExpressionUUID->"2ee4c30e-9da1-4bcb-880a-5412e3dcfebd"],
Cell[27650, 712, 704, 10, 68, "Output",ExpressionUUID->"7333ca3f-f54b-481f-964e-cb56588e5429"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28391, 727, 586, 14, 30, "Input",ExpressionUUID->"722ba097-fb30-413b-abb6-ac0683e3d172"],
Cell[28980, 743, 270, 5, 34, "Output",ExpressionUUID->"9ead7741-5b45-4556-9eae-4ac6c3a138dc"]
}, Open  ]],
Cell[29265, 751, 150, 3, 30, "Input",ExpressionUUID->"0174b86d-532d-4bdf-a94f-c9472c6b2f1e"],
Cell[CellGroupData[{
Cell[29440, 758, 1021, 22, 30, "Input",ExpressionUUID->"4ffefe58-6a58-4313-998e-5cad48c25d11"],
Cell[30464, 782, 1123, 17, 34, "Output",ExpressionUUID->"74284001-98aa-4873-92e7-7e3cbbd3eba2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31624, 804, 696, 18, 30, "Input",ExpressionUUID->"a3a2b9aa-2fd6-4dfd-b214-05c75480074d"],
Cell[32323, 824, 220, 4, 34, "Output",ExpressionUUID->"a76e7b3b-7956-4b54-aee3-c9d6b1247271"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32580, 833, 610, 15, 30, "Input",ExpressionUUID->"95ea4676-8e21-4cea-a440-b4abf9d53f7c"],
Cell[33193, 850, 208, 3, 34, "Output",ExpressionUUID->"63459599-fb1a-4a98-aa54-3b9053d2f3a5"]
}, Open  ]],
Cell[33416, 856, 1214, 28, 94, "Input",ExpressionUUID->"a24236c7-999a-4a86-beb1-945ba86ca145"],
Cell[CellGroupData[{
Cell[34655, 888, 591, 15, 30, "Input",ExpressionUUID->"dc97278b-5fa0-42cf-bc41-ac61c2dbc434"],
Cell[35249, 905, 451, 11, 34, "Output",ExpressionUUID->"7612fd1d-7bb8-409d-b42f-67acadf75e60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35737, 921, 1085, 26, 52, "Input",ExpressionUUID->"204eaa86-6b42-4920-b64d-05d4afdccfa9"],
Cell[36825, 949, 431, 9, 34, "Output",ExpressionUUID->"73e0bd35-fa3b-4b1d-8457-79fa93abea09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37293, 963, 216, 3, 30, "Input",ExpressionUUID->"a94c5644-2731-4e12-974b-b1437c117f1f"],
Cell[37512, 968, 373, 8, 34, "Output",ExpressionUUID->"bf25ba80-539e-4fc4-8043-270313410a10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37922, 981, 378, 7, 52, "Input",ExpressionUUID->"794d3876-69d3-421e-a551-9f18ea13f7dc"],
Cell[38303, 990, 240, 3, 34, "Output",ExpressionUUID->"b24b2aed-bacf-42e0-a684-d8bc61722dc9"],
Cell[38546, 995, 242, 3, 34, "Output",ExpressionUUID->"dd5f70fa-0b8b-440f-b09e-520334a23615"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

